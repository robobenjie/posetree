<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.0.0"/>
    <title>posetree.pose API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../posetree.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;posetree</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Pose">Pose</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Pose.__init__">Pose</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.from_position_and_quaternion">from_position_and_quaternion</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.from_position_and_rotation">from_position_and_rotation</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.transform">transform</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.position">position</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.rotation">rotation</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.frame">frame</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.pose_tree">pose_tree</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.x">x</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.z">z</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.x_axis">x_axis</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.y_axis">y_axis</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.z_axis">z_axis</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.in_frame">in_frame</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.with_position">with_position</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.with_rotation">with_rotation</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.with_rotation_matching">with_rotation_matching</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.with_position_x">with_position_x</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.with_position_y">with_position_y</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.with_position_z">with_position_z</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.apply_transform">apply_transform</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.translate">translate</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.rotate_about_axis">rotate_about_axis</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.rotate_about_x">rotate_about_x</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.rotate_about_y">rotate_about_y</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.rotate_about_z">rotate_about_z</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.point_x_at">point_x_at</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.point_y_at">point_y_at</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.point_z_at">point_z_at</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.interpolate">interpolate</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.distance_to">distance_to</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.angle_to">angle_to</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.angle_about_x_to">angle_about_x_to</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.angle_about_y_to">angle_about_y_to</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.angle_about_z_to">angle_about_z_to</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PoseTree">PoseTree</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PoseTree.get_transform">get_transform</a>
                        </li>
                        <li>
                                <a class="function" href="#PoseTree.get_pose">get_pose</a>
                        </li>
                        <li>
                                <a class="function" href="#PoseTree.temporary_frame">temporary_frame</a>
                        </li>
                        <li>
                                <a class="function" href="#PoseTree.add_frame">add_frame</a>
                        </li>
                        <li>
                                <a class="function" href="#PoseTree.remove_frame">remove_frame</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CustomFramePoseTree">CustomFramePoseTree</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#CustomFramePoseTree.custom_frames">custom_frames</a>
                        </li>
                        <li>
                                <a class="function" href="#CustomFramePoseTree.add_frame">add_frame</a>
                        </li>
                        <li>
                                <a class="function" href="#CustomFramePoseTree.remove_frame">remove_frame</a>
                        </li>
                        <li>
                                <a class="function" href="#CustomFramePoseTree.get_transform">get_transform</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Transform">Transform</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Transform.__init__">Transform</a>
                        </li>
                        <li>
                                <a class="function" href="#Transform.from_position_and_quaternion">from_position_and_quaternion</a>
                        </li>
                        <li>
                                <a class="function" href="#Transform.identity">identity</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transform.inverse">inverse</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transform.position">position</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transform.rotation">rotation</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transform.x_axis">x_axis</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transform.y_axis">y_axis</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transform.z_axis">z_axis</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transform.x">x</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transform.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transform.z">z</a>
                        </li>
                        <li>
                                <a class="function" href="#Transform.to_matrix">to_matrix</a>
                        </li>
                        <li>
                                <a class="function" href="#Transform.from_matrix">from_matrix</a>
                        </li>
                        <li>
                                <a class="function" href="#Transform.apply">apply</a>
                        </li>
                        <li>
                                <a class="function" href="#Transform.almost_equal">almost_equal</a>
                        </li>
                        <li>
                                <a class="function" href="#Transform.interpolate">interpolate</a>
                        </li>
                        <li>
                                <a class="function" href="#Transform.angle_to">angle_to</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../posetree.html">posetree</a><wbr>.pose    </h1>

                        <div class="docstring"><p><code><a href="../posetree.html">posetree</a></code> is a module for representing and manipulating poses in 3D space. There are two main classes: <code><a href="#Pose">Pose</a></code> and <code><a href="#PoseTree">PoseTree</a></code>.</p>

<p>A <code><a href="#Pose">Pose</a></code> is an immutable location and orientation in 3D space, relative to a frame (i.e. 1 meter forward in X from the robot base).</p>

<p>A <code><a href="#PoseTree">PoseTree</a></code> is a object that keeps track of frames as they change over time, so that poses can know how to transform themselves into other frames, 
and do math operations with poses in different frames at particular points in time. You will need to subclass PoseTree to hook it up to your robot's
odometry system.</p>
</div>

                        <input id="mod-pose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-pose-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">`posetree` is a module for representing and manipulating poses in 3D space. There are two main classes: `Pose` and `PoseTree`.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">A `Pose` is an immutable location and orientation in 3D space, relative to a frame (i.e. 1 meter forward in X from the robot base).</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">A `PoseTree` is a object that keeps track of frames as they change over time, so that poses can know how to transform themselves into other frames, </span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">and do math operations with poses in different frames at particular points in time. You will need to subclass PoseTree to hook it up to your robot&#39;s</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">odometry system.</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Sequence</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span> <span class="nn">scipy.spatial.transform</span> <span class="kn">import</span> <span class="n">Rotation</span><span class="p">,</span> <span class="n">Slerp</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">import</span> <span class="nn">uuid</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>    
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="k">class</span> <span class="nc">Pose</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">    A Pose is an immutable location and orientation in 3D space.</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">    A pose is defined with a `parent_frame` (where to start) and a transform (how to get to the pose from the parent frame).</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    Note: While a Pose is immutable, the parent frame can (and does!) change over time relative to other frames, meaning that an individual pose can move relative</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">    to other frames. (For example a pose defined in the &quot;robot&quot; frame will conceptually move as the robot moves relative to a &#39;world&#39;</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">    frame, even though its position and orientation remain immutably constant.)</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    To make this very concrete, say the robot starts out at the world origin:</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    ```python</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">    pose_in_robot_frame = pose.from_position_and_rotation([1,2,3], Rotation.identity(), &quot;robot&quot;, pose_tree)</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">    pose_in_world_frame = pose_in_robot_frame.in_frame(&quot;world&quot;)</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    pose_in_robot_frame.position # [1,2,3]</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">    pose_in_world_frame.position # [1,2,3]</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">    # Now the robot moves 1 meter forward in the world frame.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">    robot.drive_forward_in_x(1)</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">    # Poses are immutable so this has not changed. One pose is [1,2,3] from the robot frame origin, one is [1,2,3] from the world origin.</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">    pose_in_robot_frame.position # [1,2,3]</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">    pose_in_world_frame.position # [2,2,3]</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">    # But if we express the one in robot frame in the world frame, we see that it is now 1 meter forward in x.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">    pose_in_robot_frame.in_frame(&quot;world&quot;).position # [2,2,3]</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">    ```</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">    Of course, the above example assumes that the `pose_tree` is correctly hooked up to the robot odometry system, so the poses know that the frames </span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">    have moved.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">    When constucting poses it is useful to think of what you expect the pose to be fixed relative to. For example, you might</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">    detect an apple on a table and get a pose from your perception system in the `camera` frame, but the apple is fixed relative to the table, so you will</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">    want to store your pose object with a the parent frame equal to `odometry/map/world`. Then, even if the robot moves, apple_pose will still refer to the</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">    best estimation of the apple&#39;s true location (with the usual caviats about localization drift and noise).</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">    ```</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">    apple_pose = Pose(camera_t_apple, &quot;camera&quot;, pose_tree).in_frame(&quot;world&quot;)</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">    ```</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">    Likewise if you have a bin on the back of a mobile robot and you want to define a drop-objects-into-bin pose right above it you can store</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">    that in the `robot` frame.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">    ```</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">    drop_pose = Pose.from_position_and_quaternion([-.3, 0.1, 0.25], [0, 0, 0, 1]), &quot;robot&quot;, pose_tree)</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">    ```</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">    When designing motion APIs with this library, you should be liberal in what frames you accept, and internally convert them to the frame you want to work in. </span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">    For example, in a function to move the arm to a pose:</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">    ```</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">    def move_to_pose(self, target_pose: Pose):</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        # Convert the target to be relative to the base of the robot so we can execute the motion.</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">        target_pose = target_pose.in_frame(&quot;robot&quot;)</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">        # Best Practice: turn Poses into Transforms at the last moment before acting on them.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">        arm_motion_primitives.move_arm_to_pose_relative_to_base(target_pose.transform)</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">    ```</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">    This formulation lets you combine the perception outputs and the motion methods for things like this:</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">    ```</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">    def grasp_apple(self, apple_pose: Pose):</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">        # pregrasp is a pose 15 cm above the apple, with z pointing at it.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        pregrasp = apple_pose.translate([0, 0, 0.15], frame=&quot;world&quot;).point_z_at(apple_pose)</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        self.move_to_pose(pregrasp)</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">        # Move down in the local &#39;z&#39; of pregrasp until we touch the apple.</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">        self.move_to_pose_until_contact(pregrasp.translate([0, 0, 0.2]))</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">        # If we feel a contact too early, raise some reasonable error:</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">        # We can check the distance using distance_to, even though the frames are different.</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">        if apple_pose.distance_to(get_tool_pose()) &gt; 0.1:</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">            return &quot;Whoops, we probably didn&#39;t get the apple.&quot;</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        # Close the gripper and move up a bit from where ever we are, to lift the apple.</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        self.close_gripper()</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        self.move_to_pose(get_tool_pose().translate([0, 0, -0.1]))</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        # Drop it in the bin.</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">        self.move_to_pose(drop_pose)</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">        self.open_gripper()</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">    ```</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">:</span> <span class="s2">&quot;PoseTree&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a transform, frame, and pose tree.</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">        </span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        Args:</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">            transform: The transform from the frame to the pose.</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">            parent_frame: The frame that the transform is relative to.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">            pose_tree: The world that the pose exists in.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span> <span class="o">=</span> <span class="n">transform</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span> <span class="o">=</span> <span class="n">parent_frame</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pose_tree</span> <span class="o">=</span> <span class="n">pose_tree</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">from_position_and_quaternion</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">quaternion</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">:</span> <span class="s2">&quot;PoseTree&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a position and quaternion.</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">        </span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">        Args:</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">            position: The position of the transform.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">            quaternion: The quaternion of the transform, in xyzw order.</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">            parent_frame: The frame that the transform is relative to.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">            pose_tree: The world that the pose exists in.</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">        </span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">        Returns:</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">            A new Pose.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">Transform</span><span class="o">.</span><span class="n">from_position_and_quaternion</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">quaternion</span><span class="p">),</span> <span class="n">parent_frame</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">)</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>    <span class="k">def</span> <span class="nf">from_position_and_rotation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">rotation</span><span class="p">:</span> <span class="n">Rotation</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">:</span> <span class="s2">&quot;PoseTree&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a transform from a position and rotatoin.</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="sd">        </span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">        Args:</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">            position: The position of the transform.</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">            rotation: The rotation of the transform.</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">            parent_frame: The frame that the transform is relative to.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">            pose_tree: The world that the pose exists in.</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">        </span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">        Returns:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">            A new Pose.</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">Transform</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">),</span> <span class="n">parent_frame</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">)</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>    <span class="nd">@property</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The transform from the parent frame to the pose.&quot;&quot;&quot;</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>    
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    <span class="nd">@property</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The position of the pose relative to the parent frame.&quot;&quot;&quot;</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">position</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>    
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>    <span class="nd">@property</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>    <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rotation</span><span class="p">:</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The rotation of the pose relative to the parent frame.&quot;&quot;&quot;</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotation</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>    
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>    <span class="nd">@property</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>    <span class="k">def</span> <span class="nf">frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The parent frame of the pose.&quot;&quot;&quot;</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>    
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>    <span class="nd">@property</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">pose_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PoseTree&quot;</span><span class="p">:</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The PoseTree object containing the world that the pose exists in.&quot;&quot;&quot;</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pose_tree</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>    
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>    <span class="nd">@property</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The x coordinate of the position.&quot;&quot;&quot;</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">x</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>    
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>    <span class="nd">@property</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The y coordinate of the position.&quot;&quot;&quot;</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">y</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>    
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>    <span class="nd">@property</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The z coordinate of the position.&quot;&quot;&quot;</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">z</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>    
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>    <span class="nd">@property</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>    <span class="k">def</span> <span class="nf">x_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The x axis of the pose.&quot;&quot;&quot;</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">x_axis</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>    
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>    <span class="nd">@property</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>    <span class="k">def</span> <span class="nf">y_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The y axis of the pose.&quot;&quot;&quot;</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">y_axis</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>    
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>    <span class="nd">@property</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="nf">z_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The z axis of the pose.&quot;&quot;&quot;</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">z_axis</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>    
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose representing the same location in space expressed in a different frame.</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">        </span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a><span class="sd">        Args:</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">            new_parent_frame: The new frame that the transform is relative to.</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">        </span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a><span class="sd">        Returns:</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">            A new pose with the same transform but in a different frame.</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="n">new_transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">parent_frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">new_transform</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>    
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>    <span class="k">def</span> <span class="nf">with_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same rotation but a different location relative to the parent frame.</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">        </span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">        Args:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="sd">            position: The new location of the pose.</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="sd">        </span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">        Returns:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="sd">            A new pose with the same rotation but a different location.</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="n">new_transform</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">new_transform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>    
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>    <span class="k">def</span> <span class="nf">with_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation</span><span class="p">:</span> <span class="n">Rotation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same location but a different rotation.</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="sd">        </span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        Args:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">            rotation: The new rotation of the pose.</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">        </span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a><span class="sd">        Returns:</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">            A new pose with the same location but a different rotation.</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>        <span class="n">new_transform</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">)</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">new_transform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>    
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>    <span class="k">def</span> <span class="nf">with_rotation_matching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same position but a different orientation, matching another pose.</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        This method is frame aware, so even if the other pose has a different frame, the rotation will be matched correctly.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">        </span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">        Args:</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">            other: The pose to match the rotation of.</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">        </span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">        Returns:</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">            A new pose with the same position but a different orientation.</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_rotation</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>    
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>    <span class="k">def</span> <span class="nf">with_position_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same y and z coordinates but a different x coordinate.</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="sd">        </span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">        Args:</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">            x: The new x coordinate of the pose.</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">            frame: The frame that the x coordinate is relative to. If None, the x coordinate is relative to the pose&#39;s frame.</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">        </span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">        Returns:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">            A new pose with the same y and z coordinates but a different x coordinate.</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>            <span class="n">in_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>            <span class="k">return</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>        
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>    <span class="k">def</span> <span class="nf">with_position_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same x and z coordinates but a different y coordinate.</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">        </span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">        Args:</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">            y: The new y coordinate of the pose.</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">            frame: The frame that the y coordinate is relative to. If None, the y coordinate is relative to the pose&#39;s frame.</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">        </span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">        Returns:</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="sd">            A new pose with the same x and z coordinates but a different y coordinate.</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>            <span class="n">in_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>            <span class="k">return</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="n">in_frame</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>    <span class="k">def</span> <span class="nf">with_position_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same x and y coordinates but a different z coordinate.</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">        </span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">        Args:</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">            z: The new z coordinate of the pose.</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">            frame: The frame that the z coordinate is relative to. If None, the z coordinate is relative to the pose&#39;s frame.</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">        </span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">        Returns:</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">            A new pose with the same x and y coordinates but a different z coordinate.</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>            <span class="n">in_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>            <span class="k">return</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="n">in_frame</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>    
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>    <span class="k">def</span> <span class="nf">apply_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose transformed by a transform.</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">        This method is provided to give compatibility with systems that talk about poses in terms of transforms,</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="sd">        but it is usually more readable and debuggable to use a rotate/translate method instead.</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">        </span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a><span class="sd">        Args:</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="sd">            transform: The transform to apply.</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="sd">        </span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">        Returns:</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a><span class="sd">            A new pose transformed by a transform.</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>        <span class="n">new_transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">*</span> <span class="n">transform</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">new_transform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>    
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>    
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">translation</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose translated by a vector.</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">        The translation is relative to the basis of the pose being translated (i.e body-fixed) rather than the parent frame.</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">        That means that</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">        ```python</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">        p2 = p1.translate((1, 0, 0))</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="sd">        ```</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a><span class="sd">        and</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">        ```python</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">        p2 = p1.in_frame(&quot;some_other_frame&quot;).translate((1, 0, 0)).in_frame(p1.frame)</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a><span class="sd">        ```</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a><span class="sd">        are identical, because the parent frame of a pose does not affect its translation.</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a><span class="sd">        Args:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a><span class="sd">            translation: The vector to translate by.</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a><span class="sd">            frame: The frame that the vector is relative to.</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="sd">        </span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a><span class="sd">        Returns:</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="sd">            A new pose translated by a vector.</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>            <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">translation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="n">self_frame_t_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>            <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="n">self_frame_t_frame</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">translation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>    
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>    <span class="k">def</span> <span class="nf">rotate_about_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated about an axis.</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a><span class="sd">        This is rotated in the basis of the pose being rotated (i.e body-fixed) rather than the parent frame, and it only</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a><span class="sd">        rotates the orientation. This is *not* a rotation about the origin, but a change of the orientation of the pose.</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a><span class="sd">        If you pass a frame, the axis will be interpreted as being expressed in that frame.</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="sd">        </span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="sd">        Args:</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">            axis: The axis to rotate about.</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a><span class="sd">            angle: The angle to rotate by, in radians.</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a><span class="sd">            frame: The frame that the axis is relative to. If None, the axis is interpreted in the basis vectors of the pose (not the parent frame).</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a><span class="sd">        </span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a><span class="sd">        Returns:</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a><span class="sd">            A new pose with the same location but rotated about an axis.</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="n">axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-6</span><span class="p">:</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Axis must be a unit vector.&quot;</span><span class="p">)</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>            <span class="n">new_rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_rotvec</span><span class="p">(</span><span class="n">axis</span> <span class="o">*</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>            <span class="n">frame_t_self_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>            <span class="n">new_rotation</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_rotvec</span><span class="p">(</span><span class="n">frame_t_self_frame</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span> <span class="o">*</span> <span class="n">angle</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">new_rotation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>    
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>    <span class="k">def</span> <span class="nf">rotate_about_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated about the x axis.</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">        </span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="sd">        Args:</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">            angle: The angle to rotate by, in radians.</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">            frame: The frame that the axis is relative to. If not provided, it will rotate about the x-unit-vector of the pose being rotated.</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">        </span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="sd">        Returns:</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">            A new pose with the same location but rotated about the x axis.</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_about_axis</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>    
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>    <span class="k">def</span> <span class="nf">rotate_about_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated about the y axis.</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">        </span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">        Args:</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">            angle: The angle to rotate by, in radians.</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">            frame: The frame that the axis is relative to. If not provided, it will rotate about the y-unit-vector of the pose being rotated.</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">        </span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">        Returns:</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">            A new pose with the same location but rotated about the y axis.</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_about_axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>    
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>    <span class="k">def</span> <span class="nf">rotate_about_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated about the z axis.</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">        </span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">        Args:</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">            angle: The angle to rotate by, in radians.</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a><span class="sd">            frame: The frame that the axis is relative to. If not provided, it will rotate about the z-unit-vector of the pose being rotated.</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="sd">        </span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="sd">        Returns:</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a><span class="sd">            A new pose with the same location but rotated about the z axis.</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_about_axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">angle</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>    
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>    <span class="k">def</span> <span class="nf">point_x_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated to point the x axis at a target pose.</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        </span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">        Args:</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">            target: The target pose to point at.</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="sd">            fixed_axis: An optional axis (&#39;x&#39;, &#39;y&#39; or &#39;z&#39;) to keep fixed. If not provided,</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="sd">                the pose will be rotated the minimum rotation to have the axis point at the target pose.</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="sd">        </span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="sd">        Returns:</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="sd">            A new pose with the same location but rotated to point the x axis at a target pose.</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_point_at</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">fixed_axis</span><span class="p">)</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>    
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>    <span class="k">def</span> <span class="nf">point_y_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated to point the y axis at a target pose.</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">        </span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a><span class="sd">        Args:</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a><span class="sd">            target: The target pose to point at.</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a><span class="sd">            fixed_axis: An optional axis (&#39;x&#39;, &#39;y&#39; or &#39;z&#39;) to keep fixed. If not provided,</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a><span class="sd">                the pose will be rotated the minimum rotation to have the axis point at the target pose.</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a><span class="sd">        </span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a><span class="sd">        Returns:</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a><span class="sd">            A new pose with the same location but rotated to point the y axis at a target pose.</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_point_at</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">fixed_axis</span><span class="p">)</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>    
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>    <span class="k">def</span> <span class="nf">point_z_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated to point the z axis at a target pose.</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a><span class="sd">        </span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="sd">        Args:</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a><span class="sd">            target: The target pose to point at.</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a><span class="sd">        </span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">        Returns:</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a><span class="sd">            A new pose with the same location but rotated to point the z axis at a target pose.</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_point_at</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">fixed_axis</span><span class="p">)</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>    
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>    <span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose interpolated between two poses, in the frame of the first pose.</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a><span class="sd">        </span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">        Args:</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">            target: The target pose to interpolate to.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">            alpha: The interpolation factor. 0.0 will return the current pose, 1.0 will return</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">                the target pose and values in between will return a pose interpolated between the two.</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">        </span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">        Returns:</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">            A new pose interpolated between two poses.</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">alpha</span><span class="p">))</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>    
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>    <span class="k">def</span> <span class="nf">distance_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the cartesian distance between two poses.</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="sd">        </span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">        Args:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">            other: The other pose.</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">        </span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">        Returns:</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">            The distance between two poses.</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>    
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>    <span class="k">def</span> <span class="nf">angle_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the angle between two poses&#39; orientations. Ignores position. Will convert to the same frame.</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a><span class="sd">        </span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a><span class="sd">        This gives the magnitude of the minimal rotation that will align the two poses.</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a><span class="sd">        Args:</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="sd">            target: The target pose.</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a><span class="sd">        </span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a><span class="sd">        Returns:</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a><span class="sd">            The angle between two poses, in radians.</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">angle_to</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>    
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>    <span class="k">def</span> <span class="nf">_angle_about_axis_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the signed angle between two poses&#39; orientations about an axis. Ignores position. Will convert to the same frame.</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a><span class="sd">        </span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a><span class="sd">        Args:</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a><span class="sd">            target: The target pose.</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="sd">            axis: The axis to rotate about.</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a><span class="sd">        </span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="sd">        Returns:</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a><span class="sd">            The angle between two poses.</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a><span class="sd">        Raises:</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a><span class="sd">            ValueError: If the rotation is more than 20% out of the expected axis.</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>        <span class="n">relative_rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span> <span class="o">*</span> <span class="n">target</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotation</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>        <span class="n">relative_rotvec</span> <span class="o">=</span> <span class="n">relative_rotation</span><span class="o">.</span><span class="n">as_rotvec</span><span class="p">()</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>        <span class="n">in_axis_rotation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">relative_rotvec</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>        <span class="n">out_of_axis_rotation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">relative_rotvec</span> <span class="o">-</span> <span class="n">in_axis_rotation</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">axis</span><span class="p">))</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">in_axis_rotation</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">out_of_axis_rotation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">out_of_axis_rotation</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">in_axis_rotation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.2</span><span class="p">:</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Rotation between poses is more than 20</span><span class="si">% o</span><span class="s2">ut of expected axis.&quot;</span><span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>        <span class="k">return</span> <span class="n">in_axis_rotation</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>    
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>    <span class="k">def</span> <span class="nf">angle_about_x_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the signed angle between two poses&#39; orientations about the x axis. Ignores position. Will convert to the same frame.</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        </span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">        Args:</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">            target: The target pose.</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a><span class="sd">        </span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">        Returns:</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="sd">            The angle between two poses, in radians.</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a><span class="sd">        Raises:</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a><span class="sd">            ValueError: If the rotation is more than 20% out of the expected axis.</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angle_about_axis_to</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> 
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>    
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>    
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>    <span class="k">def</span> <span class="nf">angle_about_y_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the signed angle between two poses&#39; orientations about the y axis. Ignores position. Will convert to the same frame.</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a><span class="sd">        </span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a><span class="sd">        Args:</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a><span class="sd">            target: The target pose.</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a><span class="sd">        </span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a><span class="sd">        Returns:</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">            The angle between two poses, in radians.</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">        Raises:</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a><span class="sd">            ValueError: If the rotation is more than 20% out of the expected axis.</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angle_about_axis_to</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>    
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>    <span class="k">def</span> <span class="nf">angle_about_z_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the signed angle between two poses&#39; orientations about the z axis. Ignores position. Will convert to the same frame.</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">        </span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">        Args:</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a><span class="sd">            target: The target pose.</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a><span class="sd">        </span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a><span class="sd">        Returns:</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a><span class="sd">            The angle between two poses, in radians.</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a><span class="sd">        Raises:</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">            ValueError: If the rotation is more than 20% out of the expected axis.</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angle_about_axis_to</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>    <span class="k">def</span> <span class="nf">_point_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated to point at a target pose.</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a><span class="sd">        </span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a><span class="sd">        Args:</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a><span class="sd">            target: The target pose to point at.</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a><span class="sd">            axis: The axis to rotate about.</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">            fixed_axis: An optional axis (&#39;x&#39;, &#39;y&#39; or &#39;z&#39;) to keep fixed. If not provided,</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a><span class="sd">                the pose will be rotated the minimum rotation to have the axis point at the target pose..</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a><span class="sd">        </span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a><span class="sd">        Returns:</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a><span class="sd">            A new pose with the same location but rotated to point at a target pose.</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a><span class="sd">        </span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>        <span class="n">delta</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>        <span class="n">delta_local</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>        <span class="n">delta_rotation</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">align_vectors</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">delta_local</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">axis</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>        <span class="k">if</span> <span class="n">fixed_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_rotation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">delta_rotation</span><span class="p">)</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>        <span class="k">if</span> <span class="n">fixed_axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>            <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span><span class="p">,</span> <span class="n">rx</span> <span class="o">=</span> <span class="n">delta_rotation</span><span class="o">.</span><span class="n">as_euler</span><span class="p">(</span><span class="s1">&#39;yzx&#39;</span><span class="p">)</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_rotation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_euler</span><span class="p">(</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">rx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>        <span class="k">elif</span> <span class="n">fixed_axis</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>            <span class="n">rx</span><span class="p">,</span> <span class="n">rz</span><span class="p">,</span> <span class="n">ry</span> <span class="o">=</span> <span class="n">delta_rotation</span><span class="o">.</span><span class="n">as_euler</span><span class="p">(</span><span class="s1">&#39;xzy&#39;</span><span class="p">)</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_rotation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_euler</span><span class="p">(</span><span class="s1">&#39;yxz&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">ry</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>        <span class="k">elif</span> <span class="n">fixed_axis</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>            <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span> <span class="o">=</span> <span class="n">delta_rotation</span><span class="o">.</span><span class="n">as_euler</span><span class="p">(</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_rotation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_euler</span><span class="p">(</span><span class="s1">&#39;zxy&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">rz</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;fixed_axis must be one of &#39;x&#39;, &#39;y&#39;, or &#39;z&#39;.&quot;</span><span class="p">)</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>    
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Pose(transform=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="si">}</span><span class="s2">, frame=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>    <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a><span class="k">class</span> <span class="nc">PoseTree</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class to manage poses and frames.</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a><span class="sd">    </span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a><span class="sd">    To hook up this library to your project, you should subclass this class and hook it up to your stream of transforms</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a><span class="sd">    by implementing _get_transform. Usually this will look like adding a callback-subscribe method to your class and storing</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a><span class="sd">    the transforms between important frames as they come in. If you don&#39;t already have a way of interpolating between transforms,</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a><span class="sd">    check out ROS&#39;s tf2 library. This library is designed to wrap nicely on top of tf2, if you are already using it.</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a><span class="sd">    </span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a><span class="sd">    </span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>    <span class="k">def</span> <span class="nf">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transform from the parent frame to the child frame.&quot;&quot;&quot;</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_transform</span><span class="p">(</span><span class="n">parent_frame</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>    
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>    <span class="k">def</span> <span class="nf">get_pose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">quaternion</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Pose</span><span class="p">:</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose object from a position, quaternion, and parent frame. Essentially syntactic sugar on top of Pose&#39;s constructor.&quot;&quot;&quot;</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">Transform</span><span class="o">.</span><span class="n">from_position_and_quaternion</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">quaternion</span><span class="p">),</span> <span class="n">parent_frame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>    
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>    <span class="nd">@contextmanager</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>    <span class="k">def</span> <span class="nf">temporary_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="n">Pose</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a temporary frame from a pose.</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a><span class="sd">        </span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a><span class="sd">        This is intended to be used for anonymous frames for doing calculations.</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a><span class="sd">        Example 1, find an approach angle that is close to the robot base:</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a><span class="sd">        ```python</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a><span class="sd">        for theta in np.linspace(0, 2 * np.pi, 100):</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">            with tree.temporary_frame(target_pose.rotate_about_z(theta)) as approach_frame:</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a><span class="sd">                if abs(robot_base_pose.in_frame(approach_frame).y) &lt; 0.1:</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a><span class="sd">                    return theta</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a><span class="sd">        ```</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a><span class="sd">        Example 2, find a person that is ready to talk to the robot:</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a><span class="sd">        ```python</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a><span class="sd">        for person in people:</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a><span class="sd">            with tree.temporary_frame(person.head_pose) as head_frame:</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a><span class="sd">            x, y, _ = robot_base_pose.in_frame(head_frame).position</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a><span class="sd">                if abs(y) &lt; 0.5 and 0.5 &lt; x &lt; 1.5:</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a><span class="sd">                    return person</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a><span class="sd">        ```</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_frame</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>            <span class="k">yield</span> <span class="n">name</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>        <span class="k">finally</span><span class="p">:</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">remove_frame</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>    
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>    <span class="k">def</span> <span class="nf">_get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transform from the parent frame to the child frame. </span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a><span class="sd">        </span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a><span class="sd">        Args:</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a><span class="sd">            parent_frame: The name of the parent frame.</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a><span class="sd">            child_frame: The name of the child frame.</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a><span class="sd">            timestamp: The timestamp of the transform. If None, the latest transform is returned.</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>        <span class="k">pass</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>    <span class="k">def</span> <span class="nf">add_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="n">Pose</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a static frame to the tree.</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a><span class="sd">        Example:</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a><span class="sd">        ```python</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a><span class="sd">        pose_tree.add_frame(table_corner_pose, &#39;table_frame&#39;)</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a><span class="sd">        # Look at center of table:</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a><span class="sd">        robot.look_at(</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a><span class="sd">            Pose.from_position_and_rotation(</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a><span class="sd">                [table_size_x / 2, tablesize_y_y / 2, 0],</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a><span class="sd">                Rotation.identity(),</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a><span class="sd">                &#39;table_frame&#39;))</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a><span class="sd">        ```</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a><span class="sd">        Don&#39;t use this for scratch frames for doing calculations. Use the temporary_frame context manager instead. This should </span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a><span class="sd">        be used for permanant, human meaningful things like a workspace frame.</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a><span class="sd">        This is also not a good solution for frames that are moving, as the frames will not be interpolated to particular timestamps.</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a><span class="sd">        </span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a><span class="sd">        Args:</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a><span class="sd">            pose: The pose of the new frame relative to the parent frame.</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a><span class="sd">            name: The name of the new frame.</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>        <span class="k">pass</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>    <span class="k">def</span> <span class="nf">remove_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a static frame from the tree.&quot;&quot;&quot;</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>        <span class="k">pass</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a><span class="k">class</span> <span class="nc">CustomFramePoseTree</span><span class="p">(</span><span class="n">PoseTree</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A abstract PoseTree implementation that implements custom frames.</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a><span class="sd">    </span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a><span class="sd">    This is useful if your underlying pose structure doesn&#39;t support custom frames. You subclass this</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a><span class="sd">    class and implement the _get_transform method and get full custom frame support. In a pinch you can implement</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a><span class="sd">    _get_transform to raise a NotImplemented error and use &#39;add frame&#39; but it is not particularly efficient and does</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a><span class="sd">    not implement interpolation to particular timestamps, which will cause problems if you are getting sensor</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a><span class="sd">    information off a moving robot.</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a>    <span class="k">def</span> <span class="nf">add_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="n">Pose</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a frame to the tree. This is assumed to be a static frame, and will not be interpolated.</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a><span class="sd">        If that frame is already present, this will update the frame to a new pose.</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a><span class="sd">        Args:</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a><span class="sd">            pose: The pose of the new frame relative to the parent frame.</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a><span class="sd">            name: The name of the new frame.</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pose</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>    <span class="k">def</span> <span class="nf">remove_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a custom frame from the tree.</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a><span class="sd">        </span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a><span class="sd">        This method is idempotent. If the frame is not present, it will do nothing.</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">:</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a>    <span class="k">def</span> <span class="nf">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transform from the parent frame to the child frame, at the timestamp.&quot;&quot;&quot;</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>        <span class="k">if</span> <span class="n">child_frame</span> <span class="o">==</span> <span class="n">parent_frame</span><span class="p">:</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>            <span class="k">return</span> <span class="n">Transform</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>        <span class="k">if</span> <span class="n">child_frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">:</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>            <span class="n">child_root_pose_child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">[</span><span class="n">child_frame</span><span class="p">]</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>            <span class="n">parent_t_child_root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">parent_frame</span><span class="p">,</span> <span class="n">child_root_pose_child</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>            <span class="k">return</span> <span class="n">parent_t_child_root</span> <span class="o">*</span> <span class="n">child_root_pose_child</span><span class="o">.</span><span class="n">transform</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>        <span class="k">elif</span> <span class="n">parent_frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">:</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>            <span class="n">parent_root_pose_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">[</span><span class="n">parent_frame</span><span class="p">]</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>            <span class="n">parent_root_t_child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">parent_root_pose_parent</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>            <span class="n">parent_t_parent_root</span> <span class="o">=</span> <span class="n">parent_root_pose_parent</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">inverse</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">parent_t_parent_root</span> <span class="o">*</span> <span class="n">parent_root_t_child</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_transform</span><span class="p">(</span><span class="n">parent_frame</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>    <span class="k">def</span> <span class="nf">_get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transform from the parent frame to the child frame.&quot;&quot;&quot;</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a><span class="k">class</span> <span class="nc">Transform</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A homogenous transform from a pose or frame to another location and rotation.</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a><span class="sd">    </span>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a><span class="sd">    In posetree, a Transform is a verb. It describes how to transform a pose from one frame to another.</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a><span class="sd">    Almost all the time, you want to turn your raw data objects (coming from forward kinematics or perception or </span>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a><span class="sd">    localization) into a Pose object as soon as possible, and only go through Transforms at the borders of your sdk.</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a>
</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a><span class="sd">    Using Transform objects instead of Pose objects is usually a code smell, unless you&#39;re doing something really</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a><span class="sd">    mathy with a bunch of intermediate transforms.</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a>
</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">rotation</span><span class="p">:</span> <span class="n">Rotation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a transform from a position and rotation.</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a><span class="sd">        </span>
</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a><span class="sd">        Args:</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos">741</span></a><span class="sd">            position: The position of the transform.</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a><span class="sd">            rotation: The rotation of the transform.</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos">743</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos">744</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos">745</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="n">rotation</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos">746</span></a>
</span><span id="L-747"><a href="#L-747"><span class="linenos">747</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos">748</span></a>    <span class="k">def</span> <span class="nf">from_position_and_quaternion</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">quaternion</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos">749</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a transform from a position and quaternion.</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos">750</span></a><span class="sd">        </span>
</span><span id="L-751"><a href="#L-751"><span class="linenos">751</span></a><span class="sd">        Args:</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos">752</span></a><span class="sd">            position: The position of the transform.</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos">753</span></a><span class="sd">            quaternion: The quaternion of the transform, in xyzw order.</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos">754</span></a><span class="sd">        </span>
</span><span id="L-755"><a href="#L-755"><span class="linenos">755</span></a><span class="sd">        Returns:</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos">756</span></a><span class="sd">            A new transform.</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos">757</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos">758</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">quaternion</span><span class="p">))</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos">759</span></a>
</span><span id="L-760"><a href="#L-760"><span class="linenos">760</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos">761</span></a>    <span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos">762</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the identity transform.&quot;&quot;&quot;</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos">763</span></a>        <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">identity</span><span class="p">())</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos">764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos">765</span></a>    <span class="nd">@property</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos">766</span></a>    <span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos">767</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The inverse of the transform.</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos">768</span></a><span class="sd">        </span>
</span><span id="L-769"><a href="#L-769"><span class="linenos">769</span></a><span class="sd">        How to get back from applying this transform.</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos">770</span></a>
</span><span id="L-771"><a href="#L-771"><span class="linenos">771</span></a><span class="sd">        t1 * t1.inverse == Transform.identity()</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos">772</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos">773</span></a>        <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">inv</span><span class="p">())</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos">774</span></a>
</span><span id="L-775"><a href="#L-775"><span class="linenos">775</span></a>    <span class="nd">@property</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos">776</span></a>    <span class="k">def</span> <span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos">777</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The 1x3 cartesian position of the transform.&quot;&quot;&quot;</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos">778</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos">779</span></a>    
</span><span id="L-780"><a href="#L-780"><span class="linenos">780</span></a>    <span class="nd">@property</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos">781</span></a>    <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rotation</span><span class="p">:</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos">782</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The rotation component of the transform.&quot;&quot;&quot;</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos">783</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos">784</span></a>    
</span><span id="L-785"><a href="#L-785"><span class="linenos">785</span></a>    <span class="nd">@property</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos">786</span></a>    <span class="k">def</span> <span class="nf">x_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos">787</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The x axis of the transform.</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos">788</span></a><span class="sd">        </span>
</span><span id="L-789"><a href="#L-789"><span class="linenos">789</span></a><span class="sd">        This is the unit vector, in the parent frame, pointing in the new x direction, after applying the transform.</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos">790</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos">791</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos">792</span></a>    
</span><span id="L-793"><a href="#L-793"><span class="linenos">793</span></a>    <span class="nd">@property</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos">794</span></a>    <span class="k">def</span> <span class="nf">y_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos">795</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The y axis of the transform.</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos">796</span></a><span class="sd">        </span>
</span><span id="L-797"><a href="#L-797"><span class="linenos">797</span></a><span class="sd">        This is the unit vector, in the parent frame, pointing in the new y direction, after applying the transform.</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos">798</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos">799</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos">800</span></a>    
</span><span id="L-801"><a href="#L-801"><span class="linenos">801</span></a>    <span class="nd">@property</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos">802</span></a>    <span class="k">def</span> <span class="nf">z_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos">803</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The z axis of the transform.</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos">804</span></a><span class="sd">                </span>
</span><span id="L-805"><a href="#L-805"><span class="linenos">805</span></a><span class="sd">        This is the unit vector, in the parent frame, pointing in the new z direction, after applying the transform.</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos">806</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos">807</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span> 
</span><span id="L-808"><a href="#L-808"><span class="linenos">808</span></a>    
</span><span id="L-809"><a href="#L-809"><span class="linenos">809</span></a>    <span class="nd">@property</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos">810</span></a>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos">811</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The x coordinate of the transform.&quot;&quot;&quot;</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos">812</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos">813</span></a>    
</span><span id="L-814"><a href="#L-814"><span class="linenos">814</span></a>    <span class="nd">@property</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos">815</span></a>    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos">816</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The y coordinate of the transform.&quot;&quot;&quot;</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos">817</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos">818</span></a>    
</span><span id="L-819"><a href="#L-819"><span class="linenos">819</span></a>    <span class="nd">@property</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos">820</span></a>    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos">821</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The z coordinate of the transform.&quot;&quot;&quot;</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos">822</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos">823</span></a>    
</span><span id="L-824"><a href="#L-824"><span class="linenos">824</span></a>    <span class="k">def</span> <span class="nf">to_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos">825</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the 4x4 matrix representation of the transform.&quot;&quot;&quot;</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos">826</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos">827</span></a>        <span class="n">matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos">828</span></a>        <span class="n">matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos">829</span></a>        <span class="k">return</span> <span class="n">matrix</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos">830</span></a>    
</span><span id="L-831"><a href="#L-831"><span class="linenos">831</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos">832</span></a>    <span class="k">def</span> <span class="nf">from_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">matrix</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos">833</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a transform from a matrix.</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos">834</span></a><span class="sd">        </span>
</span><span id="L-835"><a href="#L-835"><span class="linenos">835</span></a><span class="sd">        Args:</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos">836</span></a><span class="sd">            matrix: The matrix of the transform.</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos">837</span></a><span class="sd">        </span>
</span><span id="L-838"><a href="#L-838"><span class="linenos">838</span></a><span class="sd">        Returns:</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos">839</span></a><span class="sd">            A new transform.</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos">840</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos">841</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos">842</span></a>        <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="n">matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]))</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos">843</span></a>
</span><span id="L-844"><a href="#L-844"><span class="linenos">844</span></a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Transform&quot;</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos">845</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Multiply this transform by another transform or vector.</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos">846</span></a>
</span><span id="L-847"><a href="#L-847"><span class="linenos">847</span></a><span class="sd">        If other is a transform, this is equivalent to applying this transform, then the other transform.</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos">848</span></a><span class="sd">        If other is a vector, this is equivalent to applying this transform to the vector.</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos">849</span></a><span class="sd">        </span>
</span><span id="L-850"><a href="#L-850"><span class="linenos">850</span></a><span class="sd">        Args:</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos">851</span></a><span class="sd">            other: The transform or vector to multiply.</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos">852</span></a><span class="sd">        </span>
</span><span id="L-853"><a href="#L-853"><span class="linenos">853</span></a><span class="sd">        Returns:</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos">854</span></a><span class="sd">            The product of the two transforms.</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos">855</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos">856</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Transform</span><span class="p">):</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos">857</span></a>          <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">position</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos">858</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos">859</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos">860</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos">861</span></a>        
</span><span id="L-862"><a href="#L-862"><span class="linenos">862</span></a>    <span class="fm">__mul__</span> <span class="o">=</span> <span class="n">apply</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos">863</span></a>        
</span><span id="L-864"><a href="#L-864"><span class="linenos">864</span></a>    <span class="k">def</span> <span class="nf">almost_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos">865</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two transforms are almost equal.</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos">866</span></a><span class="sd">        </span>
</span><span id="L-867"><a href="#L-867"><span class="linenos">867</span></a><span class="sd">        Handles floating point error in the position and rotation, and the fact that for quaternions negating </span>
</span><span id="L-868"><a href="#L-868"><span class="linenos">868</span></a><span class="sd">        the vector gives the same rotation.</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos">869</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos">870</span></a>        <span class="c1"># Check if positions are almost equal.</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos">871</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_position</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_position</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos">872</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos">873</span></a>        <span class="c1"># Check if rotations are almost equal.</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos">874</span></a>        <span class="c1"># Since quaternion [x, y, z, w] represents the same rotation as [-x, -y, -z, -w], we also need to check the inverse quaternion.</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos">875</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos">876</span></a>                <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="o">-</span><span class="n">other</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)):</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos">877</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos">878</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos">879</span></a>    
</span><span id="L-880"><a href="#L-880"><span class="linenos">880</span></a>    <span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos">881</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Interpolate between two transforms.</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos">882</span></a><span class="sd">        </span>
</span><span id="L-883"><a href="#L-883"><span class="linenos">883</span></a><span class="sd">        Args:</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos">884</span></a><span class="sd">            other: The other transform to interpolate with.</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos">885</span></a><span class="sd">            alpha: The interpolation factor. 0 gives this transform, 1 gives the other transform.</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos">886</span></a><span class="sd">        </span>
</span><span id="L-887"><a href="#L-887"><span class="linenos">887</span></a><span class="sd">        Returns:</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos">888</span></a><span class="sd">            The interpolated transform.</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos">889</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos">890</span></a>        <span class="c1"># Combine the rotations into a single Rotation object</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos">891</span></a>        <span class="n">rotations</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())))</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos">892</span></a>        <span class="n">slerp</span> <span class="o">=</span> <span class="n">Slerp</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">rotations</span><span class="p">)</span>    
</span><span id="L-893"><a href="#L-893"><span class="linenos">893</span></a>        <span class="n">new_rotation</span><span class="o">=</span> <span class="n">slerp</span><span class="p">([</span><span class="n">alpha</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos">894</span></a>        <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">position</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">new_rotation</span><span class="p">)</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos">895</span></a>    
</span><span id="L-896"><a href="#L-896"><span class="linenos">896</span></a>    <span class="k">def</span> <span class="nf">angle_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos">897</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the angle between two transforms&#39; orientations. Ignores position.</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos">898</span></a><span class="sd">        </span>
</span><span id="L-899"><a href="#L-899"><span class="linenos">899</span></a><span class="sd">        Args:</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos">900</span></a><span class="sd">            target: The target transform.</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos">901</span></a><span class="sd">        </span>
</span><span id="L-902"><a href="#L-902"><span class="linenos">902</span></a><span class="sd">        Returns:</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos">903</span></a><span class="sd">            The angle between two transform, in radians.</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos">904</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos">905</span></a>        <span class="n">relative_rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span> <span class="o">*</span> <span class="n">target</span><span class="o">.</span><span class="n">rotation</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos">906</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">relative_rotation</span><span class="o">.</span><span class="n">as_rotvec</span><span class="p">())</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos">907</span></a>    
</span><span id="L-908"><a href="#L-908"><span class="linenos">908</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos">909</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two transforms are equal.&quot;&quot;&quot;</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos">910</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">almost_equal</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos">911</span></a>
</span><span id="L-912"><a href="#L-912"><span class="linenos">912</span></a>    
</span><span id="L-913"><a href="#L-913"><span class="linenos">913</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos">914</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Transform(position=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="si">}</span><span class="s2">, rotation=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos">915</span></a>    <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos">916</span></a>            
</span></pre></div>


            </section>
                <section id="Pose">
                            <input id="Pose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Pose</span>:

                <label class="view-source-button" for="Pose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose-22"><a href="#Pose-22"><span class="linenos"> 22</span></a><span class="k">class</span> <span class="nc">Pose</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="Pose-23"><a href="#Pose-23"><span class="linenos"> 23</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose-24"><a href="#Pose-24"><span class="linenos"> 24</span></a><span class="sd">    A Pose is an immutable location and orientation in 3D space.</span>
</span><span id="Pose-25"><a href="#Pose-25"><span class="linenos"> 25</span></a><span class="sd">    A pose is defined with a `parent_frame` (where to start) and a transform (how to get to the pose from the parent frame).</span>
</span><span id="Pose-26"><a href="#Pose-26"><span class="linenos"> 26</span></a>
</span><span id="Pose-27"><a href="#Pose-27"><span class="linenos"> 27</span></a><span class="sd">    Note: While a Pose is immutable, the parent frame can (and does!) change over time relative to other frames, meaning that an individual pose can move relative</span>
</span><span id="Pose-28"><a href="#Pose-28"><span class="linenos"> 28</span></a><span class="sd">    to other frames. (For example a pose defined in the &quot;robot&quot; frame will conceptually move as the robot moves relative to a &#39;world&#39;</span>
</span><span id="Pose-29"><a href="#Pose-29"><span class="linenos"> 29</span></a><span class="sd">    frame, even though its position and orientation remain immutably constant.)</span>
</span><span id="Pose-30"><a href="#Pose-30"><span class="linenos"> 30</span></a>
</span><span id="Pose-31"><a href="#Pose-31"><span class="linenos"> 31</span></a><span class="sd">    To make this very concrete, say the robot starts out at the world origin:</span>
</span><span id="Pose-32"><a href="#Pose-32"><span class="linenos"> 32</span></a>
</span><span id="Pose-33"><a href="#Pose-33"><span class="linenos"> 33</span></a><span class="sd">    ```python</span>
</span><span id="Pose-34"><a href="#Pose-34"><span class="linenos"> 34</span></a><span class="sd">    pose_in_robot_frame = pose.from_position_and_rotation([1,2,3], Rotation.identity(), &quot;robot&quot;, pose_tree)</span>
</span><span id="Pose-35"><a href="#Pose-35"><span class="linenos"> 35</span></a><span class="sd">    pose_in_world_frame = pose_in_robot_frame.in_frame(&quot;world&quot;)</span>
</span><span id="Pose-36"><a href="#Pose-36"><span class="linenos"> 36</span></a>
</span><span id="Pose-37"><a href="#Pose-37"><span class="linenos"> 37</span></a><span class="sd">    pose_in_robot_frame.position # [1,2,3]</span>
</span><span id="Pose-38"><a href="#Pose-38"><span class="linenos"> 38</span></a><span class="sd">    pose_in_world_frame.position # [1,2,3]</span>
</span><span id="Pose-39"><a href="#Pose-39"><span class="linenos"> 39</span></a>
</span><span id="Pose-40"><a href="#Pose-40"><span class="linenos"> 40</span></a><span class="sd">    # Now the robot moves 1 meter forward in the world frame.</span>
</span><span id="Pose-41"><a href="#Pose-41"><span class="linenos"> 41</span></a><span class="sd">    robot.drive_forward_in_x(1)</span>
</span><span id="Pose-42"><a href="#Pose-42"><span class="linenos"> 42</span></a>
</span><span id="Pose-43"><a href="#Pose-43"><span class="linenos"> 43</span></a><span class="sd">    # Poses are immutable so this has not changed. One pose is [1,2,3] from the robot frame origin, one is [1,2,3] from the world origin.</span>
</span><span id="Pose-44"><a href="#Pose-44"><span class="linenos"> 44</span></a><span class="sd">    pose_in_robot_frame.position # [1,2,3]</span>
</span><span id="Pose-45"><a href="#Pose-45"><span class="linenos"> 45</span></a><span class="sd">    pose_in_world_frame.position # [2,2,3]</span>
</span><span id="Pose-46"><a href="#Pose-46"><span class="linenos"> 46</span></a>
</span><span id="Pose-47"><a href="#Pose-47"><span class="linenos"> 47</span></a><span class="sd">    # But if we express the one in robot frame in the world frame, we see that it is now 1 meter forward in x.</span>
</span><span id="Pose-48"><a href="#Pose-48"><span class="linenos"> 48</span></a><span class="sd">    pose_in_robot_frame.in_frame(&quot;world&quot;).position # [2,2,3]</span>
</span><span id="Pose-49"><a href="#Pose-49"><span class="linenos"> 49</span></a>
</span><span id="Pose-50"><a href="#Pose-50"><span class="linenos"> 50</span></a><span class="sd">    ```</span>
</span><span id="Pose-51"><a href="#Pose-51"><span class="linenos"> 51</span></a><span class="sd">    Of course, the above example assumes that the `pose_tree` is correctly hooked up to the robot odometry system, so the poses know that the frames </span>
</span><span id="Pose-52"><a href="#Pose-52"><span class="linenos"> 52</span></a><span class="sd">    have moved.</span>
</span><span id="Pose-53"><a href="#Pose-53"><span class="linenos"> 53</span></a>
</span><span id="Pose-54"><a href="#Pose-54"><span class="linenos"> 54</span></a><span class="sd">    When constucting poses it is useful to think of what you expect the pose to be fixed relative to. For example, you might</span>
</span><span id="Pose-55"><a href="#Pose-55"><span class="linenos"> 55</span></a><span class="sd">    detect an apple on a table and get a pose from your perception system in the `camera` frame, but the apple is fixed relative to the table, so you will</span>
</span><span id="Pose-56"><a href="#Pose-56"><span class="linenos"> 56</span></a><span class="sd">    want to store your pose object with a the parent frame equal to `odometry/map/world`. Then, even if the robot moves, apple_pose will still refer to the</span>
</span><span id="Pose-57"><a href="#Pose-57"><span class="linenos"> 57</span></a><span class="sd">    best estimation of the apple&#39;s true location (with the usual caviats about localization drift and noise).</span>
</span><span id="Pose-58"><a href="#Pose-58"><span class="linenos"> 58</span></a>
</span><span id="Pose-59"><a href="#Pose-59"><span class="linenos"> 59</span></a><span class="sd">    ```</span>
</span><span id="Pose-60"><a href="#Pose-60"><span class="linenos"> 60</span></a><span class="sd">    apple_pose = Pose(camera_t_apple, &quot;camera&quot;, pose_tree).in_frame(&quot;world&quot;)</span>
</span><span id="Pose-61"><a href="#Pose-61"><span class="linenos"> 61</span></a><span class="sd">    ```</span>
</span><span id="Pose-62"><a href="#Pose-62"><span class="linenos"> 62</span></a>
</span><span id="Pose-63"><a href="#Pose-63"><span class="linenos"> 63</span></a><span class="sd">    Likewise if you have a bin on the back of a mobile robot and you want to define a drop-objects-into-bin pose right above it you can store</span>
</span><span id="Pose-64"><a href="#Pose-64"><span class="linenos"> 64</span></a><span class="sd">    that in the `robot` frame.</span>
</span><span id="Pose-65"><a href="#Pose-65"><span class="linenos"> 65</span></a>
</span><span id="Pose-66"><a href="#Pose-66"><span class="linenos"> 66</span></a><span class="sd">    ```</span>
</span><span id="Pose-67"><a href="#Pose-67"><span class="linenos"> 67</span></a><span class="sd">    drop_pose = Pose.from_position_and_quaternion([-.3, 0.1, 0.25], [0, 0, 0, 1]), &quot;robot&quot;, pose_tree)</span>
</span><span id="Pose-68"><a href="#Pose-68"><span class="linenos"> 68</span></a><span class="sd">    ```</span>
</span><span id="Pose-69"><a href="#Pose-69"><span class="linenos"> 69</span></a>
</span><span id="Pose-70"><a href="#Pose-70"><span class="linenos"> 70</span></a><span class="sd">    When designing motion APIs with this library, you should be liberal in what frames you accept, and internally convert them to the frame you want to work in. </span>
</span><span id="Pose-71"><a href="#Pose-71"><span class="linenos"> 71</span></a>
</span><span id="Pose-72"><a href="#Pose-72"><span class="linenos"> 72</span></a><span class="sd">    For example, in a function to move the arm to a pose:</span>
</span><span id="Pose-73"><a href="#Pose-73"><span class="linenos"> 73</span></a><span class="sd">    ```</span>
</span><span id="Pose-74"><a href="#Pose-74"><span class="linenos"> 74</span></a><span class="sd">    def move_to_pose(self, target_pose: Pose):</span>
</span><span id="Pose-75"><a href="#Pose-75"><span class="linenos"> 75</span></a><span class="sd">        # Convert the target to be relative to the base of the robot so we can execute the motion.</span>
</span><span id="Pose-76"><a href="#Pose-76"><span class="linenos"> 76</span></a><span class="sd">        target_pose = target_pose.in_frame(&quot;robot&quot;)</span>
</span><span id="Pose-77"><a href="#Pose-77"><span class="linenos"> 77</span></a>
</span><span id="Pose-78"><a href="#Pose-78"><span class="linenos"> 78</span></a><span class="sd">        # Best Practice: turn Poses into Transforms at the last moment before acting on them.</span>
</span><span id="Pose-79"><a href="#Pose-79"><span class="linenos"> 79</span></a><span class="sd">        arm_motion_primitives.move_arm_to_pose_relative_to_base(target_pose.transform)</span>
</span><span id="Pose-80"><a href="#Pose-80"><span class="linenos"> 80</span></a><span class="sd">    ```</span>
</span><span id="Pose-81"><a href="#Pose-81"><span class="linenos"> 81</span></a>
</span><span id="Pose-82"><a href="#Pose-82"><span class="linenos"> 82</span></a><span class="sd">    This formulation lets you combine the perception outputs and the motion methods for things like this:</span>
</span><span id="Pose-83"><a href="#Pose-83"><span class="linenos"> 83</span></a>
</span><span id="Pose-84"><a href="#Pose-84"><span class="linenos"> 84</span></a><span class="sd">    ```</span>
</span><span id="Pose-85"><a href="#Pose-85"><span class="linenos"> 85</span></a><span class="sd">    def grasp_apple(self, apple_pose: Pose):</span>
</span><span id="Pose-86"><a href="#Pose-86"><span class="linenos"> 86</span></a><span class="sd">        # pregrasp is a pose 15 cm above the apple, with z pointing at it.</span>
</span><span id="Pose-87"><a href="#Pose-87"><span class="linenos"> 87</span></a><span class="sd">        pregrasp = apple_pose.translate([0, 0, 0.15], frame=&quot;world&quot;).point_z_at(apple_pose)</span>
</span><span id="Pose-88"><a href="#Pose-88"><span class="linenos"> 88</span></a><span class="sd">        self.move_to_pose(pregrasp)</span>
</span><span id="Pose-89"><a href="#Pose-89"><span class="linenos"> 89</span></a>
</span><span id="Pose-90"><a href="#Pose-90"><span class="linenos"> 90</span></a><span class="sd">        # Move down in the local &#39;z&#39; of pregrasp until we touch the apple.</span>
</span><span id="Pose-91"><a href="#Pose-91"><span class="linenos"> 91</span></a><span class="sd">        self.move_to_pose_until_contact(pregrasp.translate([0, 0, 0.2]))</span>
</span><span id="Pose-92"><a href="#Pose-92"><span class="linenos"> 92</span></a>
</span><span id="Pose-93"><a href="#Pose-93"><span class="linenos"> 93</span></a><span class="sd">        # If we feel a contact too early, raise some reasonable error:</span>
</span><span id="Pose-94"><a href="#Pose-94"><span class="linenos"> 94</span></a><span class="sd">        # We can check the distance using distance_to, even though the frames are different.</span>
</span><span id="Pose-95"><a href="#Pose-95"><span class="linenos"> 95</span></a><span class="sd">        if apple_pose.distance_to(get_tool_pose()) &gt; 0.1:</span>
</span><span id="Pose-96"><a href="#Pose-96"><span class="linenos"> 96</span></a><span class="sd">            return &quot;Whoops, we probably didn&#39;t get the apple.&quot;</span>
</span><span id="Pose-97"><a href="#Pose-97"><span class="linenos"> 97</span></a>
</span><span id="Pose-98"><a href="#Pose-98"><span class="linenos"> 98</span></a><span class="sd">        # Close the gripper and move up a bit from where ever we are, to lift the apple.</span>
</span><span id="Pose-99"><a href="#Pose-99"><span class="linenos"> 99</span></a><span class="sd">        self.close_gripper()</span>
</span><span id="Pose-100"><a href="#Pose-100"><span class="linenos">100</span></a><span class="sd">        self.move_to_pose(get_tool_pose().translate([0, 0, -0.1]))</span>
</span><span id="Pose-101"><a href="#Pose-101"><span class="linenos">101</span></a>
</span><span id="Pose-102"><a href="#Pose-102"><span class="linenos">102</span></a><span class="sd">        # Drop it in the bin.</span>
</span><span id="Pose-103"><a href="#Pose-103"><span class="linenos">103</span></a><span class="sd">        self.move_to_pose(drop_pose)</span>
</span><span id="Pose-104"><a href="#Pose-104"><span class="linenos">104</span></a><span class="sd">        self.open_gripper()</span>
</span><span id="Pose-105"><a href="#Pose-105"><span class="linenos">105</span></a><span class="sd">    ```</span>
</span><span id="Pose-106"><a href="#Pose-106"><span class="linenos">106</span></a>
</span><span id="Pose-107"><a href="#Pose-107"><span class="linenos">107</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Pose-108"><a href="#Pose-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">:</span> <span class="s2">&quot;PoseTree&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose-109"><a href="#Pose-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a transform, frame, and pose tree.</span>
</span><span id="Pose-110"><a href="#Pose-110"><span class="linenos">110</span></a><span class="sd">        </span>
</span><span id="Pose-111"><a href="#Pose-111"><span class="linenos">111</span></a><span class="sd">        Args:</span>
</span><span id="Pose-112"><a href="#Pose-112"><span class="linenos">112</span></a><span class="sd">            transform: The transform from the frame to the pose.</span>
</span><span id="Pose-113"><a href="#Pose-113"><span class="linenos">113</span></a><span class="sd">            parent_frame: The frame that the transform is relative to.</span>
</span><span id="Pose-114"><a href="#Pose-114"><span class="linenos">114</span></a><span class="sd">            pose_tree: The world that the pose exists in.</span>
</span><span id="Pose-115"><a href="#Pose-115"><span class="linenos">115</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-116"><a href="#Pose-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span> <span class="o">=</span> <span class="n">transform</span>
</span><span id="Pose-117"><a href="#Pose-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span> <span class="o">=</span> <span class="n">parent_frame</span>
</span><span id="Pose-118"><a href="#Pose-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pose_tree</span> <span class="o">=</span> <span class="n">pose_tree</span>
</span><span id="Pose-119"><a href="#Pose-119"><span class="linenos">119</span></a>
</span><span id="Pose-120"><a href="#Pose-120"><span class="linenos">120</span></a>    <span class="nd">@classmethod</span>
</span><span id="Pose-121"><a href="#Pose-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="nf">from_position_and_quaternion</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">quaternion</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">:</span> <span class="s2">&quot;PoseTree&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-122"><a href="#Pose-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a position and quaternion.</span>
</span><span id="Pose-123"><a href="#Pose-123"><span class="linenos">123</span></a><span class="sd">        </span>
</span><span id="Pose-124"><a href="#Pose-124"><span class="linenos">124</span></a><span class="sd">        Args:</span>
</span><span id="Pose-125"><a href="#Pose-125"><span class="linenos">125</span></a><span class="sd">            position: The position of the transform.</span>
</span><span id="Pose-126"><a href="#Pose-126"><span class="linenos">126</span></a><span class="sd">            quaternion: The quaternion of the transform, in xyzw order.</span>
</span><span id="Pose-127"><a href="#Pose-127"><span class="linenos">127</span></a><span class="sd">            parent_frame: The frame that the transform is relative to.</span>
</span><span id="Pose-128"><a href="#Pose-128"><span class="linenos">128</span></a><span class="sd">            pose_tree: The world that the pose exists in.</span>
</span><span id="Pose-129"><a href="#Pose-129"><span class="linenos">129</span></a><span class="sd">        </span>
</span><span id="Pose-130"><a href="#Pose-130"><span class="linenos">130</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-131"><a href="#Pose-131"><span class="linenos">131</span></a><span class="sd">            A new Pose.</span>
</span><span id="Pose-132"><a href="#Pose-132"><span class="linenos">132</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-133"><a href="#Pose-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">Transform</span><span class="o">.</span><span class="n">from_position_and_quaternion</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">quaternion</span><span class="p">),</span> <span class="n">parent_frame</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">)</span>
</span><span id="Pose-134"><a href="#Pose-134"><span class="linenos">134</span></a>    
</span><span id="Pose-135"><a href="#Pose-135"><span class="linenos">135</span></a>    <span class="nd">@classmethod</span>
</span><span id="Pose-136"><a href="#Pose-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">from_position_and_rotation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">rotation</span><span class="p">:</span> <span class="n">Rotation</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">:</span> <span class="s2">&quot;PoseTree&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-137"><a href="#Pose-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a transform from a position and rotatoin.</span>
</span><span id="Pose-138"><a href="#Pose-138"><span class="linenos">138</span></a><span class="sd">        </span>
</span><span id="Pose-139"><a href="#Pose-139"><span class="linenos">139</span></a><span class="sd">        Args:</span>
</span><span id="Pose-140"><a href="#Pose-140"><span class="linenos">140</span></a><span class="sd">            position: The position of the transform.</span>
</span><span id="Pose-141"><a href="#Pose-141"><span class="linenos">141</span></a><span class="sd">            rotation: The rotation of the transform.</span>
</span><span id="Pose-142"><a href="#Pose-142"><span class="linenos">142</span></a><span class="sd">            parent_frame: The frame that the transform is relative to.</span>
</span><span id="Pose-143"><a href="#Pose-143"><span class="linenos">143</span></a><span class="sd">            pose_tree: The world that the pose exists in.</span>
</span><span id="Pose-144"><a href="#Pose-144"><span class="linenos">144</span></a><span class="sd">        </span>
</span><span id="Pose-145"><a href="#Pose-145"><span class="linenos">145</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-146"><a href="#Pose-146"><span class="linenos">146</span></a><span class="sd">            A new Pose.</span>
</span><span id="Pose-147"><a href="#Pose-147"><span class="linenos">147</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-148"><a href="#Pose-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">Transform</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">),</span> <span class="n">parent_frame</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">)</span>
</span><span id="Pose-149"><a href="#Pose-149"><span class="linenos">149</span></a>
</span><span id="Pose-150"><a href="#Pose-150"><span class="linenos">150</span></a>    <span class="nd">@property</span>
</span><span id="Pose-151"><a href="#Pose-151"><span class="linenos">151</span></a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="Pose-152"><a href="#Pose-152"><span class="linenos">152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The transform from the parent frame to the pose.&quot;&quot;&quot;</span>
</span><span id="Pose-153"><a href="#Pose-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span>
</span><span id="Pose-154"><a href="#Pose-154"><span class="linenos">154</span></a>    
</span><span id="Pose-155"><a href="#Pose-155"><span class="linenos">155</span></a>    <span class="nd">@property</span>
</span><span id="Pose-156"><a href="#Pose-156"><span class="linenos">156</span></a>    <span class="k">def</span> <span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Pose-157"><a href="#Pose-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The position of the pose relative to the parent frame.&quot;&quot;&quot;</span>
</span><span id="Pose-158"><a href="#Pose-158"><span class="linenos">158</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">position</span>
</span><span id="Pose-159"><a href="#Pose-159"><span class="linenos">159</span></a>    
</span><span id="Pose-160"><a href="#Pose-160"><span class="linenos">160</span></a>    <span class="nd">@property</span>
</span><span id="Pose-161"><a href="#Pose-161"><span class="linenos">161</span></a>    <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rotation</span><span class="p">:</span>
</span><span id="Pose-162"><a href="#Pose-162"><span class="linenos">162</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The rotation of the pose relative to the parent frame.&quot;&quot;&quot;</span>
</span><span id="Pose-163"><a href="#Pose-163"><span class="linenos">163</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotation</span>
</span><span id="Pose-164"><a href="#Pose-164"><span class="linenos">164</span></a>    
</span><span id="Pose-165"><a href="#Pose-165"><span class="linenos">165</span></a>    <span class="nd">@property</span>
</span><span id="Pose-166"><a href="#Pose-166"><span class="linenos">166</span></a>    <span class="k">def</span> <span class="nf">frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Pose-167"><a href="#Pose-167"><span class="linenos">167</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The parent frame of the pose.&quot;&quot;&quot;</span>
</span><span id="Pose-168"><a href="#Pose-168"><span class="linenos">168</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span>
</span><span id="Pose-169"><a href="#Pose-169"><span class="linenos">169</span></a>    
</span><span id="Pose-170"><a href="#Pose-170"><span class="linenos">170</span></a>    <span class="nd">@property</span>
</span><span id="Pose-171"><a href="#Pose-171"><span class="linenos">171</span></a>    <span class="k">def</span> <span class="nf">pose_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PoseTree&quot;</span><span class="p">:</span>
</span><span id="Pose-172"><a href="#Pose-172"><span class="linenos">172</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The PoseTree object containing the world that the pose exists in.&quot;&quot;&quot;</span>
</span><span id="Pose-173"><a href="#Pose-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pose_tree</span>
</span><span id="Pose-174"><a href="#Pose-174"><span class="linenos">174</span></a>    
</span><span id="Pose-175"><a href="#Pose-175"><span class="linenos">175</span></a>    <span class="nd">@property</span>
</span><span id="Pose-176"><a href="#Pose-176"><span class="linenos">176</span></a>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose-177"><a href="#Pose-177"><span class="linenos">177</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The x coordinate of the position.&quot;&quot;&quot;</span>
</span><span id="Pose-178"><a href="#Pose-178"><span class="linenos">178</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">x</span>
</span><span id="Pose-179"><a href="#Pose-179"><span class="linenos">179</span></a>    
</span><span id="Pose-180"><a href="#Pose-180"><span class="linenos">180</span></a>    <span class="nd">@property</span>
</span><span id="Pose-181"><a href="#Pose-181"><span class="linenos">181</span></a>    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose-182"><a href="#Pose-182"><span class="linenos">182</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The y coordinate of the position.&quot;&quot;&quot;</span>
</span><span id="Pose-183"><a href="#Pose-183"><span class="linenos">183</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">y</span>
</span><span id="Pose-184"><a href="#Pose-184"><span class="linenos">184</span></a>    
</span><span id="Pose-185"><a href="#Pose-185"><span class="linenos">185</span></a>    <span class="nd">@property</span>
</span><span id="Pose-186"><a href="#Pose-186"><span class="linenos">186</span></a>    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose-187"><a href="#Pose-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The z coordinate of the position.&quot;&quot;&quot;</span>
</span><span id="Pose-188"><a href="#Pose-188"><span class="linenos">188</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">z</span>
</span><span id="Pose-189"><a href="#Pose-189"><span class="linenos">189</span></a>    
</span><span id="Pose-190"><a href="#Pose-190"><span class="linenos">190</span></a>    <span class="nd">@property</span>
</span><span id="Pose-191"><a href="#Pose-191"><span class="linenos">191</span></a>    <span class="k">def</span> <span class="nf">x_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Pose-192"><a href="#Pose-192"><span class="linenos">192</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The x axis of the pose.&quot;&quot;&quot;</span>
</span><span id="Pose-193"><a href="#Pose-193"><span class="linenos">193</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">x_axis</span>
</span><span id="Pose-194"><a href="#Pose-194"><span class="linenos">194</span></a>    
</span><span id="Pose-195"><a href="#Pose-195"><span class="linenos">195</span></a>    <span class="nd">@property</span>
</span><span id="Pose-196"><a href="#Pose-196"><span class="linenos">196</span></a>    <span class="k">def</span> <span class="nf">y_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Pose-197"><a href="#Pose-197"><span class="linenos">197</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The y axis of the pose.&quot;&quot;&quot;</span>
</span><span id="Pose-198"><a href="#Pose-198"><span class="linenos">198</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">y_axis</span>
</span><span id="Pose-199"><a href="#Pose-199"><span class="linenos">199</span></a>    
</span><span id="Pose-200"><a href="#Pose-200"><span class="linenos">200</span></a>    <span class="nd">@property</span>
</span><span id="Pose-201"><a href="#Pose-201"><span class="linenos">201</span></a>    <span class="k">def</span> <span class="nf">z_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Pose-202"><a href="#Pose-202"><span class="linenos">202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The z axis of the pose.&quot;&quot;&quot;</span>
</span><span id="Pose-203"><a href="#Pose-203"><span class="linenos">203</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">z_axis</span>
</span><span id="Pose-204"><a href="#Pose-204"><span class="linenos">204</span></a>    
</span><span id="Pose-205"><a href="#Pose-205"><span class="linenos">205</span></a>    <span class="k">def</span> <span class="nf">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-206"><a href="#Pose-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose representing the same location in space expressed in a different frame.</span>
</span><span id="Pose-207"><a href="#Pose-207"><span class="linenos">207</span></a><span class="sd">        </span>
</span><span id="Pose-208"><a href="#Pose-208"><span class="linenos">208</span></a><span class="sd">        Args:</span>
</span><span id="Pose-209"><a href="#Pose-209"><span class="linenos">209</span></a><span class="sd">            new_parent_frame: The new frame that the transform is relative to.</span>
</span><span id="Pose-210"><a href="#Pose-210"><span class="linenos">210</span></a><span class="sd">        </span>
</span><span id="Pose-211"><a href="#Pose-211"><span class="linenos">211</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-212"><a href="#Pose-212"><span class="linenos">212</span></a><span class="sd">            A new pose with the same transform but in a different frame.</span>
</span><span id="Pose-213"><a href="#Pose-213"><span class="linenos">213</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-214"><a href="#Pose-214"><span class="linenos">214</span></a>        <span class="n">new_transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">parent_frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span>
</span><span id="Pose-215"><a href="#Pose-215"><span class="linenos">215</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">new_transform</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="Pose-216"><a href="#Pose-216"><span class="linenos">216</span></a>    
</span><span id="Pose-217"><a href="#Pose-217"><span class="linenos">217</span></a>    <span class="k">def</span> <span class="nf">with_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-218"><a href="#Pose-218"><span class="linenos">218</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same rotation but a different location relative to the parent frame.</span>
</span><span id="Pose-219"><a href="#Pose-219"><span class="linenos">219</span></a><span class="sd">        </span>
</span><span id="Pose-220"><a href="#Pose-220"><span class="linenos">220</span></a><span class="sd">        Args:</span>
</span><span id="Pose-221"><a href="#Pose-221"><span class="linenos">221</span></a><span class="sd">            position: The new location of the pose.</span>
</span><span id="Pose-222"><a href="#Pose-222"><span class="linenos">222</span></a><span class="sd">        </span>
</span><span id="Pose-223"><a href="#Pose-223"><span class="linenos">223</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-224"><a href="#Pose-224"><span class="linenos">224</span></a><span class="sd">            A new pose with the same rotation but a different location.</span>
</span><span id="Pose-225"><a href="#Pose-225"><span class="linenos">225</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-226"><a href="#Pose-226"><span class="linenos">226</span></a>        <span class="n">new_transform</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span>
</span><span id="Pose-227"><a href="#Pose-227"><span class="linenos">227</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">new_transform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="Pose-228"><a href="#Pose-228"><span class="linenos">228</span></a>    
</span><span id="Pose-229"><a href="#Pose-229"><span class="linenos">229</span></a>    <span class="k">def</span> <span class="nf">with_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation</span><span class="p">:</span> <span class="n">Rotation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-230"><a href="#Pose-230"><span class="linenos">230</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same location but a different rotation.</span>
</span><span id="Pose-231"><a href="#Pose-231"><span class="linenos">231</span></a><span class="sd">        </span>
</span><span id="Pose-232"><a href="#Pose-232"><span class="linenos">232</span></a><span class="sd">        Args:</span>
</span><span id="Pose-233"><a href="#Pose-233"><span class="linenos">233</span></a><span class="sd">            rotation: The new rotation of the pose.</span>
</span><span id="Pose-234"><a href="#Pose-234"><span class="linenos">234</span></a><span class="sd">        </span>
</span><span id="Pose-235"><a href="#Pose-235"><span class="linenos">235</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-236"><a href="#Pose-236"><span class="linenos">236</span></a><span class="sd">            A new pose with the same location but a different rotation.</span>
</span><span id="Pose-237"><a href="#Pose-237"><span class="linenos">237</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-238"><a href="#Pose-238"><span class="linenos">238</span></a>        <span class="n">new_transform</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">)</span>
</span><span id="Pose-239"><a href="#Pose-239"><span class="linenos">239</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">new_transform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="Pose-240"><a href="#Pose-240"><span class="linenos">240</span></a>    
</span><span id="Pose-241"><a href="#Pose-241"><span class="linenos">241</span></a>    <span class="k">def</span> <span class="nf">with_rotation_matching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-242"><a href="#Pose-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same position but a different orientation, matching another pose.</span>
</span><span id="Pose-243"><a href="#Pose-243"><span class="linenos">243</span></a>
</span><span id="Pose-244"><a href="#Pose-244"><span class="linenos">244</span></a><span class="sd">        This method is frame aware, so even if the other pose has a different frame, the rotation will be matched correctly.</span>
</span><span id="Pose-245"><a href="#Pose-245"><span class="linenos">245</span></a><span class="sd">        </span>
</span><span id="Pose-246"><a href="#Pose-246"><span class="linenos">246</span></a><span class="sd">        Args:</span>
</span><span id="Pose-247"><a href="#Pose-247"><span class="linenos">247</span></a><span class="sd">            other: The pose to match the rotation of.</span>
</span><span id="Pose-248"><a href="#Pose-248"><span class="linenos">248</span></a><span class="sd">        </span>
</span><span id="Pose-249"><a href="#Pose-249"><span class="linenos">249</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-250"><a href="#Pose-250"><span class="linenos">250</span></a><span class="sd">            A new pose with the same position but a different orientation.</span>
</span><span id="Pose-251"><a href="#Pose-251"><span class="linenos">251</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-252"><a href="#Pose-252"><span class="linenos">252</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_rotation</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span>
</span><span id="Pose-253"><a href="#Pose-253"><span class="linenos">253</span></a>    
</span><span id="Pose-254"><a href="#Pose-254"><span class="linenos">254</span></a>    <span class="k">def</span> <span class="nf">with_position_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-255"><a href="#Pose-255"><span class="linenos">255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same y and z coordinates but a different x coordinate.</span>
</span><span id="Pose-256"><a href="#Pose-256"><span class="linenos">256</span></a><span class="sd">        </span>
</span><span id="Pose-257"><a href="#Pose-257"><span class="linenos">257</span></a><span class="sd">        Args:</span>
</span><span id="Pose-258"><a href="#Pose-258"><span class="linenos">258</span></a><span class="sd">            x: The new x coordinate of the pose.</span>
</span><span id="Pose-259"><a href="#Pose-259"><span class="linenos">259</span></a><span class="sd">            frame: The frame that the x coordinate is relative to. If None, the x coordinate is relative to the pose&#39;s frame.</span>
</span><span id="Pose-260"><a href="#Pose-260"><span class="linenos">260</span></a><span class="sd">        </span>
</span><span id="Pose-261"><a href="#Pose-261"><span class="linenos">261</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-262"><a href="#Pose-262"><span class="linenos">262</span></a><span class="sd">            A new pose with the same y and z coordinates but a different x coordinate.</span>
</span><span id="Pose-263"><a href="#Pose-263"><span class="linenos">263</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-264"><a href="#Pose-264"><span class="linenos">264</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose-265"><a href="#Pose-265"><span class="linenos">265</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
</span><span id="Pose-266"><a href="#Pose-266"><span class="linenos">266</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Pose-267"><a href="#Pose-267"><span class="linenos">267</span></a>            <span class="n">in_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose-268"><a href="#Pose-268"><span class="linenos">268</span></a>            <span class="k">return</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose-269"><a href="#Pose-269"><span class="linenos">269</span></a>        
</span><span id="Pose-270"><a href="#Pose-270"><span class="linenos">270</span></a>    <span class="k">def</span> <span class="nf">with_position_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-271"><a href="#Pose-271"><span class="linenos">271</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same x and z coordinates but a different y coordinate.</span>
</span><span id="Pose-272"><a href="#Pose-272"><span class="linenos">272</span></a><span class="sd">        </span>
</span><span id="Pose-273"><a href="#Pose-273"><span class="linenos">273</span></a><span class="sd">        Args:</span>
</span><span id="Pose-274"><a href="#Pose-274"><span class="linenos">274</span></a><span class="sd">            y: The new y coordinate of the pose.</span>
</span><span id="Pose-275"><a href="#Pose-275"><span class="linenos">275</span></a><span class="sd">            frame: The frame that the y coordinate is relative to. If None, the y coordinate is relative to the pose&#39;s frame.</span>
</span><span id="Pose-276"><a href="#Pose-276"><span class="linenos">276</span></a><span class="sd">        </span>
</span><span id="Pose-277"><a href="#Pose-277"><span class="linenos">277</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-278"><a href="#Pose-278"><span class="linenos">278</span></a><span class="sd">            A new pose with the same x and z coordinates but a different y coordinate.</span>
</span><span id="Pose-279"><a href="#Pose-279"><span class="linenos">279</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-280"><a href="#Pose-280"><span class="linenos">280</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose-281"><a href="#Pose-281"><span class="linenos">281</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
</span><span id="Pose-282"><a href="#Pose-282"><span class="linenos">282</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Pose-283"><a href="#Pose-283"><span class="linenos">283</span></a>            <span class="n">in_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose-284"><a href="#Pose-284"><span class="linenos">284</span></a>            <span class="k">return</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="n">in_frame</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose-285"><a href="#Pose-285"><span class="linenos">285</span></a>        
</span><span id="Pose-286"><a href="#Pose-286"><span class="linenos">286</span></a>    <span class="k">def</span> <span class="nf">with_position_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-287"><a href="#Pose-287"><span class="linenos">287</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same x and y coordinates but a different z coordinate.</span>
</span><span id="Pose-288"><a href="#Pose-288"><span class="linenos">288</span></a><span class="sd">        </span>
</span><span id="Pose-289"><a href="#Pose-289"><span class="linenos">289</span></a><span class="sd">        Args:</span>
</span><span id="Pose-290"><a href="#Pose-290"><span class="linenos">290</span></a><span class="sd">            z: The new z coordinate of the pose.</span>
</span><span id="Pose-291"><a href="#Pose-291"><span class="linenos">291</span></a><span class="sd">            frame: The frame that the z coordinate is relative to. If None, the z coordinate is relative to the pose&#39;s frame.</span>
</span><span id="Pose-292"><a href="#Pose-292"><span class="linenos">292</span></a><span class="sd">        </span>
</span><span id="Pose-293"><a href="#Pose-293"><span class="linenos">293</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-294"><a href="#Pose-294"><span class="linenos">294</span></a><span class="sd">            A new pose with the same x and y coordinates but a different z coordinate.</span>
</span><span id="Pose-295"><a href="#Pose-295"><span class="linenos">295</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-296"><a href="#Pose-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose-297"><a href="#Pose-297"><span class="linenos">297</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
</span><span id="Pose-298"><a href="#Pose-298"><span class="linenos">298</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Pose-299"><a href="#Pose-299"><span class="linenos">299</span></a>            <span class="n">in_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose-300"><a href="#Pose-300"><span class="linenos">300</span></a>            <span class="k">return</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="n">in_frame</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose-301"><a href="#Pose-301"><span class="linenos">301</span></a>    
</span><span id="Pose-302"><a href="#Pose-302"><span class="linenos">302</span></a>    <span class="k">def</span> <span class="nf">apply_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-303"><a href="#Pose-303"><span class="linenos">303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose transformed by a transform.</span>
</span><span id="Pose-304"><a href="#Pose-304"><span class="linenos">304</span></a>
</span><span id="Pose-305"><a href="#Pose-305"><span class="linenos">305</span></a><span class="sd">        This method is provided to give compatibility with systems that talk about poses in terms of transforms,</span>
</span><span id="Pose-306"><a href="#Pose-306"><span class="linenos">306</span></a><span class="sd">        but it is usually more readable and debuggable to use a rotate/translate method instead.</span>
</span><span id="Pose-307"><a href="#Pose-307"><span class="linenos">307</span></a><span class="sd">        </span>
</span><span id="Pose-308"><a href="#Pose-308"><span class="linenos">308</span></a><span class="sd">        Args:</span>
</span><span id="Pose-309"><a href="#Pose-309"><span class="linenos">309</span></a><span class="sd">            transform: The transform to apply.</span>
</span><span id="Pose-310"><a href="#Pose-310"><span class="linenos">310</span></a><span class="sd">        </span>
</span><span id="Pose-311"><a href="#Pose-311"><span class="linenos">311</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-312"><a href="#Pose-312"><span class="linenos">312</span></a><span class="sd">            A new pose transformed by a transform.</span>
</span><span id="Pose-313"><a href="#Pose-313"><span class="linenos">313</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-314"><a href="#Pose-314"><span class="linenos">314</span></a>        <span class="n">new_transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">*</span> <span class="n">transform</span>
</span><span id="Pose-315"><a href="#Pose-315"><span class="linenos">315</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">new_transform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="Pose-316"><a href="#Pose-316"><span class="linenos">316</span></a>    
</span><span id="Pose-317"><a href="#Pose-317"><span class="linenos">317</span></a>    
</span><span id="Pose-318"><a href="#Pose-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">translation</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-319"><a href="#Pose-319"><span class="linenos">319</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose translated by a vector.</span>
</span><span id="Pose-320"><a href="#Pose-320"><span class="linenos">320</span></a>
</span><span id="Pose-321"><a href="#Pose-321"><span class="linenos">321</span></a><span class="sd">        The translation is relative to the basis of the pose being translated (i.e body-fixed) rather than the parent frame.</span>
</span><span id="Pose-322"><a href="#Pose-322"><span class="linenos">322</span></a><span class="sd">        That means that</span>
</span><span id="Pose-323"><a href="#Pose-323"><span class="linenos">323</span></a><span class="sd">        ```python</span>
</span><span id="Pose-324"><a href="#Pose-324"><span class="linenos">324</span></a><span class="sd">        p2 = p1.translate((1, 0, 0))</span>
</span><span id="Pose-325"><a href="#Pose-325"><span class="linenos">325</span></a><span class="sd">        ```</span>
</span><span id="Pose-326"><a href="#Pose-326"><span class="linenos">326</span></a><span class="sd">        and</span>
</span><span id="Pose-327"><a href="#Pose-327"><span class="linenos">327</span></a><span class="sd">        ```python</span>
</span><span id="Pose-328"><a href="#Pose-328"><span class="linenos">328</span></a><span class="sd">        p2 = p1.in_frame(&quot;some_other_frame&quot;).translate((1, 0, 0)).in_frame(p1.frame)</span>
</span><span id="Pose-329"><a href="#Pose-329"><span class="linenos">329</span></a><span class="sd">        ```</span>
</span><span id="Pose-330"><a href="#Pose-330"><span class="linenos">330</span></a><span class="sd">        are identical, because the parent frame of a pose does not affect its translation.</span>
</span><span id="Pose-331"><a href="#Pose-331"><span class="linenos">331</span></a>
</span><span id="Pose-332"><a href="#Pose-332"><span class="linenos">332</span></a><span class="sd">        Args:</span>
</span><span id="Pose-333"><a href="#Pose-333"><span class="linenos">333</span></a><span class="sd">            translation: The vector to translate by.</span>
</span><span id="Pose-334"><a href="#Pose-334"><span class="linenos">334</span></a><span class="sd">            frame: The frame that the vector is relative to.</span>
</span><span id="Pose-335"><a href="#Pose-335"><span class="linenos">335</span></a><span class="sd">        </span>
</span><span id="Pose-336"><a href="#Pose-336"><span class="linenos">336</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-337"><a href="#Pose-337"><span class="linenos">337</span></a><span class="sd">            A new pose translated by a vector.</span>
</span><span id="Pose-338"><a href="#Pose-338"><span class="linenos">338</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-339"><a href="#Pose-339"><span class="linenos">339</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose-340"><a href="#Pose-340"><span class="linenos">340</span></a>            <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">translation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="Pose-341"><a href="#Pose-341"><span class="linenos">341</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Pose-342"><a href="#Pose-342"><span class="linenos">342</span></a>            <span class="n">self_frame_t_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>
</span><span id="Pose-343"><a href="#Pose-343"><span class="linenos">343</span></a>            <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="n">self_frame_t_frame</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">translation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="Pose-344"><a href="#Pose-344"><span class="linenos">344</span></a>    
</span><span id="Pose-345"><a href="#Pose-345"><span class="linenos">345</span></a>    <span class="k">def</span> <span class="nf">rotate_about_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-346"><a href="#Pose-346"><span class="linenos">346</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated about an axis.</span>
</span><span id="Pose-347"><a href="#Pose-347"><span class="linenos">347</span></a>
</span><span id="Pose-348"><a href="#Pose-348"><span class="linenos">348</span></a><span class="sd">        This is rotated in the basis of the pose being rotated (i.e body-fixed) rather than the parent frame, and it only</span>
</span><span id="Pose-349"><a href="#Pose-349"><span class="linenos">349</span></a><span class="sd">        rotates the orientation. This is *not* a rotation about the origin, but a change of the orientation of the pose.</span>
</span><span id="Pose-350"><a href="#Pose-350"><span class="linenos">350</span></a>
</span><span id="Pose-351"><a href="#Pose-351"><span class="linenos">351</span></a><span class="sd">        If you pass a frame, the axis will be interpreted as being expressed in that frame.</span>
</span><span id="Pose-352"><a href="#Pose-352"><span class="linenos">352</span></a><span class="sd">        </span>
</span><span id="Pose-353"><a href="#Pose-353"><span class="linenos">353</span></a><span class="sd">        Args:</span>
</span><span id="Pose-354"><a href="#Pose-354"><span class="linenos">354</span></a><span class="sd">            axis: The axis to rotate about.</span>
</span><span id="Pose-355"><a href="#Pose-355"><span class="linenos">355</span></a><span class="sd">            angle: The angle to rotate by, in radians.</span>
</span><span id="Pose-356"><a href="#Pose-356"><span class="linenos">356</span></a><span class="sd">            frame: The frame that the axis is relative to. If None, the axis is interpreted in the basis vectors of the pose (not the parent frame).</span>
</span><span id="Pose-357"><a href="#Pose-357"><span class="linenos">357</span></a><span class="sd">        </span>
</span><span id="Pose-358"><a href="#Pose-358"><span class="linenos">358</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-359"><a href="#Pose-359"><span class="linenos">359</span></a><span class="sd">            A new pose with the same location but rotated about an axis.</span>
</span><span id="Pose-360"><a href="#Pose-360"><span class="linenos">360</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-361"><a href="#Pose-361"><span class="linenos">361</span></a>        <span class="n">axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
</span><span id="Pose-362"><a href="#Pose-362"><span class="linenos">362</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-6</span><span class="p">:</span>
</span><span id="Pose-363"><a href="#Pose-363"><span class="linenos">363</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Axis must be a unit vector.&quot;</span><span class="p">)</span>
</span><span id="Pose-364"><a href="#Pose-364"><span class="linenos">364</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose-365"><a href="#Pose-365"><span class="linenos">365</span></a>            <span class="n">new_rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_rotvec</span><span class="p">(</span><span class="n">axis</span> <span class="o">*</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="Pose-366"><a href="#Pose-366"><span class="linenos">366</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Pose-367"><a href="#Pose-367"><span class="linenos">367</span></a>            <span class="n">frame_t_self_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose-368"><a href="#Pose-368"><span class="linenos">368</span></a>            <span class="n">new_rotation</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_rotvec</span><span class="p">(</span><span class="n">frame_t_self_frame</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span> <span class="o">*</span> <span class="n">angle</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span>
</span><span id="Pose-369"><a href="#Pose-369"><span class="linenos">369</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">new_rotation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="Pose-370"><a href="#Pose-370"><span class="linenos">370</span></a>    
</span><span id="Pose-371"><a href="#Pose-371"><span class="linenos">371</span></a>    <span class="k">def</span> <span class="nf">rotate_about_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-372"><a href="#Pose-372"><span class="linenos">372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated about the x axis.</span>
</span><span id="Pose-373"><a href="#Pose-373"><span class="linenos">373</span></a><span class="sd">        </span>
</span><span id="Pose-374"><a href="#Pose-374"><span class="linenos">374</span></a><span class="sd">        Args:</span>
</span><span id="Pose-375"><a href="#Pose-375"><span class="linenos">375</span></a><span class="sd">            angle: The angle to rotate by, in radians.</span>
</span><span id="Pose-376"><a href="#Pose-376"><span class="linenos">376</span></a><span class="sd">            frame: The frame that the axis is relative to. If not provided, it will rotate about the x-unit-vector of the pose being rotated.</span>
</span><span id="Pose-377"><a href="#Pose-377"><span class="linenos">377</span></a><span class="sd">        </span>
</span><span id="Pose-378"><a href="#Pose-378"><span class="linenos">378</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-379"><a href="#Pose-379"><span class="linenos">379</span></a><span class="sd">            A new pose with the same location but rotated about the x axis.</span>
</span><span id="Pose-380"><a href="#Pose-380"><span class="linenos">380</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-381"><a href="#Pose-381"><span class="linenos">381</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_about_axis</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose-382"><a href="#Pose-382"><span class="linenos">382</span></a>    
</span><span id="Pose-383"><a href="#Pose-383"><span class="linenos">383</span></a>    <span class="k">def</span> <span class="nf">rotate_about_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-384"><a href="#Pose-384"><span class="linenos">384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated about the y axis.</span>
</span><span id="Pose-385"><a href="#Pose-385"><span class="linenos">385</span></a><span class="sd">        </span>
</span><span id="Pose-386"><a href="#Pose-386"><span class="linenos">386</span></a><span class="sd">        Args:</span>
</span><span id="Pose-387"><a href="#Pose-387"><span class="linenos">387</span></a><span class="sd">            angle: The angle to rotate by, in radians.</span>
</span><span id="Pose-388"><a href="#Pose-388"><span class="linenos">388</span></a><span class="sd">            frame: The frame that the axis is relative to. If not provided, it will rotate about the y-unit-vector of the pose being rotated.</span>
</span><span id="Pose-389"><a href="#Pose-389"><span class="linenos">389</span></a><span class="sd">        </span>
</span><span id="Pose-390"><a href="#Pose-390"><span class="linenos">390</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-391"><a href="#Pose-391"><span class="linenos">391</span></a><span class="sd">            A new pose with the same location but rotated about the y axis.</span>
</span><span id="Pose-392"><a href="#Pose-392"><span class="linenos">392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-393"><a href="#Pose-393"><span class="linenos">393</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_about_axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose-394"><a href="#Pose-394"><span class="linenos">394</span></a>    
</span><span id="Pose-395"><a href="#Pose-395"><span class="linenos">395</span></a>    <span class="k">def</span> <span class="nf">rotate_about_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-396"><a href="#Pose-396"><span class="linenos">396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated about the z axis.</span>
</span><span id="Pose-397"><a href="#Pose-397"><span class="linenos">397</span></a><span class="sd">        </span>
</span><span id="Pose-398"><a href="#Pose-398"><span class="linenos">398</span></a><span class="sd">        Args:</span>
</span><span id="Pose-399"><a href="#Pose-399"><span class="linenos">399</span></a><span class="sd">            angle: The angle to rotate by, in radians.</span>
</span><span id="Pose-400"><a href="#Pose-400"><span class="linenos">400</span></a><span class="sd">            frame: The frame that the axis is relative to. If not provided, it will rotate about the z-unit-vector of the pose being rotated.</span>
</span><span id="Pose-401"><a href="#Pose-401"><span class="linenos">401</span></a><span class="sd">        </span>
</span><span id="Pose-402"><a href="#Pose-402"><span class="linenos">402</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-403"><a href="#Pose-403"><span class="linenos">403</span></a><span class="sd">            A new pose with the same location but rotated about the z axis.</span>
</span><span id="Pose-404"><a href="#Pose-404"><span class="linenos">404</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-405"><a href="#Pose-405"><span class="linenos">405</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_about_axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">angle</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose-406"><a href="#Pose-406"><span class="linenos">406</span></a>    
</span><span id="Pose-407"><a href="#Pose-407"><span class="linenos">407</span></a>    <span class="k">def</span> <span class="nf">point_x_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-408"><a href="#Pose-408"><span class="linenos">408</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated to point the x axis at a target pose.</span>
</span><span id="Pose-409"><a href="#Pose-409"><span class="linenos">409</span></a><span class="sd">        </span>
</span><span id="Pose-410"><a href="#Pose-410"><span class="linenos">410</span></a><span class="sd">        Args:</span>
</span><span id="Pose-411"><a href="#Pose-411"><span class="linenos">411</span></a><span class="sd">            target: The target pose to point at.</span>
</span><span id="Pose-412"><a href="#Pose-412"><span class="linenos">412</span></a><span class="sd">            fixed_axis: An optional axis (&#39;x&#39;, &#39;y&#39; or &#39;z&#39;) to keep fixed. If not provided,</span>
</span><span id="Pose-413"><a href="#Pose-413"><span class="linenos">413</span></a><span class="sd">                the pose will be rotated the minimum rotation to have the axis point at the target pose.</span>
</span><span id="Pose-414"><a href="#Pose-414"><span class="linenos">414</span></a><span class="sd">        </span>
</span><span id="Pose-415"><a href="#Pose-415"><span class="linenos">415</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-416"><a href="#Pose-416"><span class="linenos">416</span></a><span class="sd">            A new pose with the same location but rotated to point the x axis at a target pose.</span>
</span><span id="Pose-417"><a href="#Pose-417"><span class="linenos">417</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-418"><a href="#Pose-418"><span class="linenos">418</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_point_at</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">fixed_axis</span><span class="p">)</span>
</span><span id="Pose-419"><a href="#Pose-419"><span class="linenos">419</span></a>    
</span><span id="Pose-420"><a href="#Pose-420"><span class="linenos">420</span></a>    <span class="k">def</span> <span class="nf">point_y_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-421"><a href="#Pose-421"><span class="linenos">421</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated to point the y axis at a target pose.</span>
</span><span id="Pose-422"><a href="#Pose-422"><span class="linenos">422</span></a><span class="sd">        </span>
</span><span id="Pose-423"><a href="#Pose-423"><span class="linenos">423</span></a><span class="sd">        Args:</span>
</span><span id="Pose-424"><a href="#Pose-424"><span class="linenos">424</span></a><span class="sd">            target: The target pose to point at.</span>
</span><span id="Pose-425"><a href="#Pose-425"><span class="linenos">425</span></a><span class="sd">            fixed_axis: An optional axis (&#39;x&#39;, &#39;y&#39; or &#39;z&#39;) to keep fixed. If not provided,</span>
</span><span id="Pose-426"><a href="#Pose-426"><span class="linenos">426</span></a><span class="sd">                the pose will be rotated the minimum rotation to have the axis point at the target pose.</span>
</span><span id="Pose-427"><a href="#Pose-427"><span class="linenos">427</span></a><span class="sd">        </span>
</span><span id="Pose-428"><a href="#Pose-428"><span class="linenos">428</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-429"><a href="#Pose-429"><span class="linenos">429</span></a><span class="sd">            A new pose with the same location but rotated to point the y axis at a target pose.</span>
</span><span id="Pose-430"><a href="#Pose-430"><span class="linenos">430</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-431"><a href="#Pose-431"><span class="linenos">431</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_point_at</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">fixed_axis</span><span class="p">)</span>
</span><span id="Pose-432"><a href="#Pose-432"><span class="linenos">432</span></a>    
</span><span id="Pose-433"><a href="#Pose-433"><span class="linenos">433</span></a>    <span class="k">def</span> <span class="nf">point_z_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-434"><a href="#Pose-434"><span class="linenos">434</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated to point the z axis at a target pose.</span>
</span><span id="Pose-435"><a href="#Pose-435"><span class="linenos">435</span></a><span class="sd">        </span>
</span><span id="Pose-436"><a href="#Pose-436"><span class="linenos">436</span></a><span class="sd">        Args:</span>
</span><span id="Pose-437"><a href="#Pose-437"><span class="linenos">437</span></a><span class="sd">            target: The target pose to point at.</span>
</span><span id="Pose-438"><a href="#Pose-438"><span class="linenos">438</span></a><span class="sd">        </span>
</span><span id="Pose-439"><a href="#Pose-439"><span class="linenos">439</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-440"><a href="#Pose-440"><span class="linenos">440</span></a><span class="sd">            A new pose with the same location but rotated to point the z axis at a target pose.</span>
</span><span id="Pose-441"><a href="#Pose-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-442"><a href="#Pose-442"><span class="linenos">442</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_point_at</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">fixed_axis</span><span class="p">)</span>
</span><span id="Pose-443"><a href="#Pose-443"><span class="linenos">443</span></a>    
</span><span id="Pose-444"><a href="#Pose-444"><span class="linenos">444</span></a>    <span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-445"><a href="#Pose-445"><span class="linenos">445</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose interpolated between two poses, in the frame of the first pose.</span>
</span><span id="Pose-446"><a href="#Pose-446"><span class="linenos">446</span></a><span class="sd">        </span>
</span><span id="Pose-447"><a href="#Pose-447"><span class="linenos">447</span></a><span class="sd">        Args:</span>
</span><span id="Pose-448"><a href="#Pose-448"><span class="linenos">448</span></a><span class="sd">            target: The target pose to interpolate to.</span>
</span><span id="Pose-449"><a href="#Pose-449"><span class="linenos">449</span></a><span class="sd">            alpha: The interpolation factor. 0.0 will return the current pose, 1.0 will return</span>
</span><span id="Pose-450"><a href="#Pose-450"><span class="linenos">450</span></a><span class="sd">                the target pose and values in between will return a pose interpolated between the two.</span>
</span><span id="Pose-451"><a href="#Pose-451"><span class="linenos">451</span></a><span class="sd">        </span>
</span><span id="Pose-452"><a href="#Pose-452"><span class="linenos">452</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-453"><a href="#Pose-453"><span class="linenos">453</span></a><span class="sd">            A new pose interpolated between two poses.</span>
</span><span id="Pose-454"><a href="#Pose-454"><span class="linenos">454</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-455"><a href="#Pose-455"><span class="linenos">455</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">alpha</span><span class="p">))</span>
</span><span id="Pose-456"><a href="#Pose-456"><span class="linenos">456</span></a>    
</span><span id="Pose-457"><a href="#Pose-457"><span class="linenos">457</span></a>    <span class="k">def</span> <span class="nf">distance_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose-458"><a href="#Pose-458"><span class="linenos">458</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the cartesian distance between two poses.</span>
</span><span id="Pose-459"><a href="#Pose-459"><span class="linenos">459</span></a><span class="sd">        </span>
</span><span id="Pose-460"><a href="#Pose-460"><span class="linenos">460</span></a><span class="sd">        Args:</span>
</span><span id="Pose-461"><a href="#Pose-461"><span class="linenos">461</span></a><span class="sd">            other: The other pose.</span>
</span><span id="Pose-462"><a href="#Pose-462"><span class="linenos">462</span></a><span class="sd">        </span>
</span><span id="Pose-463"><a href="#Pose-463"><span class="linenos">463</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-464"><a href="#Pose-464"><span class="linenos">464</span></a><span class="sd">            The distance between two poses.</span>
</span><span id="Pose-465"><a href="#Pose-465"><span class="linenos">465</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-466"><a href="#Pose-466"><span class="linenos">466</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
</span><span id="Pose-467"><a href="#Pose-467"><span class="linenos">467</span></a>    
</span><span id="Pose-468"><a href="#Pose-468"><span class="linenos">468</span></a>    <span class="k">def</span> <span class="nf">angle_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose-469"><a href="#Pose-469"><span class="linenos">469</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the angle between two poses&#39; orientations. Ignores position. Will convert to the same frame.</span>
</span><span id="Pose-470"><a href="#Pose-470"><span class="linenos">470</span></a><span class="sd">        </span>
</span><span id="Pose-471"><a href="#Pose-471"><span class="linenos">471</span></a><span class="sd">        This gives the magnitude of the minimal rotation that will align the two poses.</span>
</span><span id="Pose-472"><a href="#Pose-472"><span class="linenos">472</span></a>
</span><span id="Pose-473"><a href="#Pose-473"><span class="linenos">473</span></a><span class="sd">        Args:</span>
</span><span id="Pose-474"><a href="#Pose-474"><span class="linenos">474</span></a><span class="sd">            target: The target pose.</span>
</span><span id="Pose-475"><a href="#Pose-475"><span class="linenos">475</span></a><span class="sd">        </span>
</span><span id="Pose-476"><a href="#Pose-476"><span class="linenos">476</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-477"><a href="#Pose-477"><span class="linenos">477</span></a><span class="sd">            The angle between two poses, in radians.</span>
</span><span id="Pose-478"><a href="#Pose-478"><span class="linenos">478</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-479"><a href="#Pose-479"><span class="linenos">479</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">angle_to</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span>
</span><span id="Pose-480"><a href="#Pose-480"><span class="linenos">480</span></a>    
</span><span id="Pose-481"><a href="#Pose-481"><span class="linenos">481</span></a>    <span class="k">def</span> <span class="nf">_angle_about_axis_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose-482"><a href="#Pose-482"><span class="linenos">482</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the signed angle between two poses&#39; orientations about an axis. Ignores position. Will convert to the same frame.</span>
</span><span id="Pose-483"><a href="#Pose-483"><span class="linenos">483</span></a><span class="sd">        </span>
</span><span id="Pose-484"><a href="#Pose-484"><span class="linenos">484</span></a><span class="sd">        Args:</span>
</span><span id="Pose-485"><a href="#Pose-485"><span class="linenos">485</span></a><span class="sd">            target: The target pose.</span>
</span><span id="Pose-486"><a href="#Pose-486"><span class="linenos">486</span></a><span class="sd">            axis: The axis to rotate about.</span>
</span><span id="Pose-487"><a href="#Pose-487"><span class="linenos">487</span></a><span class="sd">        </span>
</span><span id="Pose-488"><a href="#Pose-488"><span class="linenos">488</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-489"><a href="#Pose-489"><span class="linenos">489</span></a><span class="sd">            The angle between two poses.</span>
</span><span id="Pose-490"><a href="#Pose-490"><span class="linenos">490</span></a>
</span><span id="Pose-491"><a href="#Pose-491"><span class="linenos">491</span></a><span class="sd">        Raises:</span>
</span><span id="Pose-492"><a href="#Pose-492"><span class="linenos">492</span></a><span class="sd">            ValueError: If the rotation is more than 20% out of the expected axis.</span>
</span><span id="Pose-493"><a href="#Pose-493"><span class="linenos">493</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-494"><a href="#Pose-494"><span class="linenos">494</span></a>        <span class="n">relative_rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span> <span class="o">*</span> <span class="n">target</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotation</span>
</span><span id="Pose-495"><a href="#Pose-495"><span class="linenos">495</span></a>        <span class="n">relative_rotvec</span> <span class="o">=</span> <span class="n">relative_rotation</span><span class="o">.</span><span class="n">as_rotvec</span><span class="p">()</span>
</span><span id="Pose-496"><a href="#Pose-496"><span class="linenos">496</span></a>        <span class="n">in_axis_rotation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">relative_rotvec</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
</span><span id="Pose-497"><a href="#Pose-497"><span class="linenos">497</span></a>        <span class="n">out_of_axis_rotation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">relative_rotvec</span> <span class="o">-</span> <span class="n">in_axis_rotation</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">axis</span><span class="p">))</span>
</span><span id="Pose-498"><a href="#Pose-498"><span class="linenos">498</span></a>        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">in_axis_rotation</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">out_of_axis_rotation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">out_of_axis_rotation</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">in_axis_rotation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.2</span><span class="p">:</span>
</span><span id="Pose-499"><a href="#Pose-499"><span class="linenos">499</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Rotation between poses is more than 20</span><span class="si">% o</span><span class="s2">ut of expected axis.&quot;</span><span class="p">)</span>
</span><span id="Pose-500"><a href="#Pose-500"><span class="linenos">500</span></a>        <span class="k">return</span> <span class="n">in_axis_rotation</span>
</span><span id="Pose-501"><a href="#Pose-501"><span class="linenos">501</span></a>    
</span><span id="Pose-502"><a href="#Pose-502"><span class="linenos">502</span></a>    <span class="k">def</span> <span class="nf">angle_about_x_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose-503"><a href="#Pose-503"><span class="linenos">503</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the signed angle between two poses&#39; orientations about the x axis. Ignores position. Will convert to the same frame.</span>
</span><span id="Pose-504"><a href="#Pose-504"><span class="linenos">504</span></a><span class="sd">        </span>
</span><span id="Pose-505"><a href="#Pose-505"><span class="linenos">505</span></a><span class="sd">        Args:</span>
</span><span id="Pose-506"><a href="#Pose-506"><span class="linenos">506</span></a><span class="sd">            target: The target pose.</span>
</span><span id="Pose-507"><a href="#Pose-507"><span class="linenos">507</span></a><span class="sd">        </span>
</span><span id="Pose-508"><a href="#Pose-508"><span class="linenos">508</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-509"><a href="#Pose-509"><span class="linenos">509</span></a><span class="sd">            The angle between two poses, in radians.</span>
</span><span id="Pose-510"><a href="#Pose-510"><span class="linenos">510</span></a>
</span><span id="Pose-511"><a href="#Pose-511"><span class="linenos">511</span></a><span class="sd">        Raises:</span>
</span><span id="Pose-512"><a href="#Pose-512"><span class="linenos">512</span></a><span class="sd">            ValueError: If the rotation is more than 20% out of the expected axis.</span>
</span><span id="Pose-513"><a href="#Pose-513"><span class="linenos">513</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-514"><a href="#Pose-514"><span class="linenos">514</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angle_about_axis_to</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> 
</span><span id="Pose-515"><a href="#Pose-515"><span class="linenos">515</span></a>    
</span><span id="Pose-516"><a href="#Pose-516"><span class="linenos">516</span></a>    
</span><span id="Pose-517"><a href="#Pose-517"><span class="linenos">517</span></a>    <span class="k">def</span> <span class="nf">angle_about_y_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose-518"><a href="#Pose-518"><span class="linenos">518</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the signed angle between two poses&#39; orientations about the y axis. Ignores position. Will convert to the same frame.</span>
</span><span id="Pose-519"><a href="#Pose-519"><span class="linenos">519</span></a><span class="sd">        </span>
</span><span id="Pose-520"><a href="#Pose-520"><span class="linenos">520</span></a><span class="sd">        Args:</span>
</span><span id="Pose-521"><a href="#Pose-521"><span class="linenos">521</span></a><span class="sd">            target: The target pose.</span>
</span><span id="Pose-522"><a href="#Pose-522"><span class="linenos">522</span></a><span class="sd">        </span>
</span><span id="Pose-523"><a href="#Pose-523"><span class="linenos">523</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-524"><a href="#Pose-524"><span class="linenos">524</span></a><span class="sd">            The angle between two poses, in radians.</span>
</span><span id="Pose-525"><a href="#Pose-525"><span class="linenos">525</span></a>
</span><span id="Pose-526"><a href="#Pose-526"><span class="linenos">526</span></a><span class="sd">        Raises:</span>
</span><span id="Pose-527"><a href="#Pose-527"><span class="linenos">527</span></a><span class="sd">            ValueError: If the rotation is more than 20% out of the expected axis.</span>
</span><span id="Pose-528"><a href="#Pose-528"><span class="linenos">528</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-529"><a href="#Pose-529"><span class="linenos">529</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angle_about_axis_to</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Pose-530"><a href="#Pose-530"><span class="linenos">530</span></a>    
</span><span id="Pose-531"><a href="#Pose-531"><span class="linenos">531</span></a>
</span><span id="Pose-532"><a href="#Pose-532"><span class="linenos">532</span></a>    <span class="k">def</span> <span class="nf">angle_about_z_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose-533"><a href="#Pose-533"><span class="linenos">533</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the signed angle between two poses&#39; orientations about the z axis. Ignores position. Will convert to the same frame.</span>
</span><span id="Pose-534"><a href="#Pose-534"><span class="linenos">534</span></a><span class="sd">        </span>
</span><span id="Pose-535"><a href="#Pose-535"><span class="linenos">535</span></a><span class="sd">        Args:</span>
</span><span id="Pose-536"><a href="#Pose-536"><span class="linenos">536</span></a><span class="sd">            target: The target pose.</span>
</span><span id="Pose-537"><a href="#Pose-537"><span class="linenos">537</span></a><span class="sd">        </span>
</span><span id="Pose-538"><a href="#Pose-538"><span class="linenos">538</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-539"><a href="#Pose-539"><span class="linenos">539</span></a><span class="sd">            The angle between two poses, in radians.</span>
</span><span id="Pose-540"><a href="#Pose-540"><span class="linenos">540</span></a>
</span><span id="Pose-541"><a href="#Pose-541"><span class="linenos">541</span></a><span class="sd">        Raises:</span>
</span><span id="Pose-542"><a href="#Pose-542"><span class="linenos">542</span></a><span class="sd">            ValueError: If the rotation is more than 20% out of the expected axis.</span>
</span><span id="Pose-543"><a href="#Pose-543"><span class="linenos">543</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-544"><a href="#Pose-544"><span class="linenos">544</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angle_about_axis_to</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Pose-545"><a href="#Pose-545"><span class="linenos">545</span></a>
</span><span id="Pose-546"><a href="#Pose-546"><span class="linenos">546</span></a>
</span><span id="Pose-547"><a href="#Pose-547"><span class="linenos">547</span></a>    <span class="k">def</span> <span class="nf">_point_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-548"><a href="#Pose-548"><span class="linenos">548</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated to point at a target pose.</span>
</span><span id="Pose-549"><a href="#Pose-549"><span class="linenos">549</span></a><span class="sd">        </span>
</span><span id="Pose-550"><a href="#Pose-550"><span class="linenos">550</span></a><span class="sd">        Args:</span>
</span><span id="Pose-551"><a href="#Pose-551"><span class="linenos">551</span></a><span class="sd">            target: The target pose to point at.</span>
</span><span id="Pose-552"><a href="#Pose-552"><span class="linenos">552</span></a><span class="sd">            axis: The axis to rotate about.</span>
</span><span id="Pose-553"><a href="#Pose-553"><span class="linenos">553</span></a><span class="sd">            fixed_axis: An optional axis (&#39;x&#39;, &#39;y&#39; or &#39;z&#39;) to keep fixed. If not provided,</span>
</span><span id="Pose-554"><a href="#Pose-554"><span class="linenos">554</span></a><span class="sd">                the pose will be rotated the minimum rotation to have the axis point at the target pose..</span>
</span><span id="Pose-555"><a href="#Pose-555"><span class="linenos">555</span></a><span class="sd">        </span>
</span><span id="Pose-556"><a href="#Pose-556"><span class="linenos">556</span></a><span class="sd">        Returns:</span>
</span><span id="Pose-557"><a href="#Pose-557"><span class="linenos">557</span></a><span class="sd">            A new pose with the same location but rotated to point at a target pose.</span>
</span><span id="Pose-558"><a href="#Pose-558"><span class="linenos">558</span></a><span class="sd">        </span>
</span><span id="Pose-559"><a href="#Pose-559"><span class="linenos">559</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-560"><a href="#Pose-560"><span class="linenos">560</span></a>        <span class="n">delta</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
</span><span id="Pose-561"><a href="#Pose-561"><span class="linenos">561</span></a>        <span class="n">delta_local</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
</span><span id="Pose-562"><a href="#Pose-562"><span class="linenos">562</span></a>        <span class="n">delta_rotation</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">align_vectors</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">delta_local</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">axis</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Pose-563"><a href="#Pose-563"><span class="linenos">563</span></a>        <span class="k">if</span> <span class="n">fixed_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose-564"><a href="#Pose-564"><span class="linenos">564</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_rotation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">delta_rotation</span><span class="p">)</span>
</span><span id="Pose-565"><a href="#Pose-565"><span class="linenos">565</span></a>        <span class="k">if</span> <span class="n">fixed_axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span><span id="Pose-566"><a href="#Pose-566"><span class="linenos">566</span></a>            <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span><span class="p">,</span> <span class="n">rx</span> <span class="o">=</span> <span class="n">delta_rotation</span><span class="o">.</span><span class="n">as_euler</span><span class="p">(</span><span class="s1">&#39;yzx&#39;</span><span class="p">)</span>
</span><span id="Pose-567"><a href="#Pose-567"><span class="linenos">567</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_rotation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_euler</span><span class="p">(</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">rx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="Pose-568"><a href="#Pose-568"><span class="linenos">568</span></a>        <span class="k">elif</span> <span class="n">fixed_axis</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
</span><span id="Pose-569"><a href="#Pose-569"><span class="linenos">569</span></a>            <span class="n">rx</span><span class="p">,</span> <span class="n">rz</span><span class="p">,</span> <span class="n">ry</span> <span class="o">=</span> <span class="n">delta_rotation</span><span class="o">.</span><span class="n">as_euler</span><span class="p">(</span><span class="s1">&#39;xzy&#39;</span><span class="p">)</span>
</span><span id="Pose-570"><a href="#Pose-570"><span class="linenos">570</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_rotation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_euler</span><span class="p">(</span><span class="s1">&#39;yxz&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">ry</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="Pose-571"><a href="#Pose-571"><span class="linenos">571</span></a>        <span class="k">elif</span> <span class="n">fixed_axis</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span>
</span><span id="Pose-572"><a href="#Pose-572"><span class="linenos">572</span></a>            <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span> <span class="o">=</span> <span class="n">delta_rotation</span><span class="o">.</span><span class="n">as_euler</span><span class="p">(</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
</span><span id="Pose-573"><a href="#Pose-573"><span class="linenos">573</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_rotation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_euler</span><span class="p">(</span><span class="s1">&#39;zxy&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">rz</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="Pose-574"><a href="#Pose-574"><span class="linenos">574</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Pose-575"><a href="#Pose-575"><span class="linenos">575</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;fixed_axis must be one of &#39;x&#39;, &#39;y&#39;, or &#39;z&#39;.&quot;</span><span class="p">)</span>
</span><span id="Pose-576"><a href="#Pose-576"><span class="linenos">576</span></a>    
</span><span id="Pose-577"><a href="#Pose-577"><span class="linenos">577</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Pose-578"><a href="#Pose-578"><span class="linenos">578</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Pose(transform=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="si">}</span><span class="s2">, frame=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Pose-579"><a href="#Pose-579"><span class="linenos">579</span></a>    <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span>
</span></pre></div>


            <div class="docstring"><p>A Pose is an immutable location and orientation in 3D space.
A pose is defined with a <code>parent_frame</code> (where to start) and a transform (how to get to the pose from the parent frame).</p>

<p>Note: While a Pose is immutable, the parent frame can (and does!) change over time relative to other frames, meaning that an individual pose can move relative
to other frames. (For example a pose defined in the "robot" frame will conceptually move as the robot moves relative to a 'world'
frame, even though its position and orientation remain immutably constant.)</p>

<p>To make this very concrete, say the robot starts out at the world origin:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">pose_in_robot_frame</span> <span class="o">=</span> <span class="n">pose</span><span class="o">.</span><span class="n">from_position_and_rotation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">identity</span><span class="p">(),</span> <span class="s2">&quot;robot&quot;</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">)</span>
<span class="n">pose_in_world_frame</span> <span class="o">=</span> <span class="n">pose_in_robot_frame</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="s2">&quot;world&quot;</span><span class="p">)</span>

<span class="n">pose_in_robot_frame</span><span class="o">.</span><span class="n">position</span> <span class="c1"># [1,2,3]</span>
<span class="n">pose_in_world_frame</span><span class="o">.</span><span class="n">position</span> <span class="c1"># [1,2,3]</span>

<span class="c1"># Now the robot moves 1 meter forward in the world frame.</span>
<span class="n">robot</span><span class="o">.</span><span class="n">drive_forward_in_x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Poses are immutable so this has not changed. One pose is [1,2,3] from the robot frame origin, one is [1,2,3] from the world origin.</span>
<span class="n">pose_in_robot_frame</span><span class="o">.</span><span class="n">position</span> <span class="c1"># [1,2,3]</span>
<span class="n">pose_in_world_frame</span><span class="o">.</span><span class="n">position</span> <span class="c1"># [2,2,3]</span>

<span class="c1"># But if we express the one in robot frame in the world frame, we see that it is now 1 meter forward in x.</span>
<span class="n">pose_in_robot_frame</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="s2">&quot;world&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">position</span> <span class="c1"># [2,2,3]</span>
</code></pre>
</div>

<p>Of course, the above example assumes that the <code><a href="#Pose.pose_tree">pose_tree</a></code> is correctly hooked up to the robot odometry system, so the poses know that the frames 
have moved.</p>

<p>When constucting poses it is useful to think of what you expect the pose to be fixed relative to. For example, you might
detect an apple on a table and get a pose from your perception system in the <code>camera</code> frame, but the apple is fixed relative to the table, so you will
want to store your pose object with a the parent frame equal to <code>odometry/map/world</code>. Then, even if the robot moves, apple_pose will still refer to the
best estimation of the apple's true location (with the usual caviats about localization drift and noise).</p>

<pre><code>apple_pose = Pose(camera_t_apple, "camera", pose_tree).in_frame("world")
</code></pre>

<p>Likewise if you have a bin on the back of a mobile robot and you want to define a drop-objects-into-bin pose right above it you can store
that in the <code>robot</code> frame.</p>

<pre><code>drop_pose = <a href="#Pose.from_position_and_quaternion">Pose.from_position_and_quaternion</a>([-.3, 0.1, 0.25], [0, 0, 0, 1]), "robot", pose_tree)
</code></pre>

<p>When designing motion APIs with this library, you should be liberal in what frames you accept, and internally convert them to the frame you want to work in. </p>

<p>For example, in a function to move the arm to a pose:</p>

<pre><code>def move_to_pose(self, target_pose: Pose):
    # Convert the target to be relative to the base of the robot so we can execute the motion.
    target_pose = target_pose.in_frame("robot")

    # Best Practice: turn Poses into Transforms at the last moment before acting on them.
    arm_motion_primitives.move_arm_to_pose_relative_to_base(target_pose.transform)
</code></pre>

<p>This formulation lets you combine the perception outputs and the motion methods for things like this:</p>

<pre><code>def grasp_apple(self, apple_pose: Pose):
    # pregrasp is a pose 15 cm above the apple, with z pointing at it.
    pregrasp = apple_pose.translate([0, 0, 0.15], frame="world").point_z_at(apple_pose)
    self.move_to_pose(pregrasp)

    # Move down in the local 'z' of pregrasp until we touch the apple.
    self.move_to_pose_until_contact(pregrasp.translate([0, 0, 0.2]))

    # If we feel a contact too early, raise some reasonable error:
    # We can check the distance using distance_to, even though the frames are different.
    if apple_pose.distance_to(get_tool_pose()) &gt; 0.1:
        return "Whoops, we probably didn't get the apple."

    # Close the gripper and move up a bit from where ever we are, to lift the apple.
    self.close_gripper()
    self.move_to_pose(get_tool_pose().translate([0, 0, -0.1]))

    # Drop it in the bin.
    self.move_to_pose(drop_pose)
    self.open_gripper()
</code></pre>
</div>


                            <div id="Pose.__init__" class="classattr">
                                        <input id="Pose.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Pose</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">transform</span><span class="p">:</span> <span class="n"><a href="#Transform">posetree.pose.Transform</a></span>,</span><span class="param">	<span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">pose_tree</span><span class="p">:</span> <span class="n"><a href="#PoseTree">posetree.pose.PoseTree</a></span></span>)</span>

                <label class="view-source-button" for="Pose.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.__init__-108"><a href="#Pose.__init__-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">:</span> <span class="s2">&quot;PoseTree&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose.__init__-109"><a href="#Pose.__init__-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a transform, frame, and pose tree.</span>
</span><span id="Pose.__init__-110"><a href="#Pose.__init__-110"><span class="linenos">110</span></a><span class="sd">        </span>
</span><span id="Pose.__init__-111"><a href="#Pose.__init__-111"><span class="linenos">111</span></a><span class="sd">        Args:</span>
</span><span id="Pose.__init__-112"><a href="#Pose.__init__-112"><span class="linenos">112</span></a><span class="sd">            transform: The transform from the frame to the pose.</span>
</span><span id="Pose.__init__-113"><a href="#Pose.__init__-113"><span class="linenos">113</span></a><span class="sd">            parent_frame: The frame that the transform is relative to.</span>
</span><span id="Pose.__init__-114"><a href="#Pose.__init__-114"><span class="linenos">114</span></a><span class="sd">            pose_tree: The world that the pose exists in.</span>
</span><span id="Pose.__init__-115"><a href="#Pose.__init__-115"><span class="linenos">115</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.__init__-116"><a href="#Pose.__init__-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span> <span class="o">=</span> <span class="n">transform</span>
</span><span id="Pose.__init__-117"><a href="#Pose.__init__-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span> <span class="o">=</span> <span class="n">parent_frame</span>
</span><span id="Pose.__init__-118"><a href="#Pose.__init__-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pose_tree</span> <span class="o">=</span> <span class="n">pose_tree</span>
</span></pre></div>


            <div class="docstring"><p>Create a pose from a transform, frame, and pose tree.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>transform:</strong>  The transform from the frame to the pose.</li>
<li><strong>parent_frame:</strong>  The frame that the transform is relative to.</li>
<li><strong>pose_tree:</strong>  The world that the pose exists in.</li>
</ul>
</div>


                            </div>
                            <div id="Pose.from_position_and_quaternion" class="classattr">
                                        <input id="Pose.from_position_and_quaternion-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_position_and_quaternion</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">quaternion</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">pose_tree</span><span class="p">:</span> <span class="n"><a href="#PoseTree">posetree.pose.PoseTree</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.from_position_and_quaternion-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.from_position_and_quaternion"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.from_position_and_quaternion-120"><a href="#Pose.from_position_and_quaternion-120"><span class="linenos">120</span></a>    <span class="nd">@classmethod</span>
</span><span id="Pose.from_position_and_quaternion-121"><a href="#Pose.from_position_and_quaternion-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="nf">from_position_and_quaternion</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">quaternion</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">:</span> <span class="s2">&quot;PoseTree&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.from_position_and_quaternion-122"><a href="#Pose.from_position_and_quaternion-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a position and quaternion.</span>
</span><span id="Pose.from_position_and_quaternion-123"><a href="#Pose.from_position_and_quaternion-123"><span class="linenos">123</span></a><span class="sd">        </span>
</span><span id="Pose.from_position_and_quaternion-124"><a href="#Pose.from_position_and_quaternion-124"><span class="linenos">124</span></a><span class="sd">        Args:</span>
</span><span id="Pose.from_position_and_quaternion-125"><a href="#Pose.from_position_and_quaternion-125"><span class="linenos">125</span></a><span class="sd">            position: The position of the transform.</span>
</span><span id="Pose.from_position_and_quaternion-126"><a href="#Pose.from_position_and_quaternion-126"><span class="linenos">126</span></a><span class="sd">            quaternion: The quaternion of the transform, in xyzw order.</span>
</span><span id="Pose.from_position_and_quaternion-127"><a href="#Pose.from_position_and_quaternion-127"><span class="linenos">127</span></a><span class="sd">            parent_frame: The frame that the transform is relative to.</span>
</span><span id="Pose.from_position_and_quaternion-128"><a href="#Pose.from_position_and_quaternion-128"><span class="linenos">128</span></a><span class="sd">            pose_tree: The world that the pose exists in.</span>
</span><span id="Pose.from_position_and_quaternion-129"><a href="#Pose.from_position_and_quaternion-129"><span class="linenos">129</span></a><span class="sd">        </span>
</span><span id="Pose.from_position_and_quaternion-130"><a href="#Pose.from_position_and_quaternion-130"><span class="linenos">130</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.from_position_and_quaternion-131"><a href="#Pose.from_position_and_quaternion-131"><span class="linenos">131</span></a><span class="sd">            A new Pose.</span>
</span><span id="Pose.from_position_and_quaternion-132"><a href="#Pose.from_position_and_quaternion-132"><span class="linenos">132</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.from_position_and_quaternion-133"><a href="#Pose.from_position_and_quaternion-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">Transform</span><span class="o">.</span><span class="n">from_position_and_quaternion</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">quaternion</span><span class="p">),</span> <span class="n">parent_frame</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a pose from a position and quaternion.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>position:</strong>  The position of the transform.</li>
<li><strong>quaternion:</strong>  The quaternion of the transform, in xyzw order.</li>
<li><strong>parent_frame:</strong>  The frame that the transform is relative to.</li>
<li><strong>pose_tree:</strong>  The world that the pose exists in.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new Pose.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.from_position_and_rotation" class="classattr">
                                        <input id="Pose.from_position_and_rotation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_position_and_rotation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">rotation</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">Rotation</span>,</span><span class="param">	<span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">pose_tree</span><span class="p">:</span> <span class="n"><a href="#PoseTree">posetree.pose.PoseTree</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.from_position_and_rotation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.from_position_and_rotation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.from_position_and_rotation-135"><a href="#Pose.from_position_and_rotation-135"><span class="linenos">135</span></a>    <span class="nd">@classmethod</span>
</span><span id="Pose.from_position_and_rotation-136"><a href="#Pose.from_position_and_rotation-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">from_position_and_rotation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">rotation</span><span class="p">:</span> <span class="n">Rotation</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">:</span> <span class="s2">&quot;PoseTree&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.from_position_and_rotation-137"><a href="#Pose.from_position_and_rotation-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a transform from a position and rotatoin.</span>
</span><span id="Pose.from_position_and_rotation-138"><a href="#Pose.from_position_and_rotation-138"><span class="linenos">138</span></a><span class="sd">        </span>
</span><span id="Pose.from_position_and_rotation-139"><a href="#Pose.from_position_and_rotation-139"><span class="linenos">139</span></a><span class="sd">        Args:</span>
</span><span id="Pose.from_position_and_rotation-140"><a href="#Pose.from_position_and_rotation-140"><span class="linenos">140</span></a><span class="sd">            position: The position of the transform.</span>
</span><span id="Pose.from_position_and_rotation-141"><a href="#Pose.from_position_and_rotation-141"><span class="linenos">141</span></a><span class="sd">            rotation: The rotation of the transform.</span>
</span><span id="Pose.from_position_and_rotation-142"><a href="#Pose.from_position_and_rotation-142"><span class="linenos">142</span></a><span class="sd">            parent_frame: The frame that the transform is relative to.</span>
</span><span id="Pose.from_position_and_rotation-143"><a href="#Pose.from_position_and_rotation-143"><span class="linenos">143</span></a><span class="sd">            pose_tree: The world that the pose exists in.</span>
</span><span id="Pose.from_position_and_rotation-144"><a href="#Pose.from_position_and_rotation-144"><span class="linenos">144</span></a><span class="sd">        </span>
</span><span id="Pose.from_position_and_rotation-145"><a href="#Pose.from_position_and_rotation-145"><span class="linenos">145</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.from_position_and_rotation-146"><a href="#Pose.from_position_and_rotation-146"><span class="linenos">146</span></a><span class="sd">            A new Pose.</span>
</span><span id="Pose.from_position_and_rotation-147"><a href="#Pose.from_position_and_rotation-147"><span class="linenos">147</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.from_position_and_rotation-148"><a href="#Pose.from_position_and_rotation-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">Transform</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">),</span> <span class="n">parent_frame</span><span class="p">,</span> <span class="n">pose_tree</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a transform from a position and rotatoin.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>position:</strong>  The position of the transform.</li>
<li><strong>rotation:</strong>  The rotation of the transform.</li>
<li><strong>parent_frame:</strong>  The frame that the transform is relative to.</li>
<li><strong>pose_tree:</strong>  The world that the pose exists in.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new Pose.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.transform" class="classattr">
                                <div class="attr variable">
            <span class="name">transform</span><span class="annotation">: <a href="#Transform">posetree.pose.Transform</a></span>

        
    </div>
    <a class="headerlink" href="#Pose.transform"></a>
    
            <div class="docstring"><p>The transform from the parent frame to the pose.</p>
</div>


                            </div>
                            <div id="Pose.position" class="classattr">
                                <div class="attr variable">
            <span class="name">position</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#Pose.position"></a>
    
            <div class="docstring"><p>The position of the pose relative to the parent frame.</p>
</div>


                            </div>
                            <div id="Pose.rotation" class="classattr">
                                <div class="attr variable">
            <span class="name">rotation</span><span class="annotation">: scipy.spatial.transform._rotation.Rotation</span>

        
    </div>
    <a class="headerlink" href="#Pose.rotation"></a>
    
            <div class="docstring"><p>The rotation of the pose relative to the parent frame.</p>
</div>


                            </div>
                            <div id="Pose.frame" class="classattr">
                                <div class="attr variable">
            <span class="name">frame</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#Pose.frame"></a>
    
            <div class="docstring"><p>The parent frame of the pose.</p>
</div>


                            </div>
                            <div id="Pose.pose_tree" class="classattr">
                                <div class="attr variable">
            <span class="name">pose_tree</span><span class="annotation">: <a href="#PoseTree">posetree.pose.PoseTree</a></span>

        
    </div>
    <a class="headerlink" href="#Pose.pose_tree"></a>
    
            <div class="docstring"><p>The PoseTree object containing the world that the pose exists in.</p>
</div>


                            </div>
                            <div id="Pose.x" class="classattr">
                                <div class="attr variable">
            <span class="name">x</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#Pose.x"></a>
    
            <div class="docstring"><p>The x coordinate of the position.</p>
</div>


                            </div>
                            <div id="Pose.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#Pose.y"></a>
    
            <div class="docstring"><p>The y coordinate of the position.</p>
</div>


                            </div>
                            <div id="Pose.z" class="classattr">
                                <div class="attr variable">
            <span class="name">z</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#Pose.z"></a>
    
            <div class="docstring"><p>The z coordinate of the position.</p>
</div>


                            </div>
                            <div id="Pose.x_axis" class="classattr">
                                <div class="attr variable">
            <span class="name">x_axis</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#Pose.x_axis"></a>
    
            <div class="docstring"><p>The x axis of the pose.</p>
</div>


                            </div>
                            <div id="Pose.y_axis" class="classattr">
                                <div class="attr variable">
            <span class="name">y_axis</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#Pose.y_axis"></a>
    
            <div class="docstring"><p>The y axis of the pose.</p>
</div>


                            </div>
                            <div id="Pose.z_axis" class="classattr">
                                <div class="attr variable">
            <span class="name">z_axis</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#Pose.z_axis"></a>
    
            <div class="docstring"><p>The z axis of the pose.</p>
</div>


                            </div>
                            <div id="Pose.in_frame" class="classattr">
                                        <input id="Pose.in_frame-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">in_frame</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.in_frame-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.in_frame"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.in_frame-205"><a href="#Pose.in_frame-205"><span class="linenos">205</span></a>    <span class="k">def</span> <span class="nf">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.in_frame-206"><a href="#Pose.in_frame-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose representing the same location in space expressed in a different frame.</span>
</span><span id="Pose.in_frame-207"><a href="#Pose.in_frame-207"><span class="linenos">207</span></a><span class="sd">        </span>
</span><span id="Pose.in_frame-208"><a href="#Pose.in_frame-208"><span class="linenos">208</span></a><span class="sd">        Args:</span>
</span><span id="Pose.in_frame-209"><a href="#Pose.in_frame-209"><span class="linenos">209</span></a><span class="sd">            new_parent_frame: The new frame that the transform is relative to.</span>
</span><span id="Pose.in_frame-210"><a href="#Pose.in_frame-210"><span class="linenos">210</span></a><span class="sd">        </span>
</span><span id="Pose.in_frame-211"><a href="#Pose.in_frame-211"><span class="linenos">211</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.in_frame-212"><a href="#Pose.in_frame-212"><span class="linenos">212</span></a><span class="sd">            A new pose with the same transform but in a different frame.</span>
</span><span id="Pose.in_frame-213"><a href="#Pose.in_frame-213"><span class="linenos">213</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.in_frame-214"><a href="#Pose.in_frame-214"><span class="linenos">214</span></a>        <span class="n">new_transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">parent_frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span>
</span><span id="Pose.in_frame-215"><a href="#Pose.in_frame-215"><span class="linenos">215</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">new_transform</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose representing the same location in space expressed in a different frame.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>new_parent_frame:</strong>  The new frame that the transform is relative to.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same transform but in a different frame.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.with_position" class="classattr">
                                        <input id="Pose.with_position-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">with_position</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.with_position-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.with_position"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.with_position-217"><a href="#Pose.with_position-217"><span class="linenos">217</span></a>    <span class="k">def</span> <span class="nf">with_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.with_position-218"><a href="#Pose.with_position-218"><span class="linenos">218</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same rotation but a different location relative to the parent frame.</span>
</span><span id="Pose.with_position-219"><a href="#Pose.with_position-219"><span class="linenos">219</span></a><span class="sd">        </span>
</span><span id="Pose.with_position-220"><a href="#Pose.with_position-220"><span class="linenos">220</span></a><span class="sd">        Args:</span>
</span><span id="Pose.with_position-221"><a href="#Pose.with_position-221"><span class="linenos">221</span></a><span class="sd">            position: The new location of the pose.</span>
</span><span id="Pose.with_position-222"><a href="#Pose.with_position-222"><span class="linenos">222</span></a><span class="sd">        </span>
</span><span id="Pose.with_position-223"><a href="#Pose.with_position-223"><span class="linenos">223</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.with_position-224"><a href="#Pose.with_position-224"><span class="linenos">224</span></a><span class="sd">            A new pose with the same rotation but a different location.</span>
</span><span id="Pose.with_position-225"><a href="#Pose.with_position-225"><span class="linenos">225</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.with_position-226"><a href="#Pose.with_position-226"><span class="linenos">226</span></a>        <span class="n">new_transform</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span>
</span><span id="Pose.with_position-227"><a href="#Pose.with_position-227"><span class="linenos">227</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">new_transform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose with the same rotation but a different location relative to the parent frame.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>position:</strong>  The new location of the pose.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same rotation but a different location.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.with_rotation" class="classattr">
                                        <input id="Pose.with_rotation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">with_rotation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">rotation</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">Rotation</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.with_rotation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.with_rotation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.with_rotation-229"><a href="#Pose.with_rotation-229"><span class="linenos">229</span></a>    <span class="k">def</span> <span class="nf">with_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation</span><span class="p">:</span> <span class="n">Rotation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.with_rotation-230"><a href="#Pose.with_rotation-230"><span class="linenos">230</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same location but a different rotation.</span>
</span><span id="Pose.with_rotation-231"><a href="#Pose.with_rotation-231"><span class="linenos">231</span></a><span class="sd">        </span>
</span><span id="Pose.with_rotation-232"><a href="#Pose.with_rotation-232"><span class="linenos">232</span></a><span class="sd">        Args:</span>
</span><span id="Pose.with_rotation-233"><a href="#Pose.with_rotation-233"><span class="linenos">233</span></a><span class="sd">            rotation: The new rotation of the pose.</span>
</span><span id="Pose.with_rotation-234"><a href="#Pose.with_rotation-234"><span class="linenos">234</span></a><span class="sd">        </span>
</span><span id="Pose.with_rotation-235"><a href="#Pose.with_rotation-235"><span class="linenos">235</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.with_rotation-236"><a href="#Pose.with_rotation-236"><span class="linenos">236</span></a><span class="sd">            A new pose with the same location but a different rotation.</span>
</span><span id="Pose.with_rotation-237"><a href="#Pose.with_rotation-237"><span class="linenos">237</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.with_rotation-238"><a href="#Pose.with_rotation-238"><span class="linenos">238</span></a>        <span class="n">new_transform</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">)</span>
</span><span id="Pose.with_rotation-239"><a href="#Pose.with_rotation-239"><span class="linenos">239</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">new_transform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose with the same location but a different rotation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>rotation:</strong>  The new rotation of the pose.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same location but a different rotation.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.with_rotation_matching" class="classattr">
                                        <input id="Pose.with_rotation_matching-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">with_rotation_matching</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.with_rotation_matching-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.with_rotation_matching"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.with_rotation_matching-241"><a href="#Pose.with_rotation_matching-241"><span class="linenos">241</span></a>    <span class="k">def</span> <span class="nf">with_rotation_matching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.with_rotation_matching-242"><a href="#Pose.with_rotation_matching-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same position but a different orientation, matching another pose.</span>
</span><span id="Pose.with_rotation_matching-243"><a href="#Pose.with_rotation_matching-243"><span class="linenos">243</span></a>
</span><span id="Pose.with_rotation_matching-244"><a href="#Pose.with_rotation_matching-244"><span class="linenos">244</span></a><span class="sd">        This method is frame aware, so even if the other pose has a different frame, the rotation will be matched correctly.</span>
</span><span id="Pose.with_rotation_matching-245"><a href="#Pose.with_rotation_matching-245"><span class="linenos">245</span></a><span class="sd">        </span>
</span><span id="Pose.with_rotation_matching-246"><a href="#Pose.with_rotation_matching-246"><span class="linenos">246</span></a><span class="sd">        Args:</span>
</span><span id="Pose.with_rotation_matching-247"><a href="#Pose.with_rotation_matching-247"><span class="linenos">247</span></a><span class="sd">            other: The pose to match the rotation of.</span>
</span><span id="Pose.with_rotation_matching-248"><a href="#Pose.with_rotation_matching-248"><span class="linenos">248</span></a><span class="sd">        </span>
</span><span id="Pose.with_rotation_matching-249"><a href="#Pose.with_rotation_matching-249"><span class="linenos">249</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.with_rotation_matching-250"><a href="#Pose.with_rotation_matching-250"><span class="linenos">250</span></a><span class="sd">            A new pose with the same position but a different orientation.</span>
</span><span id="Pose.with_rotation_matching-251"><a href="#Pose.with_rotation_matching-251"><span class="linenos">251</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.with_rotation_matching-252"><a href="#Pose.with_rotation_matching-252"><span class="linenos">252</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_rotation</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose with the same position but a different orientation, matching another pose.</p>

<p>This method is frame aware, so even if the other pose has a different frame, the rotation will be matched correctly.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>other:</strong>  The pose to match the rotation of.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same position but a different orientation.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.with_position_x" class="classattr">
                                        <input id="Pose.with_position_x-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">with_position_x</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.with_position_x-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.with_position_x"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.with_position_x-254"><a href="#Pose.with_position_x-254"><span class="linenos">254</span></a>    <span class="k">def</span> <span class="nf">with_position_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.with_position_x-255"><a href="#Pose.with_position_x-255"><span class="linenos">255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same y and z coordinates but a different x coordinate.</span>
</span><span id="Pose.with_position_x-256"><a href="#Pose.with_position_x-256"><span class="linenos">256</span></a><span class="sd">        </span>
</span><span id="Pose.with_position_x-257"><a href="#Pose.with_position_x-257"><span class="linenos">257</span></a><span class="sd">        Args:</span>
</span><span id="Pose.with_position_x-258"><a href="#Pose.with_position_x-258"><span class="linenos">258</span></a><span class="sd">            x: The new x coordinate of the pose.</span>
</span><span id="Pose.with_position_x-259"><a href="#Pose.with_position_x-259"><span class="linenos">259</span></a><span class="sd">            frame: The frame that the x coordinate is relative to. If None, the x coordinate is relative to the pose&#39;s frame.</span>
</span><span id="Pose.with_position_x-260"><a href="#Pose.with_position_x-260"><span class="linenos">260</span></a><span class="sd">        </span>
</span><span id="Pose.with_position_x-261"><a href="#Pose.with_position_x-261"><span class="linenos">261</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.with_position_x-262"><a href="#Pose.with_position_x-262"><span class="linenos">262</span></a><span class="sd">            A new pose with the same y and z coordinates but a different x coordinate.</span>
</span><span id="Pose.with_position_x-263"><a href="#Pose.with_position_x-263"><span class="linenos">263</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.with_position_x-264"><a href="#Pose.with_position_x-264"><span class="linenos">264</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose.with_position_x-265"><a href="#Pose.with_position_x-265"><span class="linenos">265</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
</span><span id="Pose.with_position_x-266"><a href="#Pose.with_position_x-266"><span class="linenos">266</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Pose.with_position_x-267"><a href="#Pose.with_position_x-267"><span class="linenos">267</span></a>            <span class="n">in_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose.with_position_x-268"><a href="#Pose.with_position_x-268"><span class="linenos">268</span></a>            <span class="k">return</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose with the same y and z coordinates but a different x coordinate.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>x:</strong>  The new x coordinate of the pose.</li>
<li><strong>frame:</strong>  The frame that the x coordinate is relative to. If None, the x coordinate is relative to the pose's frame.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same y and z coordinates but a different x coordinate.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.with_position_y" class="classattr">
                                        <input id="Pose.with_position_y-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">with_position_y</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">y</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.with_position_y-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.with_position_y"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.with_position_y-270"><a href="#Pose.with_position_y-270"><span class="linenos">270</span></a>    <span class="k">def</span> <span class="nf">with_position_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.with_position_y-271"><a href="#Pose.with_position_y-271"><span class="linenos">271</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same x and z coordinates but a different y coordinate.</span>
</span><span id="Pose.with_position_y-272"><a href="#Pose.with_position_y-272"><span class="linenos">272</span></a><span class="sd">        </span>
</span><span id="Pose.with_position_y-273"><a href="#Pose.with_position_y-273"><span class="linenos">273</span></a><span class="sd">        Args:</span>
</span><span id="Pose.with_position_y-274"><a href="#Pose.with_position_y-274"><span class="linenos">274</span></a><span class="sd">            y: The new y coordinate of the pose.</span>
</span><span id="Pose.with_position_y-275"><a href="#Pose.with_position_y-275"><span class="linenos">275</span></a><span class="sd">            frame: The frame that the y coordinate is relative to. If None, the y coordinate is relative to the pose&#39;s frame.</span>
</span><span id="Pose.with_position_y-276"><a href="#Pose.with_position_y-276"><span class="linenos">276</span></a><span class="sd">        </span>
</span><span id="Pose.with_position_y-277"><a href="#Pose.with_position_y-277"><span class="linenos">277</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.with_position_y-278"><a href="#Pose.with_position_y-278"><span class="linenos">278</span></a><span class="sd">            A new pose with the same x and z coordinates but a different y coordinate.</span>
</span><span id="Pose.with_position_y-279"><a href="#Pose.with_position_y-279"><span class="linenos">279</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.with_position_y-280"><a href="#Pose.with_position_y-280"><span class="linenos">280</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose.with_position_y-281"><a href="#Pose.with_position_y-281"><span class="linenos">281</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
</span><span id="Pose.with_position_y-282"><a href="#Pose.with_position_y-282"><span class="linenos">282</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Pose.with_position_y-283"><a href="#Pose.with_position_y-283"><span class="linenos">283</span></a>            <span class="n">in_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose.with_position_y-284"><a href="#Pose.with_position_y-284"><span class="linenos">284</span></a>            <span class="k">return</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="n">in_frame</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose with the same x and z coordinates but a different y coordinate.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>y:</strong>  The new y coordinate of the pose.</li>
<li><strong>frame:</strong>  The frame that the y coordinate is relative to. If None, the y coordinate is relative to the pose's frame.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same x and z coordinates but a different y coordinate.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.with_position_z" class="classattr">
                                        <input id="Pose.with_position_z-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">with_position_z</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">z</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.with_position_z-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.with_position_z"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.with_position_z-286"><a href="#Pose.with_position_z-286"><span class="linenos">286</span></a>    <span class="k">def</span> <span class="nf">with_position_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.with_position_z-287"><a href="#Pose.with_position_z-287"><span class="linenos">287</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose with the same x and y coordinates but a different z coordinate.</span>
</span><span id="Pose.with_position_z-288"><a href="#Pose.with_position_z-288"><span class="linenos">288</span></a><span class="sd">        </span>
</span><span id="Pose.with_position_z-289"><a href="#Pose.with_position_z-289"><span class="linenos">289</span></a><span class="sd">        Args:</span>
</span><span id="Pose.with_position_z-290"><a href="#Pose.with_position_z-290"><span class="linenos">290</span></a><span class="sd">            z: The new z coordinate of the pose.</span>
</span><span id="Pose.with_position_z-291"><a href="#Pose.with_position_z-291"><span class="linenos">291</span></a><span class="sd">            frame: The frame that the z coordinate is relative to. If None, the z coordinate is relative to the pose&#39;s frame.</span>
</span><span id="Pose.with_position_z-292"><a href="#Pose.with_position_z-292"><span class="linenos">292</span></a><span class="sd">        </span>
</span><span id="Pose.with_position_z-293"><a href="#Pose.with_position_z-293"><span class="linenos">293</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.with_position_z-294"><a href="#Pose.with_position_z-294"><span class="linenos">294</span></a><span class="sd">            A new pose with the same x and y coordinates but a different z coordinate.</span>
</span><span id="Pose.with_position_z-295"><a href="#Pose.with_position_z-295"><span class="linenos">295</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.with_position_z-296"><a href="#Pose.with_position_z-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose.with_position_z-297"><a href="#Pose.with_position_z-297"><span class="linenos">297</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
</span><span id="Pose.with_position_z-298"><a href="#Pose.with_position_z-298"><span class="linenos">298</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Pose.with_position_z-299"><a href="#Pose.with_position_z-299"><span class="linenos">299</span></a>            <span class="n">in_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose.with_position_z-300"><a href="#Pose.with_position_z-300"><span class="linenos">300</span></a>            <span class="k">return</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">with_position</span><span class="p">((</span><span class="n">in_frame</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">in_frame</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose with the same x and y coordinates but a different z coordinate.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>z:</strong>  The new z coordinate of the pose.</li>
<li><strong>frame:</strong>  The frame that the z coordinate is relative to. If None, the z coordinate is relative to the pose's frame.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same x and y coordinates but a different z coordinate.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.apply_transform" class="classattr">
                                        <input id="Pose.apply_transform-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_transform</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">transform</span><span class="p">:</span> <span class="n"><a href="#Transform">posetree.pose.Transform</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.apply_transform-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.apply_transform"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.apply_transform-302"><a href="#Pose.apply_transform-302"><span class="linenos">302</span></a>    <span class="k">def</span> <span class="nf">apply_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.apply_transform-303"><a href="#Pose.apply_transform-303"><span class="linenos">303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose transformed by a transform.</span>
</span><span id="Pose.apply_transform-304"><a href="#Pose.apply_transform-304"><span class="linenos">304</span></a>
</span><span id="Pose.apply_transform-305"><a href="#Pose.apply_transform-305"><span class="linenos">305</span></a><span class="sd">        This method is provided to give compatibility with systems that talk about poses in terms of transforms,</span>
</span><span id="Pose.apply_transform-306"><a href="#Pose.apply_transform-306"><span class="linenos">306</span></a><span class="sd">        but it is usually more readable and debuggable to use a rotate/translate method instead.</span>
</span><span id="Pose.apply_transform-307"><a href="#Pose.apply_transform-307"><span class="linenos">307</span></a><span class="sd">        </span>
</span><span id="Pose.apply_transform-308"><a href="#Pose.apply_transform-308"><span class="linenos">308</span></a><span class="sd">        Args:</span>
</span><span id="Pose.apply_transform-309"><a href="#Pose.apply_transform-309"><span class="linenos">309</span></a><span class="sd">            transform: The transform to apply.</span>
</span><span id="Pose.apply_transform-310"><a href="#Pose.apply_transform-310"><span class="linenos">310</span></a><span class="sd">        </span>
</span><span id="Pose.apply_transform-311"><a href="#Pose.apply_transform-311"><span class="linenos">311</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.apply_transform-312"><a href="#Pose.apply_transform-312"><span class="linenos">312</span></a><span class="sd">            A new pose transformed by a transform.</span>
</span><span id="Pose.apply_transform-313"><a href="#Pose.apply_transform-313"><span class="linenos">313</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.apply_transform-314"><a href="#Pose.apply_transform-314"><span class="linenos">314</span></a>        <span class="n">new_transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">*</span> <span class="n">transform</span>
</span><span id="Pose.apply_transform-315"><a href="#Pose.apply_transform-315"><span class="linenos">315</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">new_transform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose transformed by a transform.</p>

<p>This method is provided to give compatibility with systems that talk about poses in terms of transforms,
but it is usually more readable and debuggable to use a rotate/translate method instead.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>transform:</strong>  The transform to apply.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose transformed by a transform.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.translate" class="classattr">
                                        <input id="Pose.translate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">translate</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">translation</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">frame</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.translate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.translate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.translate-318"><a href="#Pose.translate-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">translation</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.translate-319"><a href="#Pose.translate-319"><span class="linenos">319</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose translated by a vector.</span>
</span><span id="Pose.translate-320"><a href="#Pose.translate-320"><span class="linenos">320</span></a>
</span><span id="Pose.translate-321"><a href="#Pose.translate-321"><span class="linenos">321</span></a><span class="sd">        The translation is relative to the basis of the pose being translated (i.e body-fixed) rather than the parent frame.</span>
</span><span id="Pose.translate-322"><a href="#Pose.translate-322"><span class="linenos">322</span></a><span class="sd">        That means that</span>
</span><span id="Pose.translate-323"><a href="#Pose.translate-323"><span class="linenos">323</span></a><span class="sd">        ```python</span>
</span><span id="Pose.translate-324"><a href="#Pose.translate-324"><span class="linenos">324</span></a><span class="sd">        p2 = p1.translate((1, 0, 0))</span>
</span><span id="Pose.translate-325"><a href="#Pose.translate-325"><span class="linenos">325</span></a><span class="sd">        ```</span>
</span><span id="Pose.translate-326"><a href="#Pose.translate-326"><span class="linenos">326</span></a><span class="sd">        and</span>
</span><span id="Pose.translate-327"><a href="#Pose.translate-327"><span class="linenos">327</span></a><span class="sd">        ```python</span>
</span><span id="Pose.translate-328"><a href="#Pose.translate-328"><span class="linenos">328</span></a><span class="sd">        p2 = p1.in_frame(&quot;some_other_frame&quot;).translate((1, 0, 0)).in_frame(p1.frame)</span>
</span><span id="Pose.translate-329"><a href="#Pose.translate-329"><span class="linenos">329</span></a><span class="sd">        ```</span>
</span><span id="Pose.translate-330"><a href="#Pose.translate-330"><span class="linenos">330</span></a><span class="sd">        are identical, because the parent frame of a pose does not affect its translation.</span>
</span><span id="Pose.translate-331"><a href="#Pose.translate-331"><span class="linenos">331</span></a>
</span><span id="Pose.translate-332"><a href="#Pose.translate-332"><span class="linenos">332</span></a><span class="sd">        Args:</span>
</span><span id="Pose.translate-333"><a href="#Pose.translate-333"><span class="linenos">333</span></a><span class="sd">            translation: The vector to translate by.</span>
</span><span id="Pose.translate-334"><a href="#Pose.translate-334"><span class="linenos">334</span></a><span class="sd">            frame: The frame that the vector is relative to.</span>
</span><span id="Pose.translate-335"><a href="#Pose.translate-335"><span class="linenos">335</span></a><span class="sd">        </span>
</span><span id="Pose.translate-336"><a href="#Pose.translate-336"><span class="linenos">336</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.translate-337"><a href="#Pose.translate-337"><span class="linenos">337</span></a><span class="sd">            A new pose translated by a vector.</span>
</span><span id="Pose.translate-338"><a href="#Pose.translate-338"><span class="linenos">338</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.translate-339"><a href="#Pose.translate-339"><span class="linenos">339</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose.translate-340"><a href="#Pose.translate-340"><span class="linenos">340</span></a>            <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">translation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span><span id="Pose.translate-341"><a href="#Pose.translate-341"><span class="linenos">341</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Pose.translate-342"><a href="#Pose.translate-342"><span class="linenos">342</span></a>            <span class="n">self_frame_t_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>
</span><span id="Pose.translate-343"><a href="#Pose.translate-343"><span class="linenos">343</span></a>            <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="n">self_frame_t_frame</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">translation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose translated by a vector.</p>

<p>The translation is relative to the basis of the pose being translated (i.e body-fixed) rather than the parent frame.
That means that</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">translate</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</code></pre>
</div>

<p>and</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="s2">&quot;some_other_frame&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">translate</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</code></pre>
</div>

<p>are identical, because the parent frame of a pose does not affect its translation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>translation:</strong>  The vector to translate by.</li>
<li><strong>frame:</strong>  The frame that the vector is relative to.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose translated by a vector.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.rotate_about_axis" class="classattr">
                                        <input id="Pose.rotate_about_axis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rotate_about_axis</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">angle</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.rotate_about_axis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.rotate_about_axis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.rotate_about_axis-345"><a href="#Pose.rotate_about_axis-345"><span class="linenos">345</span></a>    <span class="k">def</span> <span class="nf">rotate_about_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.rotate_about_axis-346"><a href="#Pose.rotate_about_axis-346"><span class="linenos">346</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated about an axis.</span>
</span><span id="Pose.rotate_about_axis-347"><a href="#Pose.rotate_about_axis-347"><span class="linenos">347</span></a>
</span><span id="Pose.rotate_about_axis-348"><a href="#Pose.rotate_about_axis-348"><span class="linenos">348</span></a><span class="sd">        This is rotated in the basis of the pose being rotated (i.e body-fixed) rather than the parent frame, and it only</span>
</span><span id="Pose.rotate_about_axis-349"><a href="#Pose.rotate_about_axis-349"><span class="linenos">349</span></a><span class="sd">        rotates the orientation. This is *not* a rotation about the origin, but a change of the orientation of the pose.</span>
</span><span id="Pose.rotate_about_axis-350"><a href="#Pose.rotate_about_axis-350"><span class="linenos">350</span></a>
</span><span id="Pose.rotate_about_axis-351"><a href="#Pose.rotate_about_axis-351"><span class="linenos">351</span></a><span class="sd">        If you pass a frame, the axis will be interpreted as being expressed in that frame.</span>
</span><span id="Pose.rotate_about_axis-352"><a href="#Pose.rotate_about_axis-352"><span class="linenos">352</span></a><span class="sd">        </span>
</span><span id="Pose.rotate_about_axis-353"><a href="#Pose.rotate_about_axis-353"><span class="linenos">353</span></a><span class="sd">        Args:</span>
</span><span id="Pose.rotate_about_axis-354"><a href="#Pose.rotate_about_axis-354"><span class="linenos">354</span></a><span class="sd">            axis: The axis to rotate about.</span>
</span><span id="Pose.rotate_about_axis-355"><a href="#Pose.rotate_about_axis-355"><span class="linenos">355</span></a><span class="sd">            angle: The angle to rotate by, in radians.</span>
</span><span id="Pose.rotate_about_axis-356"><a href="#Pose.rotate_about_axis-356"><span class="linenos">356</span></a><span class="sd">            frame: The frame that the axis is relative to. If None, the axis is interpreted in the basis vectors of the pose (not the parent frame).</span>
</span><span id="Pose.rotate_about_axis-357"><a href="#Pose.rotate_about_axis-357"><span class="linenos">357</span></a><span class="sd">        </span>
</span><span id="Pose.rotate_about_axis-358"><a href="#Pose.rotate_about_axis-358"><span class="linenos">358</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.rotate_about_axis-359"><a href="#Pose.rotate_about_axis-359"><span class="linenos">359</span></a><span class="sd">            A new pose with the same location but rotated about an axis.</span>
</span><span id="Pose.rotate_about_axis-360"><a href="#Pose.rotate_about_axis-360"><span class="linenos">360</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.rotate_about_axis-361"><a href="#Pose.rotate_about_axis-361"><span class="linenos">361</span></a>        <span class="n">axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
</span><span id="Pose.rotate_about_axis-362"><a href="#Pose.rotate_about_axis-362"><span class="linenos">362</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-6</span><span class="p">:</span>
</span><span id="Pose.rotate_about_axis-363"><a href="#Pose.rotate_about_axis-363"><span class="linenos">363</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Axis must be a unit vector.&quot;</span><span class="p">)</span>
</span><span id="Pose.rotate_about_axis-364"><a href="#Pose.rotate_about_axis-364"><span class="linenos">364</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pose.rotate_about_axis-365"><a href="#Pose.rotate_about_axis-365"><span class="linenos">365</span></a>            <span class="n">new_rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_rotvec</span><span class="p">(</span><span class="n">axis</span> <span class="o">*</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="Pose.rotate_about_axis-366"><a href="#Pose.rotate_about_axis-366"><span class="linenos">366</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Pose.rotate_about_axis-367"><a href="#Pose.rotate_about_axis-367"><span class="linenos">367</span></a>            <span class="n">frame_t_self_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Pose.rotate_about_axis-368"><a href="#Pose.rotate_about_axis-368"><span class="linenos">368</span></a>            <span class="n">new_rotation</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_rotvec</span><span class="p">(</span><span class="n">frame_t_self_frame</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span> <span class="o">*</span> <span class="n">angle</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span>
</span><span id="Pose.rotate_about_axis-369"><a href="#Pose.rotate_about_axis-369"><span class="linenos">369</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">new_rotation</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose_tree</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose rotated about an axis.</p>

<p>This is rotated in the basis of the pose being rotated (i.e body-fixed) rather than the parent frame, and it only
rotates the orientation. This is <em>not</em> a rotation about the origin, but a change of the orientation of the pose.</p>

<p>If you pass a frame, the axis will be interpreted as being expressed in that frame.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>axis:</strong>  The axis to rotate about.</li>
<li><strong>angle:</strong>  The angle to rotate by, in radians.</li>
<li><strong>frame:</strong>  The frame that the axis is relative to. If None, the axis is interpreted in the basis vectors of the pose (not the parent frame).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same location but rotated about an axis.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.rotate_about_x" class="classattr">
                                        <input id="Pose.rotate_about_x-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rotate_about_x</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">angle</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.rotate_about_x-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.rotate_about_x"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.rotate_about_x-371"><a href="#Pose.rotate_about_x-371"><span class="linenos">371</span></a>    <span class="k">def</span> <span class="nf">rotate_about_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.rotate_about_x-372"><a href="#Pose.rotate_about_x-372"><span class="linenos">372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated about the x axis.</span>
</span><span id="Pose.rotate_about_x-373"><a href="#Pose.rotate_about_x-373"><span class="linenos">373</span></a><span class="sd">        </span>
</span><span id="Pose.rotate_about_x-374"><a href="#Pose.rotate_about_x-374"><span class="linenos">374</span></a><span class="sd">        Args:</span>
</span><span id="Pose.rotate_about_x-375"><a href="#Pose.rotate_about_x-375"><span class="linenos">375</span></a><span class="sd">            angle: The angle to rotate by, in radians.</span>
</span><span id="Pose.rotate_about_x-376"><a href="#Pose.rotate_about_x-376"><span class="linenos">376</span></a><span class="sd">            frame: The frame that the axis is relative to. If not provided, it will rotate about the x-unit-vector of the pose being rotated.</span>
</span><span id="Pose.rotate_about_x-377"><a href="#Pose.rotate_about_x-377"><span class="linenos">377</span></a><span class="sd">        </span>
</span><span id="Pose.rotate_about_x-378"><a href="#Pose.rotate_about_x-378"><span class="linenos">378</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.rotate_about_x-379"><a href="#Pose.rotate_about_x-379"><span class="linenos">379</span></a><span class="sd">            A new pose with the same location but rotated about the x axis.</span>
</span><span id="Pose.rotate_about_x-380"><a href="#Pose.rotate_about_x-380"><span class="linenos">380</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.rotate_about_x-381"><a href="#Pose.rotate_about_x-381"><span class="linenos">381</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_about_axis</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose rotated about the x axis.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>angle:</strong>  The angle to rotate by, in radians.</li>
<li><strong>frame:</strong>  The frame that the axis is relative to. If not provided, it will rotate about the x-unit-vector of the pose being rotated.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same location but rotated about the x axis.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.rotate_about_y" class="classattr">
                                        <input id="Pose.rotate_about_y-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rotate_about_y</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">angle</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.rotate_about_y-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.rotate_about_y"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.rotate_about_y-383"><a href="#Pose.rotate_about_y-383"><span class="linenos">383</span></a>    <span class="k">def</span> <span class="nf">rotate_about_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.rotate_about_y-384"><a href="#Pose.rotate_about_y-384"><span class="linenos">384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated about the y axis.</span>
</span><span id="Pose.rotate_about_y-385"><a href="#Pose.rotate_about_y-385"><span class="linenos">385</span></a><span class="sd">        </span>
</span><span id="Pose.rotate_about_y-386"><a href="#Pose.rotate_about_y-386"><span class="linenos">386</span></a><span class="sd">        Args:</span>
</span><span id="Pose.rotate_about_y-387"><a href="#Pose.rotate_about_y-387"><span class="linenos">387</span></a><span class="sd">            angle: The angle to rotate by, in radians.</span>
</span><span id="Pose.rotate_about_y-388"><a href="#Pose.rotate_about_y-388"><span class="linenos">388</span></a><span class="sd">            frame: The frame that the axis is relative to. If not provided, it will rotate about the y-unit-vector of the pose being rotated.</span>
</span><span id="Pose.rotate_about_y-389"><a href="#Pose.rotate_about_y-389"><span class="linenos">389</span></a><span class="sd">        </span>
</span><span id="Pose.rotate_about_y-390"><a href="#Pose.rotate_about_y-390"><span class="linenos">390</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.rotate_about_y-391"><a href="#Pose.rotate_about_y-391"><span class="linenos">391</span></a><span class="sd">            A new pose with the same location but rotated about the y axis.</span>
</span><span id="Pose.rotate_about_y-392"><a href="#Pose.rotate_about_y-392"><span class="linenos">392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.rotate_about_y-393"><a href="#Pose.rotate_about_y-393"><span class="linenos">393</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_about_axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose rotated about the y axis.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>angle:</strong>  The angle to rotate by, in radians.</li>
<li><strong>frame:</strong>  The frame that the axis is relative to. If not provided, it will rotate about the y-unit-vector of the pose being rotated.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same location but rotated about the y axis.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.rotate_about_z" class="classattr">
                                        <input id="Pose.rotate_about_z-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rotate_about_z</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">angle</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.rotate_about_z-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.rotate_about_z"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.rotate_about_z-395"><a href="#Pose.rotate_about_z-395"><span class="linenos">395</span></a>    <span class="k">def</span> <span class="nf">rotate_about_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.rotate_about_z-396"><a href="#Pose.rotate_about_z-396"><span class="linenos">396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated about the z axis.</span>
</span><span id="Pose.rotate_about_z-397"><a href="#Pose.rotate_about_z-397"><span class="linenos">397</span></a><span class="sd">        </span>
</span><span id="Pose.rotate_about_z-398"><a href="#Pose.rotate_about_z-398"><span class="linenos">398</span></a><span class="sd">        Args:</span>
</span><span id="Pose.rotate_about_z-399"><a href="#Pose.rotate_about_z-399"><span class="linenos">399</span></a><span class="sd">            angle: The angle to rotate by, in radians.</span>
</span><span id="Pose.rotate_about_z-400"><a href="#Pose.rotate_about_z-400"><span class="linenos">400</span></a><span class="sd">            frame: The frame that the axis is relative to. If not provided, it will rotate about the z-unit-vector of the pose being rotated.</span>
</span><span id="Pose.rotate_about_z-401"><a href="#Pose.rotate_about_z-401"><span class="linenos">401</span></a><span class="sd">        </span>
</span><span id="Pose.rotate_about_z-402"><a href="#Pose.rotate_about_z-402"><span class="linenos">402</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.rotate_about_z-403"><a href="#Pose.rotate_about_z-403"><span class="linenos">403</span></a><span class="sd">            A new pose with the same location but rotated about the z axis.</span>
</span><span id="Pose.rotate_about_z-404"><a href="#Pose.rotate_about_z-404"><span class="linenos">404</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.rotate_about_z-405"><a href="#Pose.rotate_about_z-405"><span class="linenos">405</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_about_axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">angle</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose rotated about the z axis.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>angle:</strong>  The angle to rotate by, in radians.</li>
<li><strong>frame:</strong>  The frame that the axis is relative to. If not provided, it will rotate about the z-unit-vector of the pose being rotated.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same location but rotated about the z axis.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.point_x_at" class="classattr">
                                        <input id="Pose.point_x_at-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">point_x_at</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">target</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>,</span><span class="param">	<span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.point_x_at-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.point_x_at"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.point_x_at-407"><a href="#Pose.point_x_at-407"><span class="linenos">407</span></a>    <span class="k">def</span> <span class="nf">point_x_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.point_x_at-408"><a href="#Pose.point_x_at-408"><span class="linenos">408</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated to point the x axis at a target pose.</span>
</span><span id="Pose.point_x_at-409"><a href="#Pose.point_x_at-409"><span class="linenos">409</span></a><span class="sd">        </span>
</span><span id="Pose.point_x_at-410"><a href="#Pose.point_x_at-410"><span class="linenos">410</span></a><span class="sd">        Args:</span>
</span><span id="Pose.point_x_at-411"><a href="#Pose.point_x_at-411"><span class="linenos">411</span></a><span class="sd">            target: The target pose to point at.</span>
</span><span id="Pose.point_x_at-412"><a href="#Pose.point_x_at-412"><span class="linenos">412</span></a><span class="sd">            fixed_axis: An optional axis (&#39;x&#39;, &#39;y&#39; or &#39;z&#39;) to keep fixed. If not provided,</span>
</span><span id="Pose.point_x_at-413"><a href="#Pose.point_x_at-413"><span class="linenos">413</span></a><span class="sd">                the pose will be rotated the minimum rotation to have the axis point at the target pose.</span>
</span><span id="Pose.point_x_at-414"><a href="#Pose.point_x_at-414"><span class="linenos">414</span></a><span class="sd">        </span>
</span><span id="Pose.point_x_at-415"><a href="#Pose.point_x_at-415"><span class="linenos">415</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.point_x_at-416"><a href="#Pose.point_x_at-416"><span class="linenos">416</span></a><span class="sd">            A new pose with the same location but rotated to point the x axis at a target pose.</span>
</span><span id="Pose.point_x_at-417"><a href="#Pose.point_x_at-417"><span class="linenos">417</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.point_x_at-418"><a href="#Pose.point_x_at-418"><span class="linenos">418</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_point_at</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">fixed_axis</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose rotated to point the x axis at a target pose.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target:</strong>  The target pose to point at.</li>
<li><strong>fixed_axis:</strong>  An optional axis ('x', 'y' or 'z') to keep fixed. If not provided,
the pose will be rotated the minimum rotation to have the axis point at the target pose.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same location but rotated to point the x axis at a target pose.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.point_y_at" class="classattr">
                                        <input id="Pose.point_y_at-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">point_y_at</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">target</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>,</span><span class="param">	<span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.point_y_at-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.point_y_at"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.point_y_at-420"><a href="#Pose.point_y_at-420"><span class="linenos">420</span></a>    <span class="k">def</span> <span class="nf">point_y_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.point_y_at-421"><a href="#Pose.point_y_at-421"><span class="linenos">421</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated to point the y axis at a target pose.</span>
</span><span id="Pose.point_y_at-422"><a href="#Pose.point_y_at-422"><span class="linenos">422</span></a><span class="sd">        </span>
</span><span id="Pose.point_y_at-423"><a href="#Pose.point_y_at-423"><span class="linenos">423</span></a><span class="sd">        Args:</span>
</span><span id="Pose.point_y_at-424"><a href="#Pose.point_y_at-424"><span class="linenos">424</span></a><span class="sd">            target: The target pose to point at.</span>
</span><span id="Pose.point_y_at-425"><a href="#Pose.point_y_at-425"><span class="linenos">425</span></a><span class="sd">            fixed_axis: An optional axis (&#39;x&#39;, &#39;y&#39; or &#39;z&#39;) to keep fixed. If not provided,</span>
</span><span id="Pose.point_y_at-426"><a href="#Pose.point_y_at-426"><span class="linenos">426</span></a><span class="sd">                the pose will be rotated the minimum rotation to have the axis point at the target pose.</span>
</span><span id="Pose.point_y_at-427"><a href="#Pose.point_y_at-427"><span class="linenos">427</span></a><span class="sd">        </span>
</span><span id="Pose.point_y_at-428"><a href="#Pose.point_y_at-428"><span class="linenos">428</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.point_y_at-429"><a href="#Pose.point_y_at-429"><span class="linenos">429</span></a><span class="sd">            A new pose with the same location but rotated to point the y axis at a target pose.</span>
</span><span id="Pose.point_y_at-430"><a href="#Pose.point_y_at-430"><span class="linenos">430</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.point_y_at-431"><a href="#Pose.point_y_at-431"><span class="linenos">431</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_point_at</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">fixed_axis</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose rotated to point the y axis at a target pose.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target:</strong>  The target pose to point at.</li>
<li><strong>fixed_axis:</strong>  An optional axis ('x', 'y' or 'z') to keep fixed. If not provided,
the pose will be rotated the minimum rotation to have the axis point at the target pose.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same location but rotated to point the y axis at a target pose.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.point_z_at" class="classattr">
                                        <input id="Pose.point_z_at-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">point_z_at</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">target</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>,</span><span class="param">	<span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.point_z_at-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.point_z_at"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.point_z_at-433"><a href="#Pose.point_z_at-433"><span class="linenos">433</span></a>    <span class="k">def</span> <span class="nf">point_z_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">fixed_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.point_z_at-434"><a href="#Pose.point_z_at-434"><span class="linenos">434</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose rotated to point the z axis at a target pose.</span>
</span><span id="Pose.point_z_at-435"><a href="#Pose.point_z_at-435"><span class="linenos">435</span></a><span class="sd">        </span>
</span><span id="Pose.point_z_at-436"><a href="#Pose.point_z_at-436"><span class="linenos">436</span></a><span class="sd">        Args:</span>
</span><span id="Pose.point_z_at-437"><a href="#Pose.point_z_at-437"><span class="linenos">437</span></a><span class="sd">            target: The target pose to point at.</span>
</span><span id="Pose.point_z_at-438"><a href="#Pose.point_z_at-438"><span class="linenos">438</span></a><span class="sd">        </span>
</span><span id="Pose.point_z_at-439"><a href="#Pose.point_z_at-439"><span class="linenos">439</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.point_z_at-440"><a href="#Pose.point_z_at-440"><span class="linenos">440</span></a><span class="sd">            A new pose with the same location but rotated to point the z axis at a target pose.</span>
</span><span id="Pose.point_z_at-441"><a href="#Pose.point_z_at-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.point_z_at-442"><a href="#Pose.point_z_at-442"><span class="linenos">442</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_point_at</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">fixed_axis</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose rotated to point the z axis at a target pose.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target:</strong>  The target pose to point at.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose with the same location but rotated to point the z axis at a target pose.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.interpolate" class="classattr">
                                        <input id="Pose.interpolate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">interpolate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>, </span><span class="param"><span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.interpolate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.interpolate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.interpolate-444"><a href="#Pose.interpolate-444"><span class="linenos">444</span></a>    <span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.interpolate-445"><a href="#Pose.interpolate-445"><span class="linenos">445</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new pose interpolated between two poses, in the frame of the first pose.</span>
</span><span id="Pose.interpolate-446"><a href="#Pose.interpolate-446"><span class="linenos">446</span></a><span class="sd">        </span>
</span><span id="Pose.interpolate-447"><a href="#Pose.interpolate-447"><span class="linenos">447</span></a><span class="sd">        Args:</span>
</span><span id="Pose.interpolate-448"><a href="#Pose.interpolate-448"><span class="linenos">448</span></a><span class="sd">            target: The target pose to interpolate to.</span>
</span><span id="Pose.interpolate-449"><a href="#Pose.interpolate-449"><span class="linenos">449</span></a><span class="sd">            alpha: The interpolation factor. 0.0 will return the current pose, 1.0 will return</span>
</span><span id="Pose.interpolate-450"><a href="#Pose.interpolate-450"><span class="linenos">450</span></a><span class="sd">                the target pose and values in between will return a pose interpolated between the two.</span>
</span><span id="Pose.interpolate-451"><a href="#Pose.interpolate-451"><span class="linenos">451</span></a><span class="sd">        </span>
</span><span id="Pose.interpolate-452"><a href="#Pose.interpolate-452"><span class="linenos">452</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.interpolate-453"><a href="#Pose.interpolate-453"><span class="linenos">453</span></a><span class="sd">            A new pose interpolated between two poses.</span>
</span><span id="Pose.interpolate-454"><a href="#Pose.interpolate-454"><span class="linenos">454</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.interpolate-455"><a href="#Pose.interpolate-455"><span class="linenos">455</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">alpha</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Return a new pose interpolated between two poses, in the frame of the first pose.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target:</strong>  The target pose to interpolate to.</li>
<li><strong>alpha:</strong>  The interpolation factor. 0.0 will return the current pose, 1.0 will return
the target pose and values in between will return a pose interpolated between the two.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new pose interpolated between two poses.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.distance_to" class="classattr">
                                        <input id="Pose.distance_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">distance_to</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Pose.distance_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.distance_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.distance_to-457"><a href="#Pose.distance_to-457"><span class="linenos">457</span></a>    <span class="k">def</span> <span class="nf">distance_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose.distance_to-458"><a href="#Pose.distance_to-458"><span class="linenos">458</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the cartesian distance between two poses.</span>
</span><span id="Pose.distance_to-459"><a href="#Pose.distance_to-459"><span class="linenos">459</span></a><span class="sd">        </span>
</span><span id="Pose.distance_to-460"><a href="#Pose.distance_to-460"><span class="linenos">460</span></a><span class="sd">        Args:</span>
</span><span id="Pose.distance_to-461"><a href="#Pose.distance_to-461"><span class="linenos">461</span></a><span class="sd">            other: The other pose.</span>
</span><span id="Pose.distance_to-462"><a href="#Pose.distance_to-462"><span class="linenos">462</span></a><span class="sd">        </span>
</span><span id="Pose.distance_to-463"><a href="#Pose.distance_to-463"><span class="linenos">463</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.distance_to-464"><a href="#Pose.distance_to-464"><span class="linenos">464</span></a><span class="sd">            The distance between two poses.</span>
</span><span id="Pose.distance_to-465"><a href="#Pose.distance_to-465"><span class="linenos">465</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.distance_to-466"><a href="#Pose.distance_to-466"><span class="linenos">466</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the cartesian distance between two poses.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>other:</strong>  The other pose.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>The distance between two poses.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.angle_to" class="classattr">
                                        <input id="Pose.angle_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angle_to</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Pose.angle_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.angle_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.angle_to-468"><a href="#Pose.angle_to-468"><span class="linenos">468</span></a>    <span class="k">def</span> <span class="nf">angle_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose.angle_to-469"><a href="#Pose.angle_to-469"><span class="linenos">469</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the angle between two poses&#39; orientations. Ignores position. Will convert to the same frame.</span>
</span><span id="Pose.angle_to-470"><a href="#Pose.angle_to-470"><span class="linenos">470</span></a><span class="sd">        </span>
</span><span id="Pose.angle_to-471"><a href="#Pose.angle_to-471"><span class="linenos">471</span></a><span class="sd">        This gives the magnitude of the minimal rotation that will align the two poses.</span>
</span><span id="Pose.angle_to-472"><a href="#Pose.angle_to-472"><span class="linenos">472</span></a>
</span><span id="Pose.angle_to-473"><a href="#Pose.angle_to-473"><span class="linenos">473</span></a><span class="sd">        Args:</span>
</span><span id="Pose.angle_to-474"><a href="#Pose.angle_to-474"><span class="linenos">474</span></a><span class="sd">            target: The target pose.</span>
</span><span id="Pose.angle_to-475"><a href="#Pose.angle_to-475"><span class="linenos">475</span></a><span class="sd">        </span>
</span><span id="Pose.angle_to-476"><a href="#Pose.angle_to-476"><span class="linenos">476</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.angle_to-477"><a href="#Pose.angle_to-477"><span class="linenos">477</span></a><span class="sd">            The angle between two poses, in radians.</span>
</span><span id="Pose.angle_to-478"><a href="#Pose.angle_to-478"><span class="linenos">478</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.angle_to-479"><a href="#Pose.angle_to-479"><span class="linenos">479</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">angle_to</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the angle between two poses' orientations. Ignores position. Will convert to the same frame.</p>

<p>This gives the magnitude of the minimal rotation that will align the two poses.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target:</strong>  The target pose.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>The angle between two poses, in radians.</p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.angle_about_x_to" class="classattr">
                                        <input id="Pose.angle_about_x_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angle_about_x_to</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Pose.angle_about_x_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.angle_about_x_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.angle_about_x_to-502"><a href="#Pose.angle_about_x_to-502"><span class="linenos">502</span></a>    <span class="k">def</span> <span class="nf">angle_about_x_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose.angle_about_x_to-503"><a href="#Pose.angle_about_x_to-503"><span class="linenos">503</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the signed angle between two poses&#39; orientations about the x axis. Ignores position. Will convert to the same frame.</span>
</span><span id="Pose.angle_about_x_to-504"><a href="#Pose.angle_about_x_to-504"><span class="linenos">504</span></a><span class="sd">        </span>
</span><span id="Pose.angle_about_x_to-505"><a href="#Pose.angle_about_x_to-505"><span class="linenos">505</span></a><span class="sd">        Args:</span>
</span><span id="Pose.angle_about_x_to-506"><a href="#Pose.angle_about_x_to-506"><span class="linenos">506</span></a><span class="sd">            target: The target pose.</span>
</span><span id="Pose.angle_about_x_to-507"><a href="#Pose.angle_about_x_to-507"><span class="linenos">507</span></a><span class="sd">        </span>
</span><span id="Pose.angle_about_x_to-508"><a href="#Pose.angle_about_x_to-508"><span class="linenos">508</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.angle_about_x_to-509"><a href="#Pose.angle_about_x_to-509"><span class="linenos">509</span></a><span class="sd">            The angle between two poses, in radians.</span>
</span><span id="Pose.angle_about_x_to-510"><a href="#Pose.angle_about_x_to-510"><span class="linenos">510</span></a>
</span><span id="Pose.angle_about_x_to-511"><a href="#Pose.angle_about_x_to-511"><span class="linenos">511</span></a><span class="sd">        Raises:</span>
</span><span id="Pose.angle_about_x_to-512"><a href="#Pose.angle_about_x_to-512"><span class="linenos">512</span></a><span class="sd">            ValueError: If the rotation is more than 20% out of the expected axis.</span>
</span><span id="Pose.angle_about_x_to-513"><a href="#Pose.angle_about_x_to-513"><span class="linenos">513</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.angle_about_x_to-514"><a href="#Pose.angle_about_x_to-514"><span class="linenos">514</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angle_about_axis_to</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> 
</span></pre></div>


            <div class="docstring"><p>Return the signed angle between two poses' orientations about the x axis. Ignores position. Will convert to the same frame.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target:</strong>  The target pose.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>The angle between two poses, in radians.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the rotation is more than 20% out of the expected axis.</li>
</ul>
</div>


                            </div>
                            <div id="Pose.angle_about_y_to" class="classattr">
                                        <input id="Pose.angle_about_y_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angle_about_y_to</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Pose.angle_about_y_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.angle_about_y_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.angle_about_y_to-517"><a href="#Pose.angle_about_y_to-517"><span class="linenos">517</span></a>    <span class="k">def</span> <span class="nf">angle_about_y_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose.angle_about_y_to-518"><a href="#Pose.angle_about_y_to-518"><span class="linenos">518</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the signed angle between two poses&#39; orientations about the y axis. Ignores position. Will convert to the same frame.</span>
</span><span id="Pose.angle_about_y_to-519"><a href="#Pose.angle_about_y_to-519"><span class="linenos">519</span></a><span class="sd">        </span>
</span><span id="Pose.angle_about_y_to-520"><a href="#Pose.angle_about_y_to-520"><span class="linenos">520</span></a><span class="sd">        Args:</span>
</span><span id="Pose.angle_about_y_to-521"><a href="#Pose.angle_about_y_to-521"><span class="linenos">521</span></a><span class="sd">            target: The target pose.</span>
</span><span id="Pose.angle_about_y_to-522"><a href="#Pose.angle_about_y_to-522"><span class="linenos">522</span></a><span class="sd">        </span>
</span><span id="Pose.angle_about_y_to-523"><a href="#Pose.angle_about_y_to-523"><span class="linenos">523</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.angle_about_y_to-524"><a href="#Pose.angle_about_y_to-524"><span class="linenos">524</span></a><span class="sd">            The angle between two poses, in radians.</span>
</span><span id="Pose.angle_about_y_to-525"><a href="#Pose.angle_about_y_to-525"><span class="linenos">525</span></a>
</span><span id="Pose.angle_about_y_to-526"><a href="#Pose.angle_about_y_to-526"><span class="linenos">526</span></a><span class="sd">        Raises:</span>
</span><span id="Pose.angle_about_y_to-527"><a href="#Pose.angle_about_y_to-527"><span class="linenos">527</span></a><span class="sd">            ValueError: If the rotation is more than 20% out of the expected axis.</span>
</span><span id="Pose.angle_about_y_to-528"><a href="#Pose.angle_about_y_to-528"><span class="linenos">528</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.angle_about_y_to-529"><a href="#Pose.angle_about_y_to-529"><span class="linenos">529</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angle_about_axis_to</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Return the signed angle between two poses' orientations about the y axis. Ignores position. Will convert to the same frame.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target:</strong>  The target pose.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>The angle between two poses, in radians.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the rotation is more than 20% out of the expected axis.</li>
</ul>
</div>


                            </div>
                            <div id="Pose.angle_about_z_to" class="classattr">
                                        <input id="Pose.angle_about_z_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angle_about_z_to</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Pose.angle_about_z_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.angle_about_z_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.angle_about_z_to-532"><a href="#Pose.angle_about_z_to-532"><span class="linenos">532</span></a>    <span class="k">def</span> <span class="nf">angle_about_z_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Pose.angle_about_z_to-533"><a href="#Pose.angle_about_z_to-533"><span class="linenos">533</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the signed angle between two poses&#39; orientations about the z axis. Ignores position. Will convert to the same frame.</span>
</span><span id="Pose.angle_about_z_to-534"><a href="#Pose.angle_about_z_to-534"><span class="linenos">534</span></a><span class="sd">        </span>
</span><span id="Pose.angle_about_z_to-535"><a href="#Pose.angle_about_z_to-535"><span class="linenos">535</span></a><span class="sd">        Args:</span>
</span><span id="Pose.angle_about_z_to-536"><a href="#Pose.angle_about_z_to-536"><span class="linenos">536</span></a><span class="sd">            target: The target pose.</span>
</span><span id="Pose.angle_about_z_to-537"><a href="#Pose.angle_about_z_to-537"><span class="linenos">537</span></a><span class="sd">        </span>
</span><span id="Pose.angle_about_z_to-538"><a href="#Pose.angle_about_z_to-538"><span class="linenos">538</span></a><span class="sd">        Returns:</span>
</span><span id="Pose.angle_about_z_to-539"><a href="#Pose.angle_about_z_to-539"><span class="linenos">539</span></a><span class="sd">            The angle between two poses, in radians.</span>
</span><span id="Pose.angle_about_z_to-540"><a href="#Pose.angle_about_z_to-540"><span class="linenos">540</span></a>
</span><span id="Pose.angle_about_z_to-541"><a href="#Pose.angle_about_z_to-541"><span class="linenos">541</span></a><span class="sd">        Raises:</span>
</span><span id="Pose.angle_about_z_to-542"><a href="#Pose.angle_about_z_to-542"><span class="linenos">542</span></a><span class="sd">            ValueError: If the rotation is more than 20% out of the expected axis.</span>
</span><span id="Pose.angle_about_z_to-543"><a href="#Pose.angle_about_z_to-543"><span class="linenos">543</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.angle_about_z_to-544"><a href="#Pose.angle_about_z_to-544"><span class="linenos">544</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angle_about_axis_to</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Return the signed angle between two poses' orientations about the z axis. Ignores position. Will convert to the same frame.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target:</strong>  The target pose.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>The angle between two poses, in radians.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the rotation is more than 20% out of the expected axis.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="PoseTree">
                            <input id="PoseTree-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PoseTree</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="PoseTree-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PoseTree"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PoseTree-582"><a href="#PoseTree-582"><span class="linenos">582</span></a><span class="k">class</span> <span class="nc">PoseTree</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="PoseTree-583"><a href="#PoseTree-583"><span class="linenos">583</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class to manage poses and frames.</span>
</span><span id="PoseTree-584"><a href="#PoseTree-584"><span class="linenos">584</span></a><span class="sd">    </span>
</span><span id="PoseTree-585"><a href="#PoseTree-585"><span class="linenos">585</span></a><span class="sd">    To hook up this library to your project, you should subclass this class and hook it up to your stream of transforms</span>
</span><span id="PoseTree-586"><a href="#PoseTree-586"><span class="linenos">586</span></a><span class="sd">    by implementing _get_transform. Usually this will look like adding a callback-subscribe method to your class and storing</span>
</span><span id="PoseTree-587"><a href="#PoseTree-587"><span class="linenos">587</span></a><span class="sd">    the transforms between important frames as they come in. If you don&#39;t already have a way of interpolating between transforms,</span>
</span><span id="PoseTree-588"><a href="#PoseTree-588"><span class="linenos">588</span></a><span class="sd">    check out ROS&#39;s tf2 library. This library is designed to wrap nicely on top of tf2, if you are already using it.</span>
</span><span id="PoseTree-589"><a href="#PoseTree-589"><span class="linenos">589</span></a><span class="sd">    </span>
</span><span id="PoseTree-590"><a href="#PoseTree-590"><span class="linenos">590</span></a><span class="sd">    </span>
</span><span id="PoseTree-591"><a href="#PoseTree-591"><span class="linenos">591</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PoseTree-592"><a href="#PoseTree-592"><span class="linenos">592</span></a>    <span class="k">def</span> <span class="nf">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="PoseTree-593"><a href="#PoseTree-593"><span class="linenos">593</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transform from the parent frame to the child frame.&quot;&quot;&quot;</span>
</span><span id="PoseTree-594"><a href="#PoseTree-594"><span class="linenos">594</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_transform</span><span class="p">(</span><span class="n">parent_frame</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</span><span id="PoseTree-595"><a href="#PoseTree-595"><span class="linenos">595</span></a>    
</span><span id="PoseTree-596"><a href="#PoseTree-596"><span class="linenos">596</span></a>    <span class="k">def</span> <span class="nf">get_pose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">quaternion</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Pose</span><span class="p">:</span>
</span><span id="PoseTree-597"><a href="#PoseTree-597"><span class="linenos">597</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose object from a position, quaternion, and parent frame. Essentially syntactic sugar on top of Pose&#39;s constructor.&quot;&quot;&quot;</span>
</span><span id="PoseTree-598"><a href="#PoseTree-598"><span class="linenos">598</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">Transform</span><span class="o">.</span><span class="n">from_position_and_quaternion</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">quaternion</span><span class="p">),</span> <span class="n">parent_frame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="PoseTree-599"><a href="#PoseTree-599"><span class="linenos">599</span></a>    
</span><span id="PoseTree-600"><a href="#PoseTree-600"><span class="linenos">600</span></a>    <span class="nd">@contextmanager</span>
</span><span id="PoseTree-601"><a href="#PoseTree-601"><span class="linenos">601</span></a>    <span class="k">def</span> <span class="nf">temporary_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="n">Pose</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PoseTree-602"><a href="#PoseTree-602"><span class="linenos">602</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a temporary frame from a pose.</span>
</span><span id="PoseTree-603"><a href="#PoseTree-603"><span class="linenos">603</span></a><span class="sd">        </span>
</span><span id="PoseTree-604"><a href="#PoseTree-604"><span class="linenos">604</span></a><span class="sd">        This is intended to be used for anonymous frames for doing calculations.</span>
</span><span id="PoseTree-605"><a href="#PoseTree-605"><span class="linenos">605</span></a>
</span><span id="PoseTree-606"><a href="#PoseTree-606"><span class="linenos">606</span></a><span class="sd">        Example 1, find an approach angle that is close to the robot base:</span>
</span><span id="PoseTree-607"><a href="#PoseTree-607"><span class="linenos">607</span></a><span class="sd">        ```python</span>
</span><span id="PoseTree-608"><a href="#PoseTree-608"><span class="linenos">608</span></a><span class="sd">        for theta in np.linspace(0, 2 * np.pi, 100):</span>
</span><span id="PoseTree-609"><a href="#PoseTree-609"><span class="linenos">609</span></a><span class="sd">            with tree.temporary_frame(target_pose.rotate_about_z(theta)) as approach_frame:</span>
</span><span id="PoseTree-610"><a href="#PoseTree-610"><span class="linenos">610</span></a><span class="sd">                if abs(robot_base_pose.in_frame(approach_frame).y) &lt; 0.1:</span>
</span><span id="PoseTree-611"><a href="#PoseTree-611"><span class="linenos">611</span></a><span class="sd">                    return theta</span>
</span><span id="PoseTree-612"><a href="#PoseTree-612"><span class="linenos">612</span></a><span class="sd">        ```</span>
</span><span id="PoseTree-613"><a href="#PoseTree-613"><span class="linenos">613</span></a>
</span><span id="PoseTree-614"><a href="#PoseTree-614"><span class="linenos">614</span></a><span class="sd">        Example 2, find a person that is ready to talk to the robot:</span>
</span><span id="PoseTree-615"><a href="#PoseTree-615"><span class="linenos">615</span></a><span class="sd">        ```python</span>
</span><span id="PoseTree-616"><a href="#PoseTree-616"><span class="linenos">616</span></a><span class="sd">        for person in people:</span>
</span><span id="PoseTree-617"><a href="#PoseTree-617"><span class="linenos">617</span></a><span class="sd">            with tree.temporary_frame(person.head_pose) as head_frame:</span>
</span><span id="PoseTree-618"><a href="#PoseTree-618"><span class="linenos">618</span></a><span class="sd">            x, y, _ = robot_base_pose.in_frame(head_frame).position</span>
</span><span id="PoseTree-619"><a href="#PoseTree-619"><span class="linenos">619</span></a><span class="sd">                if abs(y) &lt; 0.5 and 0.5 &lt; x &lt; 1.5:</span>
</span><span id="PoseTree-620"><a href="#PoseTree-620"><span class="linenos">620</span></a><span class="sd">                    return person</span>
</span><span id="PoseTree-621"><a href="#PoseTree-621"><span class="linenos">621</span></a><span class="sd">        ```</span>
</span><span id="PoseTree-622"><a href="#PoseTree-622"><span class="linenos">622</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PoseTree-623"><a href="#PoseTree-623"><span class="linenos">623</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
</span><span id="PoseTree-624"><a href="#PoseTree-624"><span class="linenos">624</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_frame</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="PoseTree-625"><a href="#PoseTree-625"><span class="linenos">625</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PoseTree-626"><a href="#PoseTree-626"><span class="linenos">626</span></a>            <span class="k">yield</span> <span class="n">name</span>
</span><span id="PoseTree-627"><a href="#PoseTree-627"><span class="linenos">627</span></a>        <span class="k">finally</span><span class="p">:</span>
</span><span id="PoseTree-628"><a href="#PoseTree-628"><span class="linenos">628</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">remove_frame</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="PoseTree-629"><a href="#PoseTree-629"><span class="linenos">629</span></a>    
</span><span id="PoseTree-630"><a href="#PoseTree-630"><span class="linenos">630</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="PoseTree-631"><a href="#PoseTree-631"><span class="linenos">631</span></a>    <span class="k">def</span> <span class="nf">_get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="PoseTree-632"><a href="#PoseTree-632"><span class="linenos">632</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transform from the parent frame to the child frame. </span>
</span><span id="PoseTree-633"><a href="#PoseTree-633"><span class="linenos">633</span></a><span class="sd">        </span>
</span><span id="PoseTree-634"><a href="#PoseTree-634"><span class="linenos">634</span></a><span class="sd">        Args:</span>
</span><span id="PoseTree-635"><a href="#PoseTree-635"><span class="linenos">635</span></a><span class="sd">            parent_frame: The name of the parent frame.</span>
</span><span id="PoseTree-636"><a href="#PoseTree-636"><span class="linenos">636</span></a><span class="sd">            child_frame: The name of the child frame.</span>
</span><span id="PoseTree-637"><a href="#PoseTree-637"><span class="linenos">637</span></a><span class="sd">            timestamp: The timestamp of the transform. If None, the latest transform is returned.</span>
</span><span id="PoseTree-638"><a href="#PoseTree-638"><span class="linenos">638</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PoseTree-639"><a href="#PoseTree-639"><span class="linenos">639</span></a>        <span class="k">pass</span>
</span><span id="PoseTree-640"><a href="#PoseTree-640"><span class="linenos">640</span></a>
</span><span id="PoseTree-641"><a href="#PoseTree-641"><span class="linenos">641</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="PoseTree-642"><a href="#PoseTree-642"><span class="linenos">642</span></a>    <span class="k">def</span> <span class="nf">add_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="n">Pose</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PoseTree-643"><a href="#PoseTree-643"><span class="linenos">643</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a static frame to the tree.</span>
</span><span id="PoseTree-644"><a href="#PoseTree-644"><span class="linenos">644</span></a>
</span><span id="PoseTree-645"><a href="#PoseTree-645"><span class="linenos">645</span></a><span class="sd">        Example:</span>
</span><span id="PoseTree-646"><a href="#PoseTree-646"><span class="linenos">646</span></a><span class="sd">        ```python</span>
</span><span id="PoseTree-647"><a href="#PoseTree-647"><span class="linenos">647</span></a><span class="sd">        pose_tree.add_frame(table_corner_pose, &#39;table_frame&#39;)</span>
</span><span id="PoseTree-648"><a href="#PoseTree-648"><span class="linenos">648</span></a>
</span><span id="PoseTree-649"><a href="#PoseTree-649"><span class="linenos">649</span></a><span class="sd">        # Look at center of table:</span>
</span><span id="PoseTree-650"><a href="#PoseTree-650"><span class="linenos">650</span></a><span class="sd">        robot.look_at(</span>
</span><span id="PoseTree-651"><a href="#PoseTree-651"><span class="linenos">651</span></a><span class="sd">            Pose.from_position_and_rotation(</span>
</span><span id="PoseTree-652"><a href="#PoseTree-652"><span class="linenos">652</span></a><span class="sd">                [table_size_x / 2, tablesize_y_y / 2, 0],</span>
</span><span id="PoseTree-653"><a href="#PoseTree-653"><span class="linenos">653</span></a><span class="sd">                Rotation.identity(),</span>
</span><span id="PoseTree-654"><a href="#PoseTree-654"><span class="linenos">654</span></a><span class="sd">                &#39;table_frame&#39;))</span>
</span><span id="PoseTree-655"><a href="#PoseTree-655"><span class="linenos">655</span></a><span class="sd">        ```</span>
</span><span id="PoseTree-656"><a href="#PoseTree-656"><span class="linenos">656</span></a>
</span><span id="PoseTree-657"><a href="#PoseTree-657"><span class="linenos">657</span></a><span class="sd">        Don&#39;t use this for scratch frames for doing calculations. Use the temporary_frame context manager instead. This should </span>
</span><span id="PoseTree-658"><a href="#PoseTree-658"><span class="linenos">658</span></a><span class="sd">        be used for permanant, human meaningful things like a workspace frame.</span>
</span><span id="PoseTree-659"><a href="#PoseTree-659"><span class="linenos">659</span></a>
</span><span id="PoseTree-660"><a href="#PoseTree-660"><span class="linenos">660</span></a><span class="sd">        This is also not a good solution for frames that are moving, as the frames will not be interpolated to particular timestamps.</span>
</span><span id="PoseTree-661"><a href="#PoseTree-661"><span class="linenos">661</span></a><span class="sd">        </span>
</span><span id="PoseTree-662"><a href="#PoseTree-662"><span class="linenos">662</span></a><span class="sd">        Args:</span>
</span><span id="PoseTree-663"><a href="#PoseTree-663"><span class="linenos">663</span></a><span class="sd">            pose: The pose of the new frame relative to the parent frame.</span>
</span><span id="PoseTree-664"><a href="#PoseTree-664"><span class="linenos">664</span></a><span class="sd">            name: The name of the new frame.</span>
</span><span id="PoseTree-665"><a href="#PoseTree-665"><span class="linenos">665</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PoseTree-666"><a href="#PoseTree-666"><span class="linenos">666</span></a>        <span class="k">pass</span>
</span><span id="PoseTree-667"><a href="#PoseTree-667"><span class="linenos">667</span></a>
</span><span id="PoseTree-668"><a href="#PoseTree-668"><span class="linenos">668</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="PoseTree-669"><a href="#PoseTree-669"><span class="linenos">669</span></a>    <span class="k">def</span> <span class="nf">remove_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PoseTree-670"><a href="#PoseTree-670"><span class="linenos">670</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a static frame from the tree.&quot;&quot;&quot;</span>
</span><span id="PoseTree-671"><a href="#PoseTree-671"><span class="linenos">671</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Abstract base class to manage poses and frames.</p>

<p>To hook up this library to your project, you should subclass this class and hook it up to your stream of transforms
by implementing _get_transform. Usually this will look like adding a callback-subscribe method to your class and storing
the transforms between important frames as they come in. If you don't already have a way of interpolating between transforms,
check out ROS's tf2 library. This library is designed to wrap nicely on top of tf2, if you are already using it.</p>
</div>


                            <div id="PoseTree.get_transform" class="classattr">
                                        <input id="PoseTree.get_transform-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_transform</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">child_frame</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n"><a href="#Transform">posetree.pose.Transform</a></span>:</span></span>

                <label class="view-source-button" for="PoseTree.get_transform-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PoseTree.get_transform"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PoseTree.get_transform-592"><a href="#PoseTree.get_transform-592"><span class="linenos">592</span></a>    <span class="k">def</span> <span class="nf">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="PoseTree.get_transform-593"><a href="#PoseTree.get_transform-593"><span class="linenos">593</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transform from the parent frame to the child frame.&quot;&quot;&quot;</span>
</span><span id="PoseTree.get_transform-594"><a href="#PoseTree.get_transform-594"><span class="linenos">594</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_transform</span><span class="p">(</span><span class="n">parent_frame</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the transform from the parent frame to the child frame.</p>
</div>


                            </div>
                            <div id="PoseTree.get_pose" class="classattr">
                                        <input id="PoseTree.get_pose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_pose</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">quaternion</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>:</span></span>

                <label class="view-source-button" for="PoseTree.get_pose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PoseTree.get_pose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PoseTree.get_pose-596"><a href="#PoseTree.get_pose-596"><span class="linenos">596</span></a>    <span class="k">def</span> <span class="nf">get_pose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">quaternion</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Pose</span><span class="p">:</span>
</span><span id="PoseTree.get_pose-597"><a href="#PoseTree.get_pose-597"><span class="linenos">597</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose object from a position, quaternion, and parent frame. Essentially syntactic sugar on top of Pose&#39;s constructor.&quot;&quot;&quot;</span>
</span><span id="PoseTree.get_pose-598"><a href="#PoseTree.get_pose-598"><span class="linenos">598</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">Transform</span><span class="o">.</span><span class="n">from_position_and_quaternion</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">quaternion</span><span class="p">),</span> <span class="n">parent_frame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a pose object from a position, quaternion, and parent frame. Essentially syntactic sugar on top of Pose's constructor.</p>
</div>


                            </div>
                            <div id="PoseTree.temporary_frame" class="classattr">
                                        <input id="PoseTree.temporary_frame-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@contextmanager</div>

        <span class="def">def</span>
        <span class="name">temporary_frame</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pose</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="PoseTree.temporary_frame-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PoseTree.temporary_frame"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PoseTree.temporary_frame-600"><a href="#PoseTree.temporary_frame-600"><span class="linenos">600</span></a>    <span class="nd">@contextmanager</span>
</span><span id="PoseTree.temporary_frame-601"><a href="#PoseTree.temporary_frame-601"><span class="linenos">601</span></a>    <span class="k">def</span> <span class="nf">temporary_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="n">Pose</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PoseTree.temporary_frame-602"><a href="#PoseTree.temporary_frame-602"><span class="linenos">602</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a temporary frame from a pose.</span>
</span><span id="PoseTree.temporary_frame-603"><a href="#PoseTree.temporary_frame-603"><span class="linenos">603</span></a><span class="sd">        </span>
</span><span id="PoseTree.temporary_frame-604"><a href="#PoseTree.temporary_frame-604"><span class="linenos">604</span></a><span class="sd">        This is intended to be used for anonymous frames for doing calculations.</span>
</span><span id="PoseTree.temporary_frame-605"><a href="#PoseTree.temporary_frame-605"><span class="linenos">605</span></a>
</span><span id="PoseTree.temporary_frame-606"><a href="#PoseTree.temporary_frame-606"><span class="linenos">606</span></a><span class="sd">        Example 1, find an approach angle that is close to the robot base:</span>
</span><span id="PoseTree.temporary_frame-607"><a href="#PoseTree.temporary_frame-607"><span class="linenos">607</span></a><span class="sd">        ```python</span>
</span><span id="PoseTree.temporary_frame-608"><a href="#PoseTree.temporary_frame-608"><span class="linenos">608</span></a><span class="sd">        for theta in np.linspace(0, 2 * np.pi, 100):</span>
</span><span id="PoseTree.temporary_frame-609"><a href="#PoseTree.temporary_frame-609"><span class="linenos">609</span></a><span class="sd">            with tree.temporary_frame(target_pose.rotate_about_z(theta)) as approach_frame:</span>
</span><span id="PoseTree.temporary_frame-610"><a href="#PoseTree.temporary_frame-610"><span class="linenos">610</span></a><span class="sd">                if abs(robot_base_pose.in_frame(approach_frame).y) &lt; 0.1:</span>
</span><span id="PoseTree.temporary_frame-611"><a href="#PoseTree.temporary_frame-611"><span class="linenos">611</span></a><span class="sd">                    return theta</span>
</span><span id="PoseTree.temporary_frame-612"><a href="#PoseTree.temporary_frame-612"><span class="linenos">612</span></a><span class="sd">        ```</span>
</span><span id="PoseTree.temporary_frame-613"><a href="#PoseTree.temporary_frame-613"><span class="linenos">613</span></a>
</span><span id="PoseTree.temporary_frame-614"><a href="#PoseTree.temporary_frame-614"><span class="linenos">614</span></a><span class="sd">        Example 2, find a person that is ready to talk to the robot:</span>
</span><span id="PoseTree.temporary_frame-615"><a href="#PoseTree.temporary_frame-615"><span class="linenos">615</span></a><span class="sd">        ```python</span>
</span><span id="PoseTree.temporary_frame-616"><a href="#PoseTree.temporary_frame-616"><span class="linenos">616</span></a><span class="sd">        for person in people:</span>
</span><span id="PoseTree.temporary_frame-617"><a href="#PoseTree.temporary_frame-617"><span class="linenos">617</span></a><span class="sd">            with tree.temporary_frame(person.head_pose) as head_frame:</span>
</span><span id="PoseTree.temporary_frame-618"><a href="#PoseTree.temporary_frame-618"><span class="linenos">618</span></a><span class="sd">            x, y, _ = robot_base_pose.in_frame(head_frame).position</span>
</span><span id="PoseTree.temporary_frame-619"><a href="#PoseTree.temporary_frame-619"><span class="linenos">619</span></a><span class="sd">                if abs(y) &lt; 0.5 and 0.5 &lt; x &lt; 1.5:</span>
</span><span id="PoseTree.temporary_frame-620"><a href="#PoseTree.temporary_frame-620"><span class="linenos">620</span></a><span class="sd">                    return person</span>
</span><span id="PoseTree.temporary_frame-621"><a href="#PoseTree.temporary_frame-621"><span class="linenos">621</span></a><span class="sd">        ```</span>
</span><span id="PoseTree.temporary_frame-622"><a href="#PoseTree.temporary_frame-622"><span class="linenos">622</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PoseTree.temporary_frame-623"><a href="#PoseTree.temporary_frame-623"><span class="linenos">623</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
</span><span id="PoseTree.temporary_frame-624"><a href="#PoseTree.temporary_frame-624"><span class="linenos">624</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_frame</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="PoseTree.temporary_frame-625"><a href="#PoseTree.temporary_frame-625"><span class="linenos">625</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PoseTree.temporary_frame-626"><a href="#PoseTree.temporary_frame-626"><span class="linenos">626</span></a>            <span class="k">yield</span> <span class="n">name</span>
</span><span id="PoseTree.temporary_frame-627"><a href="#PoseTree.temporary_frame-627"><span class="linenos">627</span></a>        <span class="k">finally</span><span class="p">:</span>
</span><span id="PoseTree.temporary_frame-628"><a href="#PoseTree.temporary_frame-628"><span class="linenos">628</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">remove_frame</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a temporary frame from a pose.</p>

<p>This is intended to be used for anonymous frames for doing calculations.</p>

<p>Example 1, find an approach angle that is close to the robot base:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">tree</span><span class="o">.</span><span class="n">temporary_frame</span><span class="p">(</span><span class="n">target_pose</span><span class="o">.</span><span class="n">rotate_about_z</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="k">as</span> <span class="n">approach_frame</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">robot_base_pose</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="n">approach_frame</span><span class="p">)</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">theta</span>
</code></pre>
</div>

<p>Example 2, find a person that is ready to talk to the robot:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">people</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">tree</span><span class="o">.</span><span class="n">temporary_frame</span><span class="p">(</span><span class="n">person</span><span class="o">.</span><span class="n">head_pose</span><span class="p">)</span> <span class="k">as</span> <span class="n">head_frame</span><span class="p">:</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">robot_base_pose</span><span class="o">.</span><span class="n">in_frame</span><span class="p">(</span><span class="n">head_frame</span><span class="p">)</span><span class="o">.</span><span class="n">position</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="mf">0.5</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">1.5</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">person</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="PoseTree.add_frame" class="classattr">
                                        <input id="PoseTree.add_frame-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">add_frame</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pose</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PoseTree.add_frame-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PoseTree.add_frame"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PoseTree.add_frame-641"><a href="#PoseTree.add_frame-641"><span class="linenos">641</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="PoseTree.add_frame-642"><a href="#PoseTree.add_frame-642"><span class="linenos">642</span></a>    <span class="k">def</span> <span class="nf">add_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="n">Pose</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PoseTree.add_frame-643"><a href="#PoseTree.add_frame-643"><span class="linenos">643</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a static frame to the tree.</span>
</span><span id="PoseTree.add_frame-644"><a href="#PoseTree.add_frame-644"><span class="linenos">644</span></a>
</span><span id="PoseTree.add_frame-645"><a href="#PoseTree.add_frame-645"><span class="linenos">645</span></a><span class="sd">        Example:</span>
</span><span id="PoseTree.add_frame-646"><a href="#PoseTree.add_frame-646"><span class="linenos">646</span></a><span class="sd">        ```python</span>
</span><span id="PoseTree.add_frame-647"><a href="#PoseTree.add_frame-647"><span class="linenos">647</span></a><span class="sd">        pose_tree.add_frame(table_corner_pose, &#39;table_frame&#39;)</span>
</span><span id="PoseTree.add_frame-648"><a href="#PoseTree.add_frame-648"><span class="linenos">648</span></a>
</span><span id="PoseTree.add_frame-649"><a href="#PoseTree.add_frame-649"><span class="linenos">649</span></a><span class="sd">        # Look at center of table:</span>
</span><span id="PoseTree.add_frame-650"><a href="#PoseTree.add_frame-650"><span class="linenos">650</span></a><span class="sd">        robot.look_at(</span>
</span><span id="PoseTree.add_frame-651"><a href="#PoseTree.add_frame-651"><span class="linenos">651</span></a><span class="sd">            Pose.from_position_and_rotation(</span>
</span><span id="PoseTree.add_frame-652"><a href="#PoseTree.add_frame-652"><span class="linenos">652</span></a><span class="sd">                [table_size_x / 2, tablesize_y_y / 2, 0],</span>
</span><span id="PoseTree.add_frame-653"><a href="#PoseTree.add_frame-653"><span class="linenos">653</span></a><span class="sd">                Rotation.identity(),</span>
</span><span id="PoseTree.add_frame-654"><a href="#PoseTree.add_frame-654"><span class="linenos">654</span></a><span class="sd">                &#39;table_frame&#39;))</span>
</span><span id="PoseTree.add_frame-655"><a href="#PoseTree.add_frame-655"><span class="linenos">655</span></a><span class="sd">        ```</span>
</span><span id="PoseTree.add_frame-656"><a href="#PoseTree.add_frame-656"><span class="linenos">656</span></a>
</span><span id="PoseTree.add_frame-657"><a href="#PoseTree.add_frame-657"><span class="linenos">657</span></a><span class="sd">        Don&#39;t use this for scratch frames for doing calculations. Use the temporary_frame context manager instead. This should </span>
</span><span id="PoseTree.add_frame-658"><a href="#PoseTree.add_frame-658"><span class="linenos">658</span></a><span class="sd">        be used for permanant, human meaningful things like a workspace frame.</span>
</span><span id="PoseTree.add_frame-659"><a href="#PoseTree.add_frame-659"><span class="linenos">659</span></a>
</span><span id="PoseTree.add_frame-660"><a href="#PoseTree.add_frame-660"><span class="linenos">660</span></a><span class="sd">        This is also not a good solution for frames that are moving, as the frames will not be interpolated to particular timestamps.</span>
</span><span id="PoseTree.add_frame-661"><a href="#PoseTree.add_frame-661"><span class="linenos">661</span></a><span class="sd">        </span>
</span><span id="PoseTree.add_frame-662"><a href="#PoseTree.add_frame-662"><span class="linenos">662</span></a><span class="sd">        Args:</span>
</span><span id="PoseTree.add_frame-663"><a href="#PoseTree.add_frame-663"><span class="linenos">663</span></a><span class="sd">            pose: The pose of the new frame relative to the parent frame.</span>
</span><span id="PoseTree.add_frame-664"><a href="#PoseTree.add_frame-664"><span class="linenos">664</span></a><span class="sd">            name: The name of the new frame.</span>
</span><span id="PoseTree.add_frame-665"><a href="#PoseTree.add_frame-665"><span class="linenos">665</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PoseTree.add_frame-666"><a href="#PoseTree.add_frame-666"><span class="linenos">666</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Add a static frame to the tree.</p>

<p>Example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">pose_tree</span><span class="o">.</span><span class="n">add_frame</span><span class="p">(</span><span class="n">table_corner_pose</span><span class="p">,</span> <span class="s1">&#39;table_frame&#39;</span><span class="p">)</span>

<span class="c1"># Look at center of table:</span>
<span class="n">robot</span><span class="o">.</span><span class="n">look_at</span><span class="p">(</span>
    <span class="n"><a href="#Pose.from_position_and_rotation">Pose.from_position_and_rotation</a></span><span class="p">(</span>
        <span class="p">[</span><span class="n">table_size_x</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">tablesize_y_y</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">Rotation</span><span class="o">.</span><span class="n">identity</span><span class="p">(),</span>
        <span class="s1">&#39;table_frame&#39;</span><span class="p">))</span>
</code></pre>
</div>

<p>Don't use this for scratch frames for doing calculations. Use the temporary_frame context manager instead. This should 
be used for permanant, human meaningful things like a workspace frame.</p>

<p>This is also not a good solution for frames that are moving, as the frames will not be interpolated to particular timestamps.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>pose:</strong>  The pose of the new frame relative to the parent frame.</li>
<li><strong>name:</strong>  The name of the new frame.</li>
</ul>
</div>


                            </div>
                            <div id="PoseTree.remove_frame" class="classattr">
                                        <input id="PoseTree.remove_frame-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">remove_frame</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PoseTree.remove_frame-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PoseTree.remove_frame"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PoseTree.remove_frame-668"><a href="#PoseTree.remove_frame-668"><span class="linenos">668</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="PoseTree.remove_frame-669"><a href="#PoseTree.remove_frame-669"><span class="linenos">669</span></a>    <span class="k">def</span> <span class="nf">remove_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PoseTree.remove_frame-670"><a href="#PoseTree.remove_frame-670"><span class="linenos">670</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a static frame from the tree.&quot;&quot;&quot;</span>
</span><span id="PoseTree.remove_frame-671"><a href="#PoseTree.remove_frame-671"><span class="linenos">671</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Remove a static frame from the tree.</p>
</div>


                            </div>
                </section>
                <section id="CustomFramePoseTree">
                            <input id="CustomFramePoseTree-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CustomFramePoseTree</span><wbr>(<span class="base"><a href="#PoseTree">PoseTree</a></span>, <span class="base">abc.ABC</span>):

                <label class="view-source-button" for="CustomFramePoseTree-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CustomFramePoseTree"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CustomFramePoseTree-674"><a href="#CustomFramePoseTree-674"><span class="linenos">674</span></a><span class="k">class</span> <span class="nc">CustomFramePoseTree</span><span class="p">(</span><span class="n">PoseTree</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
</span><span id="CustomFramePoseTree-675"><a href="#CustomFramePoseTree-675"><span class="linenos">675</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A abstract PoseTree implementation that implements custom frames.</span>
</span><span id="CustomFramePoseTree-676"><a href="#CustomFramePoseTree-676"><span class="linenos">676</span></a><span class="sd">    </span>
</span><span id="CustomFramePoseTree-677"><a href="#CustomFramePoseTree-677"><span class="linenos">677</span></a><span class="sd">    This is useful if your underlying pose structure doesn&#39;t support custom frames. You subclass this</span>
</span><span id="CustomFramePoseTree-678"><a href="#CustomFramePoseTree-678"><span class="linenos">678</span></a><span class="sd">    class and implement the _get_transform method and get full custom frame support. In a pinch you can implement</span>
</span><span id="CustomFramePoseTree-679"><a href="#CustomFramePoseTree-679"><span class="linenos">679</span></a><span class="sd">    _get_transform to raise a NotImplemented error and use &#39;add frame&#39; but it is not particularly efficient and does</span>
</span><span id="CustomFramePoseTree-680"><a href="#CustomFramePoseTree-680"><span class="linenos">680</span></a><span class="sd">    not implement interpolation to particular timestamps, which will cause problems if you are getting sensor</span>
</span><span id="CustomFramePoseTree-681"><a href="#CustomFramePoseTree-681"><span class="linenos">681</span></a><span class="sd">    information off a moving robot.</span>
</span><span id="CustomFramePoseTree-682"><a href="#CustomFramePoseTree-682"><span class="linenos">682</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CustomFramePoseTree-683"><a href="#CustomFramePoseTree-683"><span class="linenos">683</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CustomFramePoseTree-684"><a href="#CustomFramePoseTree-684"><span class="linenos">684</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CustomFramePoseTree-685"><a href="#CustomFramePoseTree-685"><span class="linenos">685</span></a>
</span><span id="CustomFramePoseTree-686"><a href="#CustomFramePoseTree-686"><span class="linenos">686</span></a>    <span class="k">def</span> <span class="nf">add_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="n">Pose</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CustomFramePoseTree-687"><a href="#CustomFramePoseTree-687"><span class="linenos">687</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a frame to the tree. This is assumed to be a static frame, and will not be interpolated.</span>
</span><span id="CustomFramePoseTree-688"><a href="#CustomFramePoseTree-688"><span class="linenos">688</span></a>
</span><span id="CustomFramePoseTree-689"><a href="#CustomFramePoseTree-689"><span class="linenos">689</span></a><span class="sd">        If that frame is already present, this will update the frame to a new pose.</span>
</span><span id="CustomFramePoseTree-690"><a href="#CustomFramePoseTree-690"><span class="linenos">690</span></a>
</span><span id="CustomFramePoseTree-691"><a href="#CustomFramePoseTree-691"><span class="linenos">691</span></a><span class="sd">        Args:</span>
</span><span id="CustomFramePoseTree-692"><a href="#CustomFramePoseTree-692"><span class="linenos">692</span></a><span class="sd">            pose: The pose of the new frame relative to the parent frame.</span>
</span><span id="CustomFramePoseTree-693"><a href="#CustomFramePoseTree-693"><span class="linenos">693</span></a><span class="sd">            name: The name of the new frame.</span>
</span><span id="CustomFramePoseTree-694"><a href="#CustomFramePoseTree-694"><span class="linenos">694</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomFramePoseTree-695"><a href="#CustomFramePoseTree-695"><span class="linenos">695</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pose</span>
</span><span id="CustomFramePoseTree-696"><a href="#CustomFramePoseTree-696"><span class="linenos">696</span></a>
</span><span id="CustomFramePoseTree-697"><a href="#CustomFramePoseTree-697"><span class="linenos">697</span></a>    <span class="k">def</span> <span class="nf">remove_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CustomFramePoseTree-698"><a href="#CustomFramePoseTree-698"><span class="linenos">698</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a custom frame from the tree.</span>
</span><span id="CustomFramePoseTree-699"><a href="#CustomFramePoseTree-699"><span class="linenos">699</span></a><span class="sd">        </span>
</span><span id="CustomFramePoseTree-700"><a href="#CustomFramePoseTree-700"><span class="linenos">700</span></a><span class="sd">        This method is idempotent. If the frame is not present, it will do nothing.</span>
</span><span id="CustomFramePoseTree-701"><a href="#CustomFramePoseTree-701"><span class="linenos">701</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomFramePoseTree-702"><a href="#CustomFramePoseTree-702"><span class="linenos">702</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">:</span>
</span><span id="CustomFramePoseTree-703"><a href="#CustomFramePoseTree-703"><span class="linenos">703</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</span><span id="CustomFramePoseTree-704"><a href="#CustomFramePoseTree-704"><span class="linenos">704</span></a>
</span><span id="CustomFramePoseTree-705"><a href="#CustomFramePoseTree-705"><span class="linenos">705</span></a>    <span class="k">def</span> <span class="nf">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="CustomFramePoseTree-706"><a href="#CustomFramePoseTree-706"><span class="linenos">706</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transform from the parent frame to the child frame, at the timestamp.&quot;&quot;&quot;</span>
</span><span id="CustomFramePoseTree-707"><a href="#CustomFramePoseTree-707"><span class="linenos">707</span></a>        <span class="k">if</span> <span class="n">child_frame</span> <span class="o">==</span> <span class="n">parent_frame</span><span class="p">:</span>
</span><span id="CustomFramePoseTree-708"><a href="#CustomFramePoseTree-708"><span class="linenos">708</span></a>            <span class="k">return</span> <span class="n">Transform</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
</span><span id="CustomFramePoseTree-709"><a href="#CustomFramePoseTree-709"><span class="linenos">709</span></a>        <span class="k">if</span> <span class="n">child_frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">:</span>
</span><span id="CustomFramePoseTree-710"><a href="#CustomFramePoseTree-710"><span class="linenos">710</span></a>            <span class="n">child_root_pose_child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">[</span><span class="n">child_frame</span><span class="p">]</span>
</span><span id="CustomFramePoseTree-711"><a href="#CustomFramePoseTree-711"><span class="linenos">711</span></a>            <span class="n">parent_t_child_root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">parent_frame</span><span class="p">,</span> <span class="n">child_root_pose_child</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</span><span id="CustomFramePoseTree-712"><a href="#CustomFramePoseTree-712"><span class="linenos">712</span></a>            <span class="k">return</span> <span class="n">parent_t_child_root</span> <span class="o">*</span> <span class="n">child_root_pose_child</span><span class="o">.</span><span class="n">transform</span>
</span><span id="CustomFramePoseTree-713"><a href="#CustomFramePoseTree-713"><span class="linenos">713</span></a>        <span class="k">elif</span> <span class="n">parent_frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">:</span>
</span><span id="CustomFramePoseTree-714"><a href="#CustomFramePoseTree-714"><span class="linenos">714</span></a>            <span class="n">parent_root_pose_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">[</span><span class="n">parent_frame</span><span class="p">]</span>
</span><span id="CustomFramePoseTree-715"><a href="#CustomFramePoseTree-715"><span class="linenos">715</span></a>            <span class="n">parent_root_t_child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">parent_root_pose_parent</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</span><span id="CustomFramePoseTree-716"><a href="#CustomFramePoseTree-716"><span class="linenos">716</span></a>            <span class="n">parent_t_parent_root</span> <span class="o">=</span> <span class="n">parent_root_pose_parent</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">inverse</span>
</span><span id="CustomFramePoseTree-717"><a href="#CustomFramePoseTree-717"><span class="linenos">717</span></a>            <span class="k">return</span> <span class="n">parent_t_parent_root</span> <span class="o">*</span> <span class="n">parent_root_t_child</span>
</span><span id="CustomFramePoseTree-718"><a href="#CustomFramePoseTree-718"><span class="linenos">718</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CustomFramePoseTree-719"><a href="#CustomFramePoseTree-719"><span class="linenos">719</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_transform</span><span class="p">(</span><span class="n">parent_frame</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</span><span id="CustomFramePoseTree-720"><a href="#CustomFramePoseTree-720"><span class="linenos">720</span></a>
</span><span id="CustomFramePoseTree-721"><a href="#CustomFramePoseTree-721"><span class="linenos">721</span></a>
</span><span id="CustomFramePoseTree-722"><a href="#CustomFramePoseTree-722"><span class="linenos">722</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="CustomFramePoseTree-723"><a href="#CustomFramePoseTree-723"><span class="linenos">723</span></a>    <span class="k">def</span> <span class="nf">_get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="CustomFramePoseTree-724"><a href="#CustomFramePoseTree-724"><span class="linenos">724</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transform from the parent frame to the child frame.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>A abstract PoseTree implementation that implements custom frames.</p>

<p>This is useful if your underlying pose structure doesn't support custom frames. You subclass this
class and implement the _get_transform method and get full custom frame support. In a pinch you can implement
_get_transform to raise a NotImplemented error and use 'add frame' but it is not particularly efficient and does
not implement interpolation to particular timestamps, which will cause problems if you are getting sensor
information off a moving robot.</p>
</div>


                            <div id="CustomFramePoseTree.custom_frames" class="classattr">
                                <div class="attr variable">
            <span class="name">custom_frames</span>

        
    </div>
    <a class="headerlink" href="#CustomFramePoseTree.custom_frames"></a>
    
    

                            </div>
                            <div id="CustomFramePoseTree.add_frame" class="classattr">
                                        <input id="CustomFramePoseTree.add_frame-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_frame</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pose</span><span class="p">:</span> <span class="n"><a href="#Pose">posetree.pose.Pose</a></span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CustomFramePoseTree.add_frame-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CustomFramePoseTree.add_frame"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CustomFramePoseTree.add_frame-686"><a href="#CustomFramePoseTree.add_frame-686"><span class="linenos">686</span></a>    <span class="k">def</span> <span class="nf">add_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="n">Pose</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CustomFramePoseTree.add_frame-687"><a href="#CustomFramePoseTree.add_frame-687"><span class="linenos">687</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a frame to the tree. This is assumed to be a static frame, and will not be interpolated.</span>
</span><span id="CustomFramePoseTree.add_frame-688"><a href="#CustomFramePoseTree.add_frame-688"><span class="linenos">688</span></a>
</span><span id="CustomFramePoseTree.add_frame-689"><a href="#CustomFramePoseTree.add_frame-689"><span class="linenos">689</span></a><span class="sd">        If that frame is already present, this will update the frame to a new pose.</span>
</span><span id="CustomFramePoseTree.add_frame-690"><a href="#CustomFramePoseTree.add_frame-690"><span class="linenos">690</span></a>
</span><span id="CustomFramePoseTree.add_frame-691"><a href="#CustomFramePoseTree.add_frame-691"><span class="linenos">691</span></a><span class="sd">        Args:</span>
</span><span id="CustomFramePoseTree.add_frame-692"><a href="#CustomFramePoseTree.add_frame-692"><span class="linenos">692</span></a><span class="sd">            pose: The pose of the new frame relative to the parent frame.</span>
</span><span id="CustomFramePoseTree.add_frame-693"><a href="#CustomFramePoseTree.add_frame-693"><span class="linenos">693</span></a><span class="sd">            name: The name of the new frame.</span>
</span><span id="CustomFramePoseTree.add_frame-694"><a href="#CustomFramePoseTree.add_frame-694"><span class="linenos">694</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomFramePoseTree.add_frame-695"><a href="#CustomFramePoseTree.add_frame-695"><span class="linenos">695</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pose</span>
</span></pre></div>


            <div class="docstring"><p>Add a frame to the tree. This is assumed to be a static frame, and will not be interpolated.</p>

<p>If that frame is already present, this will update the frame to a new pose.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>pose:</strong>  The pose of the new frame relative to the parent frame.</li>
<li><strong>name:</strong>  The name of the new frame.</li>
</ul>
</div>


                            </div>
                            <div id="CustomFramePoseTree.remove_frame" class="classattr">
                                        <input id="CustomFramePoseTree.remove_frame-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_frame</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CustomFramePoseTree.remove_frame-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CustomFramePoseTree.remove_frame"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CustomFramePoseTree.remove_frame-697"><a href="#CustomFramePoseTree.remove_frame-697"><span class="linenos">697</span></a>    <span class="k">def</span> <span class="nf">remove_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CustomFramePoseTree.remove_frame-698"><a href="#CustomFramePoseTree.remove_frame-698"><span class="linenos">698</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a custom frame from the tree.</span>
</span><span id="CustomFramePoseTree.remove_frame-699"><a href="#CustomFramePoseTree.remove_frame-699"><span class="linenos">699</span></a><span class="sd">        </span>
</span><span id="CustomFramePoseTree.remove_frame-700"><a href="#CustomFramePoseTree.remove_frame-700"><span class="linenos">700</span></a><span class="sd">        This method is idempotent. If the frame is not present, it will do nothing.</span>
</span><span id="CustomFramePoseTree.remove_frame-701"><a href="#CustomFramePoseTree.remove_frame-701"><span class="linenos">701</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomFramePoseTree.remove_frame-702"><a href="#CustomFramePoseTree.remove_frame-702"><span class="linenos">702</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">:</span>
</span><span id="CustomFramePoseTree.remove_frame-703"><a href="#CustomFramePoseTree.remove_frame-703"><span class="linenos">703</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Remove a custom frame from the tree.</p>

<p>This method is idempotent. If the frame is not present, it will do nothing.</p>
</div>


                            </div>
                            <div id="CustomFramePoseTree.get_transform" class="classattr">
                                        <input id="CustomFramePoseTree.get_transform-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_transform</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">child_frame</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Transform">posetree.pose.Transform</a></span>:</span></span>

                <label class="view-source-button" for="CustomFramePoseTree.get_transform-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CustomFramePoseTree.get_transform"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CustomFramePoseTree.get_transform-705"><a href="#CustomFramePoseTree.get_transform-705"><span class="linenos">705</span></a>    <span class="k">def</span> <span class="nf">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="CustomFramePoseTree.get_transform-706"><a href="#CustomFramePoseTree.get_transform-706"><span class="linenos">706</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transform from the parent frame to the child frame, at the timestamp.&quot;&quot;&quot;</span>
</span><span id="CustomFramePoseTree.get_transform-707"><a href="#CustomFramePoseTree.get_transform-707"><span class="linenos">707</span></a>        <span class="k">if</span> <span class="n">child_frame</span> <span class="o">==</span> <span class="n">parent_frame</span><span class="p">:</span>
</span><span id="CustomFramePoseTree.get_transform-708"><a href="#CustomFramePoseTree.get_transform-708"><span class="linenos">708</span></a>            <span class="k">return</span> <span class="n">Transform</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
</span><span id="CustomFramePoseTree.get_transform-709"><a href="#CustomFramePoseTree.get_transform-709"><span class="linenos">709</span></a>        <span class="k">if</span> <span class="n">child_frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">:</span>
</span><span id="CustomFramePoseTree.get_transform-710"><a href="#CustomFramePoseTree.get_transform-710"><span class="linenos">710</span></a>            <span class="n">child_root_pose_child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">[</span><span class="n">child_frame</span><span class="p">]</span>
</span><span id="CustomFramePoseTree.get_transform-711"><a href="#CustomFramePoseTree.get_transform-711"><span class="linenos">711</span></a>            <span class="n">parent_t_child_root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">parent_frame</span><span class="p">,</span> <span class="n">child_root_pose_child</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</span><span id="CustomFramePoseTree.get_transform-712"><a href="#CustomFramePoseTree.get_transform-712"><span class="linenos">712</span></a>            <span class="k">return</span> <span class="n">parent_t_child_root</span> <span class="o">*</span> <span class="n">child_root_pose_child</span><span class="o">.</span><span class="n">transform</span>
</span><span id="CustomFramePoseTree.get_transform-713"><a href="#CustomFramePoseTree.get_transform-713"><span class="linenos">713</span></a>        <span class="k">elif</span> <span class="n">parent_frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">:</span>
</span><span id="CustomFramePoseTree.get_transform-714"><a href="#CustomFramePoseTree.get_transform-714"><span class="linenos">714</span></a>            <span class="n">parent_root_pose_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_frames</span><span class="p">[</span><span class="n">parent_frame</span><span class="p">]</span>
</span><span id="CustomFramePoseTree.get_transform-715"><a href="#CustomFramePoseTree.get_transform-715"><span class="linenos">715</span></a>            <span class="n">parent_root_t_child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">parent_root_pose_parent</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</span><span id="CustomFramePoseTree.get_transform-716"><a href="#CustomFramePoseTree.get_transform-716"><span class="linenos">716</span></a>            <span class="n">parent_t_parent_root</span> <span class="o">=</span> <span class="n">parent_root_pose_parent</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">inverse</span>
</span><span id="CustomFramePoseTree.get_transform-717"><a href="#CustomFramePoseTree.get_transform-717"><span class="linenos">717</span></a>            <span class="k">return</span> <span class="n">parent_t_parent_root</span> <span class="o">*</span> <span class="n">parent_root_t_child</span>
</span><span id="CustomFramePoseTree.get_transform-718"><a href="#CustomFramePoseTree.get_transform-718"><span class="linenos">718</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CustomFramePoseTree.get_transform-719"><a href="#CustomFramePoseTree.get_transform-719"><span class="linenos">719</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_transform</span><span class="p">(</span><span class="n">parent_frame</span><span class="p">,</span> <span class="n">child_frame</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the transform from the parent frame to the child frame, at the timestamp.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#PoseTree">PoseTree</a></dt>
                                <dd id="CustomFramePoseTree.get_pose" class="function"><a href="#PoseTree.get_pose">get_pose</a></dd>
                <dd id="CustomFramePoseTree.temporary_frame" class="function"><a href="#PoseTree.temporary_frame">temporary_frame</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Transform">
                            <input id="Transform-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Transform</span>:

                <label class="view-source-button" for="Transform-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transform"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transform-727"><a href="#Transform-727"><span class="linenos">727</span></a><span class="k">class</span> <span class="nc">Transform</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="Transform-728"><a href="#Transform-728"><span class="linenos">728</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A homogenous transform from a pose or frame to another location and rotation.</span>
</span><span id="Transform-729"><a href="#Transform-729"><span class="linenos">729</span></a><span class="sd">    </span>
</span><span id="Transform-730"><a href="#Transform-730"><span class="linenos">730</span></a><span class="sd">    In posetree, a Transform is a verb. It describes how to transform a pose from one frame to another.</span>
</span><span id="Transform-731"><a href="#Transform-731"><span class="linenos">731</span></a><span class="sd">    Almost all the time, you want to turn your raw data objects (coming from forward kinematics or perception or </span>
</span><span id="Transform-732"><a href="#Transform-732"><span class="linenos">732</span></a><span class="sd">    localization) into a Pose object as soon as possible, and only go through Transforms at the borders of your sdk.</span>
</span><span id="Transform-733"><a href="#Transform-733"><span class="linenos">733</span></a>
</span><span id="Transform-734"><a href="#Transform-734"><span class="linenos">734</span></a><span class="sd">    Using Transform objects instead of Pose objects is usually a code smell, unless you&#39;re doing something really</span>
</span><span id="Transform-735"><a href="#Transform-735"><span class="linenos">735</span></a><span class="sd">    mathy with a bunch of intermediate transforms.</span>
</span><span id="Transform-736"><a href="#Transform-736"><span class="linenos">736</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Transform-737"><a href="#Transform-737"><span class="linenos">737</span></a>
</span><span id="Transform-738"><a href="#Transform-738"><span class="linenos">738</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">rotation</span><span class="p">:</span> <span class="n">Rotation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Transform-739"><a href="#Transform-739"><span class="linenos">739</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a transform from a position and rotation.</span>
</span><span id="Transform-740"><a href="#Transform-740"><span class="linenos">740</span></a><span class="sd">        </span>
</span><span id="Transform-741"><a href="#Transform-741"><span class="linenos">741</span></a><span class="sd">        Args:</span>
</span><span id="Transform-742"><a href="#Transform-742"><span class="linenos">742</span></a><span class="sd">            position: The position of the transform.</span>
</span><span id="Transform-743"><a href="#Transform-743"><span class="linenos">743</span></a><span class="sd">            rotation: The rotation of the transform.</span>
</span><span id="Transform-744"><a href="#Transform-744"><span class="linenos">744</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform-745"><a href="#Transform-745"><span class="linenos">745</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</span><span id="Transform-746"><a href="#Transform-746"><span class="linenos">746</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="n">rotation</span>
</span><span id="Transform-747"><a href="#Transform-747"><span class="linenos">747</span></a>
</span><span id="Transform-748"><a href="#Transform-748"><span class="linenos">748</span></a>    <span class="nd">@classmethod</span>
</span><span id="Transform-749"><a href="#Transform-749"><span class="linenos">749</span></a>    <span class="k">def</span> <span class="nf">from_position_and_quaternion</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">quaternion</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="Transform-750"><a href="#Transform-750"><span class="linenos">750</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a transform from a position and quaternion.</span>
</span><span id="Transform-751"><a href="#Transform-751"><span class="linenos">751</span></a><span class="sd">        </span>
</span><span id="Transform-752"><a href="#Transform-752"><span class="linenos">752</span></a><span class="sd">        Args:</span>
</span><span id="Transform-753"><a href="#Transform-753"><span class="linenos">753</span></a><span class="sd">            position: The position of the transform.</span>
</span><span id="Transform-754"><a href="#Transform-754"><span class="linenos">754</span></a><span class="sd">            quaternion: The quaternion of the transform, in xyzw order.</span>
</span><span id="Transform-755"><a href="#Transform-755"><span class="linenos">755</span></a><span class="sd">        </span>
</span><span id="Transform-756"><a href="#Transform-756"><span class="linenos">756</span></a><span class="sd">        Returns:</span>
</span><span id="Transform-757"><a href="#Transform-757"><span class="linenos">757</span></a><span class="sd">            A new transform.</span>
</span><span id="Transform-758"><a href="#Transform-758"><span class="linenos">758</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform-759"><a href="#Transform-759"><span class="linenos">759</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">quaternion</span><span class="p">))</span>
</span><span id="Transform-760"><a href="#Transform-760"><span class="linenos">760</span></a>
</span><span id="Transform-761"><a href="#Transform-761"><span class="linenos">761</span></a>    <span class="nd">@classmethod</span>
</span><span id="Transform-762"><a href="#Transform-762"><span class="linenos">762</span></a>    <span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="Transform-763"><a href="#Transform-763"><span class="linenos">763</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the identity transform.&quot;&quot;&quot;</span>
</span><span id="Transform-764"><a href="#Transform-764"><span class="linenos">764</span></a>        <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">identity</span><span class="p">())</span>
</span><span id="Transform-765"><a href="#Transform-765"><span class="linenos">765</span></a>
</span><span id="Transform-766"><a href="#Transform-766"><span class="linenos">766</span></a>    <span class="nd">@property</span>
</span><span id="Transform-767"><a href="#Transform-767"><span class="linenos">767</span></a>    <span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="Transform-768"><a href="#Transform-768"><span class="linenos">768</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The inverse of the transform.</span>
</span><span id="Transform-769"><a href="#Transform-769"><span class="linenos">769</span></a><span class="sd">        </span>
</span><span id="Transform-770"><a href="#Transform-770"><span class="linenos">770</span></a><span class="sd">        How to get back from applying this transform.</span>
</span><span id="Transform-771"><a href="#Transform-771"><span class="linenos">771</span></a>
</span><span id="Transform-772"><a href="#Transform-772"><span class="linenos">772</span></a><span class="sd">        t1 * t1.inverse == Transform.identity()</span>
</span><span id="Transform-773"><a href="#Transform-773"><span class="linenos">773</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform-774"><a href="#Transform-774"><span class="linenos">774</span></a>        <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">inv</span><span class="p">())</span>
</span><span id="Transform-775"><a href="#Transform-775"><span class="linenos">775</span></a>
</span><span id="Transform-776"><a href="#Transform-776"><span class="linenos">776</span></a>    <span class="nd">@property</span>
</span><span id="Transform-777"><a href="#Transform-777"><span class="linenos">777</span></a>    <span class="k">def</span> <span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Transform-778"><a href="#Transform-778"><span class="linenos">778</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The 1x3 cartesian position of the transform.&quot;&quot;&quot;</span>
</span><span id="Transform-779"><a href="#Transform-779"><span class="linenos">779</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span>
</span><span id="Transform-780"><a href="#Transform-780"><span class="linenos">780</span></a>    
</span><span id="Transform-781"><a href="#Transform-781"><span class="linenos">781</span></a>    <span class="nd">@property</span>
</span><span id="Transform-782"><a href="#Transform-782"><span class="linenos">782</span></a>    <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rotation</span><span class="p">:</span>
</span><span id="Transform-783"><a href="#Transform-783"><span class="linenos">783</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The rotation component of the transform.&quot;&quot;&quot;</span>
</span><span id="Transform-784"><a href="#Transform-784"><span class="linenos">784</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span>
</span><span id="Transform-785"><a href="#Transform-785"><span class="linenos">785</span></a>    
</span><span id="Transform-786"><a href="#Transform-786"><span class="linenos">786</span></a>    <span class="nd">@property</span>
</span><span id="Transform-787"><a href="#Transform-787"><span class="linenos">787</span></a>    <span class="k">def</span> <span class="nf">x_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Transform-788"><a href="#Transform-788"><span class="linenos">788</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The x axis of the transform.</span>
</span><span id="Transform-789"><a href="#Transform-789"><span class="linenos">789</span></a><span class="sd">        </span>
</span><span id="Transform-790"><a href="#Transform-790"><span class="linenos">790</span></a><span class="sd">        This is the unit vector, in the parent frame, pointing in the new x direction, after applying the transform.</span>
</span><span id="Transform-791"><a href="#Transform-791"><span class="linenos">791</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform-792"><a href="#Transform-792"><span class="linenos">792</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="Transform-793"><a href="#Transform-793"><span class="linenos">793</span></a>    
</span><span id="Transform-794"><a href="#Transform-794"><span class="linenos">794</span></a>    <span class="nd">@property</span>
</span><span id="Transform-795"><a href="#Transform-795"><span class="linenos">795</span></a>    <span class="k">def</span> <span class="nf">y_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Transform-796"><a href="#Transform-796"><span class="linenos">796</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The y axis of the transform.</span>
</span><span id="Transform-797"><a href="#Transform-797"><span class="linenos">797</span></a><span class="sd">        </span>
</span><span id="Transform-798"><a href="#Transform-798"><span class="linenos">798</span></a><span class="sd">        This is the unit vector, in the parent frame, pointing in the new y direction, after applying the transform.</span>
</span><span id="Transform-799"><a href="#Transform-799"><span class="linenos">799</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform-800"><a href="#Transform-800"><span class="linenos">800</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="Transform-801"><a href="#Transform-801"><span class="linenos">801</span></a>    
</span><span id="Transform-802"><a href="#Transform-802"><span class="linenos">802</span></a>    <span class="nd">@property</span>
</span><span id="Transform-803"><a href="#Transform-803"><span class="linenos">803</span></a>    <span class="k">def</span> <span class="nf">z_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Transform-804"><a href="#Transform-804"><span class="linenos">804</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The z axis of the transform.</span>
</span><span id="Transform-805"><a href="#Transform-805"><span class="linenos">805</span></a><span class="sd">                </span>
</span><span id="Transform-806"><a href="#Transform-806"><span class="linenos">806</span></a><span class="sd">        This is the unit vector, in the parent frame, pointing in the new z direction, after applying the transform.</span>
</span><span id="Transform-807"><a href="#Transform-807"><span class="linenos">807</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform-808"><a href="#Transform-808"><span class="linenos">808</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span> 
</span><span id="Transform-809"><a href="#Transform-809"><span class="linenos">809</span></a>    
</span><span id="Transform-810"><a href="#Transform-810"><span class="linenos">810</span></a>    <span class="nd">@property</span>
</span><span id="Transform-811"><a href="#Transform-811"><span class="linenos">811</span></a>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Transform-812"><a href="#Transform-812"><span class="linenos">812</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The x coordinate of the transform.&quot;&quot;&quot;</span>
</span><span id="Transform-813"><a href="#Transform-813"><span class="linenos">813</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Transform-814"><a href="#Transform-814"><span class="linenos">814</span></a>    
</span><span id="Transform-815"><a href="#Transform-815"><span class="linenos">815</span></a>    <span class="nd">@property</span>
</span><span id="Transform-816"><a href="#Transform-816"><span class="linenos">816</span></a>    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Transform-817"><a href="#Transform-817"><span class="linenos">817</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The y coordinate of the transform.&quot;&quot;&quot;</span>
</span><span id="Transform-818"><a href="#Transform-818"><span class="linenos">818</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Transform-819"><a href="#Transform-819"><span class="linenos">819</span></a>    
</span><span id="Transform-820"><a href="#Transform-820"><span class="linenos">820</span></a>    <span class="nd">@property</span>
</span><span id="Transform-821"><a href="#Transform-821"><span class="linenos">821</span></a>    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Transform-822"><a href="#Transform-822"><span class="linenos">822</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The z coordinate of the transform.&quot;&quot;&quot;</span>
</span><span id="Transform-823"><a href="#Transform-823"><span class="linenos">823</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Transform-824"><a href="#Transform-824"><span class="linenos">824</span></a>    
</span><span id="Transform-825"><a href="#Transform-825"><span class="linenos">825</span></a>    <span class="k">def</span> <span class="nf">to_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Transform-826"><a href="#Transform-826"><span class="linenos">826</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the 4x4 matrix representation of the transform.&quot;&quot;&quot;</span>
</span><span id="Transform-827"><a href="#Transform-827"><span class="linenos">827</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="Transform-828"><a href="#Transform-828"><span class="linenos">828</span></a>        <span class="n">matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
</span><span id="Transform-829"><a href="#Transform-829"><span class="linenos">829</span></a>        <span class="n">matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
</span><span id="Transform-830"><a href="#Transform-830"><span class="linenos">830</span></a>        <span class="k">return</span> <span class="n">matrix</span>
</span><span id="Transform-831"><a href="#Transform-831"><span class="linenos">831</span></a>    
</span><span id="Transform-832"><a href="#Transform-832"><span class="linenos">832</span></a>    <span class="nd">@classmethod</span>
</span><span id="Transform-833"><a href="#Transform-833"><span class="linenos">833</span></a>    <span class="k">def</span> <span class="nf">from_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">matrix</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="Transform-834"><a href="#Transform-834"><span class="linenos">834</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a transform from a matrix.</span>
</span><span id="Transform-835"><a href="#Transform-835"><span class="linenos">835</span></a><span class="sd">        </span>
</span><span id="Transform-836"><a href="#Transform-836"><span class="linenos">836</span></a><span class="sd">        Args:</span>
</span><span id="Transform-837"><a href="#Transform-837"><span class="linenos">837</span></a><span class="sd">            matrix: The matrix of the transform.</span>
</span><span id="Transform-838"><a href="#Transform-838"><span class="linenos">838</span></a><span class="sd">        </span>
</span><span id="Transform-839"><a href="#Transform-839"><span class="linenos">839</span></a><span class="sd">        Returns:</span>
</span><span id="Transform-840"><a href="#Transform-840"><span class="linenos">840</span></a><span class="sd">            A new transform.</span>
</span><span id="Transform-841"><a href="#Transform-841"><span class="linenos">841</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform-842"><a href="#Transform-842"><span class="linenos">842</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</span><span id="Transform-843"><a href="#Transform-843"><span class="linenos">843</span></a>        <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="n">matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]))</span>
</span><span id="Transform-844"><a href="#Transform-844"><span class="linenos">844</span></a>
</span><span id="Transform-845"><a href="#Transform-845"><span class="linenos">845</span></a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Transform&quot;</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="Transform-846"><a href="#Transform-846"><span class="linenos">846</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Multiply this transform by another transform or vector.</span>
</span><span id="Transform-847"><a href="#Transform-847"><span class="linenos">847</span></a>
</span><span id="Transform-848"><a href="#Transform-848"><span class="linenos">848</span></a><span class="sd">        If other is a transform, this is equivalent to applying this transform, then the other transform.</span>
</span><span id="Transform-849"><a href="#Transform-849"><span class="linenos">849</span></a><span class="sd">        If other is a vector, this is equivalent to applying this transform to the vector.</span>
</span><span id="Transform-850"><a href="#Transform-850"><span class="linenos">850</span></a><span class="sd">        </span>
</span><span id="Transform-851"><a href="#Transform-851"><span class="linenos">851</span></a><span class="sd">        Args:</span>
</span><span id="Transform-852"><a href="#Transform-852"><span class="linenos">852</span></a><span class="sd">            other: The transform or vector to multiply.</span>
</span><span id="Transform-853"><a href="#Transform-853"><span class="linenos">853</span></a><span class="sd">        </span>
</span><span id="Transform-854"><a href="#Transform-854"><span class="linenos">854</span></a><span class="sd">        Returns:</span>
</span><span id="Transform-855"><a href="#Transform-855"><span class="linenos">855</span></a><span class="sd">            The product of the two transforms.</span>
</span><span id="Transform-856"><a href="#Transform-856"><span class="linenos">856</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform-857"><a href="#Transform-857"><span class="linenos">857</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Transform</span><span class="p">):</span>
</span><span id="Transform-858"><a href="#Transform-858"><span class="linenos">858</span></a>          <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">position</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span>
</span><span id="Transform-859"><a href="#Transform-859"><span class="linenos">859</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Transform-860"><a href="#Transform-860"><span class="linenos">860</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="Transform-861"><a href="#Transform-861"><span class="linenos">861</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="Transform-862"><a href="#Transform-862"><span class="linenos">862</span></a>        
</span><span id="Transform-863"><a href="#Transform-863"><span class="linenos">863</span></a>    <span class="fm">__mul__</span> <span class="o">=</span> <span class="n">apply</span>
</span><span id="Transform-864"><a href="#Transform-864"><span class="linenos">864</span></a>        
</span><span id="Transform-865"><a href="#Transform-865"><span class="linenos">865</span></a>    <span class="k">def</span> <span class="nf">almost_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Transform-866"><a href="#Transform-866"><span class="linenos">866</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two transforms are almost equal.</span>
</span><span id="Transform-867"><a href="#Transform-867"><span class="linenos">867</span></a><span class="sd">        </span>
</span><span id="Transform-868"><a href="#Transform-868"><span class="linenos">868</span></a><span class="sd">        Handles floating point error in the position and rotation, and the fact that for quaternions negating </span>
</span><span id="Transform-869"><a href="#Transform-869"><span class="linenos">869</span></a><span class="sd">        the vector gives the same rotation.</span>
</span><span id="Transform-870"><a href="#Transform-870"><span class="linenos">870</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform-871"><a href="#Transform-871"><span class="linenos">871</span></a>        <span class="c1"># Check if positions are almost equal.</span>
</span><span id="Transform-872"><a href="#Transform-872"><span class="linenos">872</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_position</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_position</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="Transform-873"><a href="#Transform-873"><span class="linenos">873</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Transform-874"><a href="#Transform-874"><span class="linenos">874</span></a>        <span class="c1"># Check if rotations are almost equal.</span>
</span><span id="Transform-875"><a href="#Transform-875"><span class="linenos">875</span></a>        <span class="c1"># Since quaternion [x, y, z, w] represents the same rotation as [-x, -y, -z, -w], we also need to check the inverse quaternion.</span>
</span><span id="Transform-876"><a href="#Transform-876"><span class="linenos">876</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span><span id="Transform-877"><a href="#Transform-877"><span class="linenos">877</span></a>                <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="o">-</span><span class="n">other</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)):</span>
</span><span id="Transform-878"><a href="#Transform-878"><span class="linenos">878</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Transform-879"><a href="#Transform-879"><span class="linenos">879</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Transform-880"><a href="#Transform-880"><span class="linenos">880</span></a>    
</span><span id="Transform-881"><a href="#Transform-881"><span class="linenos">881</span></a>    <span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="Transform-882"><a href="#Transform-882"><span class="linenos">882</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Interpolate between two transforms.</span>
</span><span id="Transform-883"><a href="#Transform-883"><span class="linenos">883</span></a><span class="sd">        </span>
</span><span id="Transform-884"><a href="#Transform-884"><span class="linenos">884</span></a><span class="sd">        Args:</span>
</span><span id="Transform-885"><a href="#Transform-885"><span class="linenos">885</span></a><span class="sd">            other: The other transform to interpolate with.</span>
</span><span id="Transform-886"><a href="#Transform-886"><span class="linenos">886</span></a><span class="sd">            alpha: The interpolation factor. 0 gives this transform, 1 gives the other transform.</span>
</span><span id="Transform-887"><a href="#Transform-887"><span class="linenos">887</span></a><span class="sd">        </span>
</span><span id="Transform-888"><a href="#Transform-888"><span class="linenos">888</span></a><span class="sd">        Returns:</span>
</span><span id="Transform-889"><a href="#Transform-889"><span class="linenos">889</span></a><span class="sd">            The interpolated transform.</span>
</span><span id="Transform-890"><a href="#Transform-890"><span class="linenos">890</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform-891"><a href="#Transform-891"><span class="linenos">891</span></a>        <span class="c1"># Combine the rotations into a single Rotation object</span>
</span><span id="Transform-892"><a href="#Transform-892"><span class="linenos">892</span></a>        <span class="n">rotations</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())))</span>
</span><span id="Transform-893"><a href="#Transform-893"><span class="linenos">893</span></a>        <span class="n">slerp</span> <span class="o">=</span> <span class="n">Slerp</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">rotations</span><span class="p">)</span>    
</span><span id="Transform-894"><a href="#Transform-894"><span class="linenos">894</span></a>        <span class="n">new_rotation</span><span class="o">=</span> <span class="n">slerp</span><span class="p">([</span><span class="n">alpha</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Transform-895"><a href="#Transform-895"><span class="linenos">895</span></a>        <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">position</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">new_rotation</span><span class="p">)</span>
</span><span id="Transform-896"><a href="#Transform-896"><span class="linenos">896</span></a>    
</span><span id="Transform-897"><a href="#Transform-897"><span class="linenos">897</span></a>    <span class="k">def</span> <span class="nf">angle_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Transform-898"><a href="#Transform-898"><span class="linenos">898</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the angle between two transforms&#39; orientations. Ignores position.</span>
</span><span id="Transform-899"><a href="#Transform-899"><span class="linenos">899</span></a><span class="sd">        </span>
</span><span id="Transform-900"><a href="#Transform-900"><span class="linenos">900</span></a><span class="sd">        Args:</span>
</span><span id="Transform-901"><a href="#Transform-901"><span class="linenos">901</span></a><span class="sd">            target: The target transform.</span>
</span><span id="Transform-902"><a href="#Transform-902"><span class="linenos">902</span></a><span class="sd">        </span>
</span><span id="Transform-903"><a href="#Transform-903"><span class="linenos">903</span></a><span class="sd">        Returns:</span>
</span><span id="Transform-904"><a href="#Transform-904"><span class="linenos">904</span></a><span class="sd">            The angle between two transform, in radians.</span>
</span><span id="Transform-905"><a href="#Transform-905"><span class="linenos">905</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform-906"><a href="#Transform-906"><span class="linenos">906</span></a>        <span class="n">relative_rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span> <span class="o">*</span> <span class="n">target</span><span class="o">.</span><span class="n">rotation</span>
</span><span id="Transform-907"><a href="#Transform-907"><span class="linenos">907</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">relative_rotation</span><span class="o">.</span><span class="n">as_rotvec</span><span class="p">())</span>
</span><span id="Transform-908"><a href="#Transform-908"><span class="linenos">908</span></a>    
</span><span id="Transform-909"><a href="#Transform-909"><span class="linenos">909</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Transform-910"><a href="#Transform-910"><span class="linenos">910</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two transforms are equal.&quot;&quot;&quot;</span>
</span><span id="Transform-911"><a href="#Transform-911"><span class="linenos">911</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">almost_equal</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Transform-912"><a href="#Transform-912"><span class="linenos">912</span></a>
</span><span id="Transform-913"><a href="#Transform-913"><span class="linenos">913</span></a>    
</span><span id="Transform-914"><a href="#Transform-914"><span class="linenos">914</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Transform-915"><a href="#Transform-915"><span class="linenos">915</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Transform(position=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="si">}</span><span class="s2">, rotation=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Transform-916"><a href="#Transform-916"><span class="linenos">916</span></a>    <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span>
</span></pre></div>


            <div class="docstring"><p>A homogenous transform from a pose or frame to another location and rotation.</p>

<p>In posetree, a Transform is a verb. It describes how to transform a pose from one frame to another.
Almost all the time, you want to turn your raw data objects (coming from forward kinematics or perception or 
localization) into a Pose object as soon as possible, and only go through Transforms at the borders of your sdk.</p>

<p>Using Transform objects instead of Pose objects is usually a code smell, unless you're doing something really
mathy with a bunch of intermediate transforms.</p>
</div>


                            <div id="Transform.__init__" class="classattr">
                                        <input id="Transform.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Transform</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">rotation</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">Rotation</span></span>)</span>

                <label class="view-source-button" for="Transform.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transform.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transform.__init__-738"><a href="#Transform.__init__-738"><span class="linenos">738</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">rotation</span><span class="p">:</span> <span class="n">Rotation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Transform.__init__-739"><a href="#Transform.__init__-739"><span class="linenos">739</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a transform from a position and rotation.</span>
</span><span id="Transform.__init__-740"><a href="#Transform.__init__-740"><span class="linenos">740</span></a><span class="sd">        </span>
</span><span id="Transform.__init__-741"><a href="#Transform.__init__-741"><span class="linenos">741</span></a><span class="sd">        Args:</span>
</span><span id="Transform.__init__-742"><a href="#Transform.__init__-742"><span class="linenos">742</span></a><span class="sd">            position: The position of the transform.</span>
</span><span id="Transform.__init__-743"><a href="#Transform.__init__-743"><span class="linenos">743</span></a><span class="sd">            rotation: The rotation of the transform.</span>
</span><span id="Transform.__init__-744"><a href="#Transform.__init__-744"><span class="linenos">744</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform.__init__-745"><a href="#Transform.__init__-745"><span class="linenos">745</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</span><span id="Transform.__init__-746"><a href="#Transform.__init__-746"><span class="linenos">746</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="n">rotation</span>
</span></pre></div>


            <div class="docstring"><p>Create a transform from a position and rotation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>position:</strong>  The position of the transform.</li>
<li><strong>rotation:</strong>  The rotation of the transform.</li>
</ul>
</div>


                            </div>
                            <div id="Transform.from_position_and_quaternion" class="classattr">
                                        <input id="Transform.from_position_and_quaternion-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_position_and_quaternion</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">quaternion</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n"><a href="#Transform">posetree.pose.Transform</a></span>:</span></span>

                <label class="view-source-button" for="Transform.from_position_and_quaternion-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transform.from_position_and_quaternion"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transform.from_position_and_quaternion-748"><a href="#Transform.from_position_and_quaternion-748"><span class="linenos">748</span></a>    <span class="nd">@classmethod</span>
</span><span id="Transform.from_position_and_quaternion-749"><a href="#Transform.from_position_and_quaternion-749"><span class="linenos">749</span></a>    <span class="k">def</span> <span class="nf">from_position_and_quaternion</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">quaternion</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="Transform.from_position_and_quaternion-750"><a href="#Transform.from_position_and_quaternion-750"><span class="linenos">750</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a transform from a position and quaternion.</span>
</span><span id="Transform.from_position_and_quaternion-751"><a href="#Transform.from_position_and_quaternion-751"><span class="linenos">751</span></a><span class="sd">        </span>
</span><span id="Transform.from_position_and_quaternion-752"><a href="#Transform.from_position_and_quaternion-752"><span class="linenos">752</span></a><span class="sd">        Args:</span>
</span><span id="Transform.from_position_and_quaternion-753"><a href="#Transform.from_position_and_quaternion-753"><span class="linenos">753</span></a><span class="sd">            position: The position of the transform.</span>
</span><span id="Transform.from_position_and_quaternion-754"><a href="#Transform.from_position_and_quaternion-754"><span class="linenos">754</span></a><span class="sd">            quaternion: The quaternion of the transform, in xyzw order.</span>
</span><span id="Transform.from_position_and_quaternion-755"><a href="#Transform.from_position_and_quaternion-755"><span class="linenos">755</span></a><span class="sd">        </span>
</span><span id="Transform.from_position_and_quaternion-756"><a href="#Transform.from_position_and_quaternion-756"><span class="linenos">756</span></a><span class="sd">        Returns:</span>
</span><span id="Transform.from_position_and_quaternion-757"><a href="#Transform.from_position_and_quaternion-757"><span class="linenos">757</span></a><span class="sd">            A new transform.</span>
</span><span id="Transform.from_position_and_quaternion-758"><a href="#Transform.from_position_and_quaternion-758"><span class="linenos">758</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform.from_position_and_quaternion-759"><a href="#Transform.from_position_and_quaternion-759"><span class="linenos">759</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">quaternion</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Create a transform from a position and quaternion.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>position:</strong>  The position of the transform.</li>
<li><strong>quaternion:</strong>  The quaternion of the transform, in xyzw order.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new transform.</p>
</blockquote>
</div>


                            </div>
                            <div id="Transform.identity" class="classattr">
                                        <input id="Transform.identity-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">identity</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span></span><span class="return-annotation">) -> <span class="n"><a href="#Transform">posetree.pose.Transform</a></span>:</span></span>

                <label class="view-source-button" for="Transform.identity-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transform.identity"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transform.identity-761"><a href="#Transform.identity-761"><span class="linenos">761</span></a>    <span class="nd">@classmethod</span>
</span><span id="Transform.identity-762"><a href="#Transform.identity-762"><span class="linenos">762</span></a>    <span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="Transform.identity-763"><a href="#Transform.identity-763"><span class="linenos">763</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the identity transform.&quot;&quot;&quot;</span>
</span><span id="Transform.identity-764"><a href="#Transform.identity-764"><span class="linenos">764</span></a>        <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">identity</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Return the identity transform.</p>
</div>


                            </div>
                            <div id="Transform.inverse" class="classattr">
                                <div class="attr variable">
            <span class="name">inverse</span><span class="annotation">: <a href="#Transform">posetree.pose.Transform</a></span>

        
    </div>
    <a class="headerlink" href="#Transform.inverse"></a>
    
            <div class="docstring"><p>The inverse of the transform.</p>

<p>How to get back from applying this transform.</p>

<p>t1 * t1.inverse == <a href="#Transform.identity">Transform.identity()</a></p>
</div>


                            </div>
                            <div id="Transform.position" class="classattr">
                                <div class="attr variable">
            <span class="name">position</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#Transform.position"></a>
    
            <div class="docstring"><p>The 1x3 cartesian position of the transform.</p>
</div>


                            </div>
                            <div id="Transform.rotation" class="classattr">
                                <div class="attr variable">
            <span class="name">rotation</span><span class="annotation">: scipy.spatial.transform._rotation.Rotation</span>

        
    </div>
    <a class="headerlink" href="#Transform.rotation"></a>
    
            <div class="docstring"><p>The rotation component of the transform.</p>
</div>


                            </div>
                            <div id="Transform.x_axis" class="classattr">
                                <div class="attr variable">
            <span class="name">x_axis</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#Transform.x_axis"></a>
    
            <div class="docstring"><p>The x axis of the transform.</p>

<p>This is the unit vector, in the parent frame, pointing in the new x direction, after applying the transform.</p>
</div>


                            </div>
                            <div id="Transform.y_axis" class="classattr">
                                <div class="attr variable">
            <span class="name">y_axis</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#Transform.y_axis"></a>
    
            <div class="docstring"><p>The y axis of the transform.</p>

<p>This is the unit vector, in the parent frame, pointing in the new y direction, after applying the transform.</p>
</div>


                            </div>
                            <div id="Transform.z_axis" class="classattr">
                                <div class="attr variable">
            <span class="name">z_axis</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#Transform.z_axis"></a>
    
            <div class="docstring"><p>The z axis of the transform.</p>

<p>This is the unit vector, in the parent frame, pointing in the new z direction, after applying the transform.</p>
</div>


                            </div>
                            <div id="Transform.x" class="classattr">
                                <div class="attr variable">
            <span class="name">x</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#Transform.x"></a>
    
            <div class="docstring"><p>The x coordinate of the transform.</p>
</div>


                            </div>
                            <div id="Transform.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#Transform.y"></a>
    
            <div class="docstring"><p>The y coordinate of the transform.</p>
</div>


                            </div>
                            <div id="Transform.z" class="classattr">
                                <div class="attr variable">
            <span class="name">z</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#Transform.z"></a>
    
            <div class="docstring"><p>The z coordinate of the transform.</p>
</div>


                            </div>
                            <div id="Transform.to_matrix" class="classattr">
                                        <input id="Transform.to_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_matrix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="Transform.to_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transform.to_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transform.to_matrix-825"><a href="#Transform.to_matrix-825"><span class="linenos">825</span></a>    <span class="k">def</span> <span class="nf">to_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Transform.to_matrix-826"><a href="#Transform.to_matrix-826"><span class="linenos">826</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the 4x4 matrix representation of the transform.&quot;&quot;&quot;</span>
</span><span id="Transform.to_matrix-827"><a href="#Transform.to_matrix-827"><span class="linenos">827</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="Transform.to_matrix-828"><a href="#Transform.to_matrix-828"><span class="linenos">828</span></a>        <span class="n">matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
</span><span id="Transform.to_matrix-829"><a href="#Transform.to_matrix-829"><span class="linenos">829</span></a>        <span class="n">matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
</span><span id="Transform.to_matrix-830"><a href="#Transform.to_matrix-830"><span class="linenos">830</span></a>        <span class="k">return</span> <span class="n">matrix</span>
</span></pre></div>


            <div class="docstring"><p>Return the 4x4 matrix representation of the transform.</p>
</div>


                            </div>
                            <div id="Transform.from_matrix" class="classattr">
                                        <input id="Transform.from_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_matrix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">matrix</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n"><a href="#Transform">posetree.pose.Transform</a></span>:</span></span>

                <label class="view-source-button" for="Transform.from_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transform.from_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transform.from_matrix-832"><a href="#Transform.from_matrix-832"><span class="linenos">832</span></a>    <span class="nd">@classmethod</span>
</span><span id="Transform.from_matrix-833"><a href="#Transform.from_matrix-833"><span class="linenos">833</span></a>    <span class="k">def</span> <span class="nf">from_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">matrix</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="Transform.from_matrix-834"><a href="#Transform.from_matrix-834"><span class="linenos">834</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a transform from a matrix.</span>
</span><span id="Transform.from_matrix-835"><a href="#Transform.from_matrix-835"><span class="linenos">835</span></a><span class="sd">        </span>
</span><span id="Transform.from_matrix-836"><a href="#Transform.from_matrix-836"><span class="linenos">836</span></a><span class="sd">        Args:</span>
</span><span id="Transform.from_matrix-837"><a href="#Transform.from_matrix-837"><span class="linenos">837</span></a><span class="sd">            matrix: The matrix of the transform.</span>
</span><span id="Transform.from_matrix-838"><a href="#Transform.from_matrix-838"><span class="linenos">838</span></a><span class="sd">        </span>
</span><span id="Transform.from_matrix-839"><a href="#Transform.from_matrix-839"><span class="linenos">839</span></a><span class="sd">        Returns:</span>
</span><span id="Transform.from_matrix-840"><a href="#Transform.from_matrix-840"><span class="linenos">840</span></a><span class="sd">            A new transform.</span>
</span><span id="Transform.from_matrix-841"><a href="#Transform.from_matrix-841"><span class="linenos">841</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform.from_matrix-842"><a href="#Transform.from_matrix-842"><span class="linenos">842</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</span><span id="Transform.from_matrix-843"><a href="#Transform.from_matrix-843"><span class="linenos">843</span></a>        <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="n">matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>Create a transform from a matrix.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>matrix:</strong>  The matrix of the transform.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new transform.</p>
</blockquote>
</div>


                            </div>
                            <div id="Transform.apply" class="classattr">
                                        <input id="Transform.apply-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Transform">posetree.pose.Transform</a></span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span></span><span class="return-annotation">) -> <span class="n"><a href="#Transform">posetree.pose.Transform</a></span>:</span></span>

                <label class="view-source-button" for="Transform.apply-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transform.apply"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transform.apply-845"><a href="#Transform.apply-845"><span class="linenos">845</span></a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Transform&quot;</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="Transform.apply-846"><a href="#Transform.apply-846"><span class="linenos">846</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Multiply this transform by another transform or vector.</span>
</span><span id="Transform.apply-847"><a href="#Transform.apply-847"><span class="linenos">847</span></a>
</span><span id="Transform.apply-848"><a href="#Transform.apply-848"><span class="linenos">848</span></a><span class="sd">        If other is a transform, this is equivalent to applying this transform, then the other transform.</span>
</span><span id="Transform.apply-849"><a href="#Transform.apply-849"><span class="linenos">849</span></a><span class="sd">        If other is a vector, this is equivalent to applying this transform to the vector.</span>
</span><span id="Transform.apply-850"><a href="#Transform.apply-850"><span class="linenos">850</span></a><span class="sd">        </span>
</span><span id="Transform.apply-851"><a href="#Transform.apply-851"><span class="linenos">851</span></a><span class="sd">        Args:</span>
</span><span id="Transform.apply-852"><a href="#Transform.apply-852"><span class="linenos">852</span></a><span class="sd">            other: The transform or vector to multiply.</span>
</span><span id="Transform.apply-853"><a href="#Transform.apply-853"><span class="linenos">853</span></a><span class="sd">        </span>
</span><span id="Transform.apply-854"><a href="#Transform.apply-854"><span class="linenos">854</span></a><span class="sd">        Returns:</span>
</span><span id="Transform.apply-855"><a href="#Transform.apply-855"><span class="linenos">855</span></a><span class="sd">            The product of the two transforms.</span>
</span><span id="Transform.apply-856"><a href="#Transform.apply-856"><span class="linenos">856</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform.apply-857"><a href="#Transform.apply-857"><span class="linenos">857</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Transform</span><span class="p">):</span>
</span><span id="Transform.apply-858"><a href="#Transform.apply-858"><span class="linenos">858</span></a>          <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">position</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span>
</span><span id="Transform.apply-859"><a href="#Transform.apply-859"><span class="linenos">859</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Transform.apply-860"><a href="#Transform.apply-860"><span class="linenos">860</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="Transform.apply-861"><a href="#Transform.apply-861"><span class="linenos">861</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Multiply this transform by another transform or vector.</p>

<p>If other is a transform, this is equivalent to applying this transform, then the other transform.
If other is a vector, this is equivalent to applying this transform to the vector.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>other:</strong>  The transform or vector to multiply.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>The product of the two transforms.</p>
</blockquote>
</div>


                            </div>
                            <div id="Transform.almost_equal" class="classattr">
                                        <input id="Transform.almost_equal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">almost_equal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span><span class="p">:</span> <span class="n"><a href="#Transform">posetree.pose.Transform</a></span>, </span><span class="param"><span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-08</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="Transform.almost_equal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transform.almost_equal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transform.almost_equal-865"><a href="#Transform.almost_equal-865"><span class="linenos">865</span></a>    <span class="k">def</span> <span class="nf">almost_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Transform.almost_equal-866"><a href="#Transform.almost_equal-866"><span class="linenos">866</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two transforms are almost equal.</span>
</span><span id="Transform.almost_equal-867"><a href="#Transform.almost_equal-867"><span class="linenos">867</span></a><span class="sd">        </span>
</span><span id="Transform.almost_equal-868"><a href="#Transform.almost_equal-868"><span class="linenos">868</span></a><span class="sd">        Handles floating point error in the position and rotation, and the fact that for quaternions negating </span>
</span><span id="Transform.almost_equal-869"><a href="#Transform.almost_equal-869"><span class="linenos">869</span></a><span class="sd">        the vector gives the same rotation.</span>
</span><span id="Transform.almost_equal-870"><a href="#Transform.almost_equal-870"><span class="linenos">870</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform.almost_equal-871"><a href="#Transform.almost_equal-871"><span class="linenos">871</span></a>        <span class="c1"># Check if positions are almost equal.</span>
</span><span id="Transform.almost_equal-872"><a href="#Transform.almost_equal-872"><span class="linenos">872</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_position</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_position</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="Transform.almost_equal-873"><a href="#Transform.almost_equal-873"><span class="linenos">873</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Transform.almost_equal-874"><a href="#Transform.almost_equal-874"><span class="linenos">874</span></a>        <span class="c1"># Check if rotations are almost equal.</span>
</span><span id="Transform.almost_equal-875"><a href="#Transform.almost_equal-875"><span class="linenos">875</span></a>        <span class="c1"># Since quaternion [x, y, z, w] represents the same rotation as [-x, -y, -z, -w], we also need to check the inverse quaternion.</span>
</span><span id="Transform.almost_equal-876"><a href="#Transform.almost_equal-876"><span class="linenos">876</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span><span id="Transform.almost_equal-877"><a href="#Transform.almost_equal-877"><span class="linenos">877</span></a>                <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="o">-</span><span class="n">other</span><span class="o">.</span><span class="n">_rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)):</span>
</span><span id="Transform.almost_equal-878"><a href="#Transform.almost_equal-878"><span class="linenos">878</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Transform.almost_equal-879"><a href="#Transform.almost_equal-879"><span class="linenos">879</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Check if two transforms are almost equal.</p>

<p>Handles floating point error in the position and rotation, and the fact that for quaternions negating 
the vector gives the same rotation.</p>
</div>


                            </div>
                            <div id="Transform.interpolate" class="classattr">
                                        <input id="Transform.interpolate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">interpolate</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">other</span><span class="p">:</span> <span class="n"><a href="#Transform">posetree.pose.Transform</a></span>,</span><span class="param">	<span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n"><a href="#Transform">posetree.pose.Transform</a></span>:</span></span>

                <label class="view-source-button" for="Transform.interpolate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transform.interpolate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transform.interpolate-881"><a href="#Transform.interpolate-881"><span class="linenos">881</span></a>    <span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transform&quot;</span><span class="p">:</span>
</span><span id="Transform.interpolate-882"><a href="#Transform.interpolate-882"><span class="linenos">882</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Interpolate between two transforms.</span>
</span><span id="Transform.interpolate-883"><a href="#Transform.interpolate-883"><span class="linenos">883</span></a><span class="sd">        </span>
</span><span id="Transform.interpolate-884"><a href="#Transform.interpolate-884"><span class="linenos">884</span></a><span class="sd">        Args:</span>
</span><span id="Transform.interpolate-885"><a href="#Transform.interpolate-885"><span class="linenos">885</span></a><span class="sd">            other: The other transform to interpolate with.</span>
</span><span id="Transform.interpolate-886"><a href="#Transform.interpolate-886"><span class="linenos">886</span></a><span class="sd">            alpha: The interpolation factor. 0 gives this transform, 1 gives the other transform.</span>
</span><span id="Transform.interpolate-887"><a href="#Transform.interpolate-887"><span class="linenos">887</span></a><span class="sd">        </span>
</span><span id="Transform.interpolate-888"><a href="#Transform.interpolate-888"><span class="linenos">888</span></a><span class="sd">        Returns:</span>
</span><span id="Transform.interpolate-889"><a href="#Transform.interpolate-889"><span class="linenos">889</span></a><span class="sd">            The interpolated transform.</span>
</span><span id="Transform.interpolate-890"><a href="#Transform.interpolate-890"><span class="linenos">890</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform.interpolate-891"><a href="#Transform.interpolate-891"><span class="linenos">891</span></a>        <span class="c1"># Combine the rotations into a single Rotation object</span>
</span><span id="Transform.interpolate-892"><a href="#Transform.interpolate-892"><span class="linenos">892</span></a>        <span class="n">rotations</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())))</span>
</span><span id="Transform.interpolate-893"><a href="#Transform.interpolate-893"><span class="linenos">893</span></a>        <span class="n">slerp</span> <span class="o">=</span> <span class="n">Slerp</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">rotations</span><span class="p">)</span>    
</span><span id="Transform.interpolate-894"><a href="#Transform.interpolate-894"><span class="linenos">894</span></a>        <span class="n">new_rotation</span><span class="o">=</span> <span class="n">slerp</span><span class="p">([</span><span class="n">alpha</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Transform.interpolate-895"><a href="#Transform.interpolate-895"><span class="linenos">895</span></a>        <span class="k">return</span> <span class="n">Transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">position</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">new_rotation</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Interpolate between two transforms.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>other:</strong>  The other transform to interpolate with.</li>
<li><strong>alpha:</strong>  The interpolation factor. 0 gives this transform, 1 gives the other transform.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>The interpolated transform.</p>
</blockquote>
</div>


                            </div>
                            <div id="Transform.angle_to" class="classattr">
                                        <input id="Transform.angle_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angle_to</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="p">:</span> <span class="n"><a href="#Transform">posetree.pose.Transform</a></span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Transform.angle_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transform.angle_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transform.angle_to-897"><a href="#Transform.angle_to-897"><span class="linenos">897</span></a>    <span class="k">def</span> <span class="nf">angle_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s2">&quot;Transform&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Transform.angle_to-898"><a href="#Transform.angle_to-898"><span class="linenos">898</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the angle between two transforms&#39; orientations. Ignores position.</span>
</span><span id="Transform.angle_to-899"><a href="#Transform.angle_to-899"><span class="linenos">899</span></a><span class="sd">        </span>
</span><span id="Transform.angle_to-900"><a href="#Transform.angle_to-900"><span class="linenos">900</span></a><span class="sd">        Args:</span>
</span><span id="Transform.angle_to-901"><a href="#Transform.angle_to-901"><span class="linenos">901</span></a><span class="sd">            target: The target transform.</span>
</span><span id="Transform.angle_to-902"><a href="#Transform.angle_to-902"><span class="linenos">902</span></a><span class="sd">        </span>
</span><span id="Transform.angle_to-903"><a href="#Transform.angle_to-903"><span class="linenos">903</span></a><span class="sd">        Returns:</span>
</span><span id="Transform.angle_to-904"><a href="#Transform.angle_to-904"><span class="linenos">904</span></a><span class="sd">            The angle between two transform, in radians.</span>
</span><span id="Transform.angle_to-905"><a href="#Transform.angle_to-905"><span class="linenos">905</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transform.angle_to-906"><a href="#Transform.angle_to-906"><span class="linenos">906</span></a>        <span class="n">relative_rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span> <span class="o">*</span> <span class="n">target</span><span class="o">.</span><span class="n">rotation</span>
</span><span id="Transform.angle_to-907"><a href="#Transform.angle_to-907"><span class="linenos">907</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">relative_rotation</span><span class="o">.</span><span class="n">as_rotvec</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Return the angle between two transforms' orientations. Ignores position.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target:</strong>  The target transform.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>The angle between two transform, in radians.</p>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>